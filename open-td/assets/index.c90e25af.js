var pl=Object.defineProperty;var ml=(t,e,s)=>e in t?pl(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var c=(t,e,s)=>(ml(t,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerpolicy&&(r.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?r.credentials="include":i.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=s(i);fetch(i.href,r)}})();function Zn(t,e){const s=Object.create(null),n=t.split(",");for(let i=0;i<n.length;i++)s[n[i]]=!0;return e?i=>!!s[i.toLowerCase()]:i=>!!s[i]}const yl="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",wl=Zn(yl);function xr(t){return!!t||t===""}function Qs(t){if(U(t)){const e={};for(let s=0;s<t.length;s++){const n=t[s],i=_e(n)?bl(n):Qs(n);if(i)for(const r in i)e[r]=i[r]}return e}else{if(_e(t))return t;if(ge(t))return t}}const _l=/;(?![^(]*\))/g,vl=/:(.+)/;function bl(t){const e={};return t.split(_l).forEach(s=>{if(s){const n=s.split(vl);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function be(t){let e="";if(_e(t))e=t;else if(U(t))for(let s=0;s<t.length;s++){const n=be(t[s]);n&&(e+=n+" ")}else if(ge(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}function El(t,e){if(t.length!==e.length)return!1;let s=!0;for(let n=0;s&&n<t.length;n++)s=en(t[n],e[n]);return s}function en(t,e){if(t===e)return!0;let s=Bi(t),n=Bi(e);if(s||n)return s&&n?t.getTime()===e.getTime():!1;if(s=as(t),n=as(e),s||n)return t===e;if(s=U(t),n=U(e),s||n)return s&&n?El(t,e):!1;if(s=ge(t),n=ge(e),s||n){if(!s||!n)return!1;const i=Object.keys(t).length,r=Object.keys(e).length;if(i!==r)return!1;for(const o in t){const l=t.hasOwnProperty(o),a=e.hasOwnProperty(o);if(l&&!a||!l&&a||!en(t[o],e[o]))return!1}}return String(t)===String(e)}function Sl(t,e){return t.findIndex(s=>en(s,e))}const de=t=>_e(t)?t:t==null?"":U(t)||ge(t)&&(t.toString===Fr||!j(t.toString))?JSON.stringify(t,Ar,2):String(t),Ar=(t,e)=>e&&e.__v_isRef?Ar(t,e.value):Ot(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[n,i])=>(s[`${n} =>`]=i,s),{})}:sn(e)?{[`Set(${e.size})`]:[...e.values()]}:ge(e)&&!U(e)&&!kr(e)?String(e):e,oe={},Dt=[],We=()=>{},Tl=()=>!1,Ml=/^on[^a-z]/,tn=t=>Ml.test(t),Jn=t=>t.startsWith("onUpdate:"),Me=Object.assign,Qn=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},Il=Object.prototype.hasOwnProperty,Z=(t,e)=>Il.call(t,e),U=Array.isArray,Ot=t=>ms(t)==="[object Map]",sn=t=>ms(t)==="[object Set]",Bi=t=>ms(t)==="[object Date]",j=t=>typeof t=="function",_e=t=>typeof t=="string",as=t=>typeof t=="symbol",ge=t=>t!==null&&typeof t=="object",Pr=t=>ge(t)&&j(t.then)&&j(t.catch),Fr=Object.prototype.toString,ms=t=>Fr.call(t),Cl=t=>ms(t).slice(8,-1),kr=t=>ms(t)==="[object Object]",ei=t=>_e(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,ks=Zn(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),nn=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},xl=/-(\w)/g,Qe=nn(t=>t.replace(xl,(e,s)=>s?s.toUpperCase():"")),Al=/\B([A-Z])/g,Nt=nn(t=>t.replace(Al,"-$1").toLowerCase()),rn=nn(t=>t.charAt(0).toUpperCase()+t.slice(1)),_n=nn(t=>t?`on${rn(t)}`:""),cs=(t,e)=>!Object.is(t,e),Bs=(t,e)=>{for(let s=0;s<t.length;s++)t[s](e)},$s=(t,e,s)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,value:s})},Ys=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Di;const Pl=()=>Di||(Di=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Ge;class Fl{constructor(e=!1){this.active=!0,this.effects=[],this.cleanups=[],!e&&Ge&&(this.parent=Ge,this.index=(Ge.scopes||(Ge.scopes=[])).push(this)-1)}run(e){if(this.active){const s=Ge;try{return Ge=this,e()}finally{Ge=s}}}on(){Ge=this}off(){Ge=this.parent}stop(e){if(this.active){let s,n;for(s=0,n=this.effects.length;s<n;s++)this.effects[s].stop();for(s=0,n=this.cleanups.length;s<n;s++)this.cleanups[s]();if(this.scopes)for(s=0,n=this.scopes.length;s<n;s++)this.scopes[s].stop(!0);if(this.parent&&!e){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function kl(t,e=Ge){e&&e.active&&e.effects.push(t)}const ti=t=>{const e=new Set(t);return e.w=0,e.n=0,e},Br=t=>(t.w&gt)>0,Dr=t=>(t.n&gt)>0,Bl=({deps:t})=>{if(t.length)for(let e=0;e<t.length;e++)t[e].w|=gt},Dl=t=>{const{deps:e}=t;if(e.length){let s=0;for(let n=0;n<e.length;n++){const i=e[n];Br(i)&&!Dr(i)?i.delete(t):e[s++]=i,i.w&=~gt,i.n&=~gt}e.length=s}},xn=new WeakMap;let jt=0,gt=1;const An=30;let Xe;const Mt=Symbol(""),Pn=Symbol("");class si{constructor(e,s=null,n){this.fn=e,this.scheduler=s,this.active=!0,this.deps=[],this.parent=void 0,kl(this,n)}run(){if(!this.active)return this.fn();let e=Xe,s=ft;for(;e;){if(e===this)return;e=e.parent}try{return this.parent=Xe,Xe=this,ft=!0,gt=1<<++jt,jt<=An?Bl(this):Oi(this),this.fn()}finally{jt<=An&&Dl(this),gt=1<<--jt,Xe=this.parent,ft=s,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Xe===this?this.deferStop=!0:this.active&&(Oi(this),this.onStop&&this.onStop(),this.active=!1)}}function Oi(t){const{deps:e}=t;if(e.length){for(let s=0;s<e.length;s++)e[s].delete(t);e.length=0}}let ft=!0;const Or=[];function $t(){Or.push(ft),ft=!1}function Yt(){const t=Or.pop();ft=t===void 0?!0:t}function Be(t,e,s){if(ft&&Xe){let n=xn.get(t);n||xn.set(t,n=new Map);let i=n.get(s);i||n.set(s,i=ti()),Rr(i)}}function Rr(t,e){let s=!1;jt<=An?Dr(t)||(t.n|=gt,s=!Br(t)):s=!t.has(Xe),s&&(t.add(Xe),Xe.deps.push(t))}function rt(t,e,s,n,i,r){const o=xn.get(t);if(!o)return;let l=[];if(e==="clear")l=[...o.values()];else if(s==="length"&&U(t))o.forEach((a,h)=>{(h==="length"||h>=n)&&l.push(a)});else switch(s!==void 0&&l.push(o.get(s)),e){case"add":U(t)?ei(s)&&l.push(o.get("length")):(l.push(o.get(Mt)),Ot(t)&&l.push(o.get(Pn)));break;case"delete":U(t)||(l.push(o.get(Mt)),Ot(t)&&l.push(o.get(Pn)));break;case"set":Ot(t)&&l.push(o.get(Mt));break}if(l.length===1)l[0]&&Fn(l[0]);else{const a=[];for(const h of l)h&&a.push(...h);Fn(ti(a))}}function Fn(t,e){const s=U(t)?t:[...t];for(const n of s)n.computed&&Ri(n);for(const n of s)n.computed||Ri(n)}function Ri(t,e){(t!==Xe||t.allowRecurse)&&(t.scheduler?t.scheduler():t.run())}const Ol=Zn("__proto__,__v_isRef,__isVue"),Lr=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(as)),Rl=ni(),Ll=ni(!1,!0),Nl=ni(!0),Li=$l();function $l(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...s){const n=ee(this);for(let r=0,o=this.length;r<o;r++)Be(n,"get",r+"");const i=n[e](...s);return i===-1||i===!1?n[e](...s.map(ee)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...s){$t();const n=ee(this)[e].apply(this,s);return Yt(),n}}),t}function ni(t=!1,e=!1){return function(n,i,r){if(i==="__v_isReactive")return!t;if(i==="__v_isReadonly")return t;if(i==="__v_isShallow")return e;if(i==="__v_raw"&&r===(t?e?ta:Ur:e?Xr:Yr).get(n))return n;const o=U(n);if(!t&&o&&Z(Li,i))return Reflect.get(Li,i,r);const l=Reflect.get(n,i,r);return(as(i)?Lr.has(i):Ol(i))||(t||Be(n,"get",i),e)?l:Se(l)?o&&ei(i)?l:l.value:ge(l)?t?Hr(l):oi(l):l}}const Yl=Nr(),Xl=Nr(!0);function Nr(t=!1){return function(s,n,i,r){let o=s[n];if(us(o)&&Se(o)&&!Se(i))return!1;if(!t&&!us(i)&&(kn(i)||(i=ee(i),o=ee(o)),!U(s)&&Se(o)&&!Se(i)))return o.value=i,!0;const l=U(s)&&ei(n)?Number(n)<s.length:Z(s,n),a=Reflect.set(s,n,i,r);return s===ee(r)&&(l?cs(i,o)&&rt(s,"set",n,i):rt(s,"add",n,i)),a}}function Ul(t,e){const s=Z(t,e);t[e];const n=Reflect.deleteProperty(t,e);return n&&s&&rt(t,"delete",e,void 0),n}function Hl(t,e){const s=Reflect.has(t,e);return(!as(e)||!Lr.has(e))&&Be(t,"has",e),s}function Wl(t){return Be(t,"iterate",U(t)?"length":Mt),Reflect.ownKeys(t)}const $r={get:Rl,set:Yl,deleteProperty:Ul,has:Hl,ownKeys:Wl},jl={get:Nl,set(t,e){return!0},deleteProperty(t,e){return!0}},zl=Me({},$r,{get:Ll,set:Xl}),ii=t=>t,on=t=>Reflect.getPrototypeOf(t);function Ms(t,e,s=!1,n=!1){t=t.__v_raw;const i=ee(t),r=ee(e);s||(e!==r&&Be(i,"get",e),Be(i,"get",r));const{has:o}=on(i),l=n?ii:s?ai:hs;if(o.call(i,e))return l(t.get(e));if(o.call(i,r))return l(t.get(r));t!==i&&t.get(e)}function Is(t,e=!1){const s=this.__v_raw,n=ee(s),i=ee(t);return e||(t!==i&&Be(n,"has",t),Be(n,"has",i)),t===i?s.has(t):s.has(t)||s.has(i)}function Cs(t,e=!1){return t=t.__v_raw,!e&&Be(ee(t),"iterate",Mt),Reflect.get(t,"size",t)}function Ni(t){t=ee(t);const e=ee(this);return on(e).has.call(e,t)||(e.add(t),rt(e,"add",t,t)),this}function $i(t,e){e=ee(e);const s=ee(this),{has:n,get:i}=on(s);let r=n.call(s,t);r||(t=ee(t),r=n.call(s,t));const o=i.call(s,t);return s.set(t,e),r?cs(e,o)&&rt(s,"set",t,e):rt(s,"add",t,e),this}function Yi(t){const e=ee(this),{has:s,get:n}=on(e);let i=s.call(e,t);i||(t=ee(t),i=s.call(e,t)),n&&n.call(e,t);const r=e.delete(t);return i&&rt(e,"delete",t,void 0),r}function Xi(){const t=ee(this),e=t.size!==0,s=t.clear();return e&&rt(t,"clear",void 0,void 0),s}function xs(t,e){return function(n,i){const r=this,o=r.__v_raw,l=ee(o),a=e?ii:t?ai:hs;return!t&&Be(l,"iterate",Mt),o.forEach((h,g)=>n.call(i,a(h),a(g),r))}}function As(t,e,s){return function(...n){const i=this.__v_raw,r=ee(i),o=Ot(r),l=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,h=i[t](...n),g=s?ii:e?ai:hs;return!e&&Be(r,"iterate",a?Pn:Mt),{next(){const{value:p,done:m}=h.next();return m?{value:p,done:m}:{value:l?[g(p[0]),g(p[1])]:g(p),done:m}},[Symbol.iterator](){return this}}}}function at(t){return function(...e){return t==="delete"?!1:this}}function Vl(){const t={get(r){return Ms(this,r)},get size(){return Cs(this)},has:Is,add:Ni,set:$i,delete:Yi,clear:Xi,forEach:xs(!1,!1)},e={get(r){return Ms(this,r,!1,!0)},get size(){return Cs(this)},has:Is,add:Ni,set:$i,delete:Yi,clear:Xi,forEach:xs(!1,!0)},s={get(r){return Ms(this,r,!0)},get size(){return Cs(this,!0)},has(r){return Is.call(this,r,!0)},add:at("add"),set:at("set"),delete:at("delete"),clear:at("clear"),forEach:xs(!0,!1)},n={get(r){return Ms(this,r,!0,!0)},get size(){return Cs(this,!0)},has(r){return Is.call(this,r,!0)},add:at("add"),set:at("set"),delete:at("delete"),clear:at("clear"),forEach:xs(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=As(r,!1,!1),s[r]=As(r,!0,!1),e[r]=As(r,!1,!0),n[r]=As(r,!0,!0)}),[t,s,e,n]}const[Kl,Gl,ql,Zl]=Vl();function ri(t,e){const s=e?t?Zl:ql:t?Gl:Kl;return(n,i,r)=>i==="__v_isReactive"?!t:i==="__v_isReadonly"?t:i==="__v_raw"?n:Reflect.get(Z(s,i)&&i in n?s:n,i,r)}const Jl={get:ri(!1,!1)},Ql={get:ri(!1,!0)},ea={get:ri(!0,!1)},Yr=new WeakMap,Xr=new WeakMap,Ur=new WeakMap,ta=new WeakMap;function sa(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function na(t){return t.__v_skip||!Object.isExtensible(t)?0:sa(Cl(t))}function oi(t){return us(t)?t:li(t,!1,$r,Jl,Yr)}function ia(t){return li(t,!1,zl,Ql,Xr)}function Hr(t){return li(t,!0,jl,ea,Ur)}function li(t,e,s,n,i){if(!ge(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=i.get(t);if(r)return r;const o=na(t);if(o===0)return t;const l=new Proxy(t,o===2?n:s);return i.set(t,l),l}function Rt(t){return us(t)?Rt(t.__v_raw):!!(t&&t.__v_isReactive)}function us(t){return!!(t&&t.__v_isReadonly)}function kn(t){return!!(t&&t.__v_isShallow)}function Wr(t){return Rt(t)||us(t)}function ee(t){const e=t&&t.__v_raw;return e?ee(e):t}function jr(t){return $s(t,"__v_skip",!0),t}const hs=t=>ge(t)?oi(t):t,ai=t=>ge(t)?Hr(t):t;function zr(t){ft&&Xe&&(t=ee(t),Rr(t.dep||(t.dep=ti())))}function Vr(t,e){t=ee(t),t.dep&&Fn(t.dep)}function Se(t){return!!(t&&t.__v_isRef===!0)}function te(t){return ra(t,!1)}function ra(t,e){return Se(t)?t:new oa(t,e)}class oa{constructor(e,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?e:ee(e),this._value=s?e:hs(e)}get value(){return zr(this),this._value}set value(e){e=this.__v_isShallow?e:ee(e),cs(e,this._rawValue)&&(this._rawValue=e,this._value=this.__v_isShallow?e:hs(e),Vr(this))}}function ne(t){return Se(t)?t.value:t}const la={get:(t,e,s)=>ne(Reflect.get(t,e,s)),set:(t,e,s,n)=>{const i=t[e];return Se(i)&&!Se(s)?(i.value=s,!0):Reflect.set(t,e,s,n)}};function Kr(t){return Rt(t)?t:new Proxy(t,la)}class aa{constructor(e,s,n,i){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new si(e,()=>{this._dirty||(this._dirty=!0,Vr(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const e=ee(this);return zr(e),(e._dirty||!e._cacheable)&&(e._dirty=!1,e._value=e.effect.run()),e._value}set value(e){this._setter(e)}}function ca(t,e,s=!1){let n,i;const r=j(t);return r?(n=t,i=We):(n=t.get,i=t.set),new aa(n,i,r||!i,s)}function dt(t,e,s,n){let i;try{i=n?t(...n):t()}catch(r){ln(r,e,s)}return i}function Re(t,e,s,n){if(j(t)){const r=dt(t,e,s,n);return r&&Pr(r)&&r.catch(o=>{ln(o,e,s)}),r}const i=[];for(let r=0;r<t.length;r++)i.push(Re(t[r],e,s,n));return i}function ln(t,e,s,n=!0){const i=e?e.vnode:null;if(e){let r=e.parent;const o=e.proxy,l=s;for(;r;){const h=r.ec;if(h){for(let g=0;g<h.length;g++)if(h[g](t,o,l)===!1)return}r=r.parent}const a=e.appContext.config.errorHandler;if(a){dt(a,null,10,[t,o,l]);return}}ua(t,s,i,n)}function ua(t,e,s,n=!0){console.error(t)}let Xs=!1,Bn=!1;const ke=[];let it=0;const Qt=[];let zt=null,kt=0;const es=[];let ut=null,Bt=0;const Gr=Promise.resolve();let ci=null,Dn=null;function ha(t){const e=ci||Gr;return t?e.then(this?t.bind(this):t):e}function fa(t){let e=it+1,s=ke.length;for(;e<s;){const n=e+s>>>1;fs(ke[n])<t?e=n+1:s=n}return e}function qr(t){(!ke.length||!ke.includes(t,Xs&&t.allowRecurse?it+1:it))&&t!==Dn&&(t.id==null?ke.push(t):ke.splice(fa(t.id),0,t),Zr())}function Zr(){!Xs&&!Bn&&(Bn=!0,ci=Gr.then(eo))}function da(t){const e=ke.indexOf(t);e>it&&ke.splice(e,1)}function Jr(t,e,s,n){U(t)?s.push(...t):(!e||!e.includes(t,t.allowRecurse?n+1:n))&&s.push(t),Zr()}function ga(t){Jr(t,zt,Qt,kt)}function pa(t){Jr(t,ut,es,Bt)}function an(t,e=null){if(Qt.length){for(Dn=e,zt=[...new Set(Qt)],Qt.length=0,kt=0;kt<zt.length;kt++)zt[kt]();zt=null,kt=0,Dn=null,an(t,e)}}function Qr(t){if(an(),es.length){const e=[...new Set(es)];if(es.length=0,ut){ut.push(...e);return}for(ut=e,ut.sort((s,n)=>fs(s)-fs(n)),Bt=0;Bt<ut.length;Bt++)ut[Bt]();ut=null,Bt=0}}const fs=t=>t.id==null?1/0:t.id;function eo(t){Bn=!1,Xs=!0,an(t),ke.sort((s,n)=>fs(s)-fs(n));const e=We;try{for(it=0;it<ke.length;it++){const s=ke[it];s&&s.active!==!1&&dt(s,null,14)}}finally{it=0,ke.length=0,Qr(),Xs=!1,ci=null,(ke.length||Qt.length||es.length)&&eo(t)}}function ma(t,e,...s){if(t.isUnmounted)return;const n=t.vnode.props||oe;let i=s;const r=e.startsWith("update:"),o=r&&e.slice(7);if(o&&o in n){const g=`${o==="modelValue"?"model":o}Modifiers`,{number:p,trim:m}=n[g]||oe;m&&(i=s.map(F=>F.trim())),p&&(i=s.map(Ys))}let l,a=n[l=_n(e)]||n[l=_n(Qe(e))];!a&&r&&(a=n[l=_n(Nt(e))]),a&&Re(a,t,6,i);const h=n[l+"Once"];if(h){if(!t.emitted)t.emitted={};else if(t.emitted[l])return;t.emitted[l]=!0,Re(h,t,6,i)}}function to(t,e,s=!1){const n=e.emitsCache,i=n.get(t);if(i!==void 0)return i;const r=t.emits;let o={},l=!1;if(!j(t)){const a=h=>{const g=to(h,e,!0);g&&(l=!0,Me(o,g))};!s&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!r&&!l?(n.set(t,null),null):(U(r)?r.forEach(a=>o[a]=null):Me(o,r),n.set(t,o),o)}function cn(t,e){return!t||!tn(e)?!1:(e=e.slice(2).replace(/Once$/,""),Z(t,e[0].toLowerCase()+e.slice(1))||Z(t,Nt(e))||Z(t,e))}let Te=null,un=null;function Us(t){const e=Te;return Te=t,un=t&&t.type.__scopeId||null,e}function ys(t){un=t}function ws(){un=null}function Ds(t,e=Te,s){if(!e||t._n)return t;const n=(...i)=>{n._d&&Qi(-1);const r=Us(e),o=t(...i);return Us(r),n._d&&Qi(1),o};return n._n=!0,n._c=!0,n._d=!0,n}function vn(t){const{type:e,vnode:s,proxy:n,withProxy:i,props:r,propsOptions:[o],slots:l,attrs:a,emit:h,render:g,renderCache:p,data:m,setupState:F,ctx:k,inheritAttrs:B}=t;let I,d;const S=Us(t);try{if(s.shapeFlag&4){const M=i||n;I=qe(g.call(M,M,p,r,F,m,k)),d=a}else{const M=e;I=qe(M.length>1?M(r,{attrs:a,slots:l,emit:h}):M(r,null)),d=e.props?a:ya(a)}}catch(M){ss.length=0,ln(M,t,1),I=V(Le)}let b=I;if(d&&B!==!1){const M=Object.keys(d),{shapeFlag:N}=b;M.length&&N&7&&(o&&M.some(Jn)&&(d=wa(d,o)),b=pt(b,d))}return s.dirs&&(b=pt(b),b.dirs=b.dirs?b.dirs.concat(s.dirs):s.dirs),s.transition&&(b.transition=s.transition),I=b,Us(S),I}const ya=t=>{let e;for(const s in t)(s==="class"||s==="style"||tn(s))&&((e||(e={}))[s]=t[s]);return e},wa=(t,e)=>{const s={};for(const n in t)(!Jn(n)||!(n.slice(9)in e))&&(s[n]=t[n]);return s};function _a(t,e,s){const{props:n,children:i,component:r}=t,{props:o,children:l,patchFlag:a}=e,h=r.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&a>=0){if(a&1024)return!0;if(a&16)return n?Ui(n,o,h):!!o;if(a&8){const g=e.dynamicProps;for(let p=0;p<g.length;p++){const m=g[p];if(o[m]!==n[m]&&!cn(h,m))return!0}}}else return(i||l)&&(!l||!l.$stable)?!0:n===o?!1:n?o?Ui(n,o,h):!0:!!o;return!1}function Ui(t,e,s){const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!0;for(let i=0;i<n.length;i++){const r=n[i];if(e[r]!==t[r]&&!cn(s,r))return!0}return!1}function va({vnode:t,parent:e},s){for(;e&&e.subTree===t;)(t=e.vnode).el=s,e=e.parent}const ba=t=>t.__isSuspense;function Ea(t,e){e&&e.pendingBranch?U(t)?e.effects.push(...t):e.effects.push(t):pa(t)}function Sa(t,e){if(we){let s=we.provides;const n=we.parent&&we.parent.provides;n===s&&(s=we.provides=Object.create(n)),s[t]=e}}function bn(t,e,s=!1){const n=we||Te;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&t in i)return i[t];if(arguments.length>1)return s&&j(e)?e.call(n.proxy):e}}const Hi={};function Os(t,e,s){return so(t,e,s)}function so(t,e,{immediate:s,deep:n,flush:i,onTrack:r,onTrigger:o}=oe){const l=we;let a,h=!1,g=!1;if(Se(t)?(a=()=>t.value,h=kn(t)):Rt(t)?(a=()=>t,n=!0):U(t)?(g=!0,h=t.some(d=>Rt(d)||kn(d)),a=()=>t.map(d=>{if(Se(d))return d.value;if(Rt(d))return Tt(d);if(j(d))return dt(d,l,2)})):j(t)?e?a=()=>dt(t,l,2):a=()=>{if(!(l&&l.isUnmounted))return p&&p(),Re(t,l,3,[m])}:a=We,e&&n){const d=a;a=()=>Tt(d())}let p,m=d=>{p=I.onStop=()=>{dt(d,l,4)}};if(gs)return m=We,e?s&&Re(e,l,3,[a(),g?[]:void 0,m]):a(),We;let F=g?[]:Hi;const k=()=>{if(!!I.active)if(e){const d=I.run();(n||h||(g?d.some((S,b)=>cs(S,F[b])):cs(d,F)))&&(p&&p(),Re(e,l,3,[d,F===Hi?void 0:F,m]),F=d)}else I.run()};k.allowRecurse=!!e;let B;i==="sync"?B=k:i==="post"?B=()=>Pe(k,l&&l.suspense):B=()=>ga(k);const I=new si(a,B);return e?s?k():F=I.run():i==="post"?Pe(I.run.bind(I),l&&l.suspense):I.run(),()=>{I.stop(),l&&l.scope&&Qn(l.scope.effects,I)}}function Ta(t,e,s){const n=this.proxy,i=_e(t)?t.includes(".")?no(n,t):()=>n[t]:t.bind(n,n);let r;j(e)?r=e:(r=e.handler,s=e);const o=we;Lt(this);const l=so(i,r.bind(n),s);return o?Lt(o):Ct(),l}function no(t,e){const s=e.split(".");return()=>{let n=t;for(let i=0;i<s.length&&n;i++)n=n[s[i]];return n}}function Tt(t,e){if(!ge(t)||t.__v_skip||(e=e||new Set,e.has(t)))return t;if(e.add(t),Se(t))Tt(t.value,e);else if(U(t))for(let s=0;s<t.length;s++)Tt(t[s],e);else if(sn(t)||Ot(t))t.forEach(s=>{Tt(s,e)});else if(kr(t))for(const s in t)Tt(t[s],e);return t}function Ma(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return xt(()=>{t.isMounted=!0}),lo(()=>{t.isUnmounting=!0}),t}const De=[Function,Array],Ia={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:De,onEnter:De,onAfterEnter:De,onEnterCancelled:De,onBeforeLeave:De,onLeave:De,onAfterLeave:De,onLeaveCancelled:De,onBeforeAppear:De,onAppear:De,onAfterAppear:De,onAppearCancelled:De},setup(t,{slots:e}){const s=di(),n=Ma();let i;return()=>{const r=e.default&&ro(e.default(),!0);if(!r||!r.length)return;let o=r[0];if(r.length>1){for(const B of r)if(B.type!==Le){o=B;break}}const l=ee(t),{mode:a}=l;if(n.isLeaving)return En(o);const h=Wi(o);if(!h)return En(o);const g=On(h,l,n,s);Rn(h,g);const p=s.subTree,m=p&&Wi(p);let F=!1;const{getTransitionKey:k}=h.type;if(k){const B=k();i===void 0?i=B:B!==i&&(i=B,F=!0)}if(m&&m.type!==Le&&(!bt(h,m)||F)){const B=On(m,l,n,s);if(Rn(m,B),a==="out-in")return n.isLeaving=!0,B.afterLeave=()=>{n.isLeaving=!1,s.update()},En(o);a==="in-out"&&h.type!==Le&&(B.delayLeave=(I,d,S)=>{const b=io(n,m);b[String(m.key)]=m,I._leaveCb=()=>{d(),I._leaveCb=void 0,delete g.delayedLeave},g.delayedLeave=S})}return o}}},Ca=Ia;function io(t,e){const{leavingVNodes:s}=t;let n=s.get(e.type);return n||(n=Object.create(null),s.set(e.type,n)),n}function On(t,e,s,n){const{appear:i,mode:r,persisted:o=!1,onBeforeEnter:l,onEnter:a,onAfterEnter:h,onEnterCancelled:g,onBeforeLeave:p,onLeave:m,onAfterLeave:F,onLeaveCancelled:k,onBeforeAppear:B,onAppear:I,onAfterAppear:d,onAppearCancelled:S}=e,b=String(t.key),M=io(s,t),N=(L,G)=>{L&&Re(L,n,9,G)},$=(L,G)=>{const H=G[1];N(L,G),U(L)?L.every(se=>se.length<=1)&&H():L.length<=1&&H()},z={mode:r,persisted:o,beforeEnter(L){let G=l;if(!s.isMounted)if(i)G=B||l;else return;L._leaveCb&&L._leaveCb(!0);const H=M[b];H&&bt(t,H)&&H.el._leaveCb&&H.el._leaveCb(),N(G,[L])},enter(L){let G=a,H=h,se=g;if(!s.isMounted)if(i)G=I||a,H=d||h,se=S||g;else return;let le=!1;const me=L._enterCb=ze=>{le||(le=!0,ze?N(se,[L]):N(H,[L]),z.delayedLeave&&z.delayedLeave(),L._enterCb=void 0)};G?$(G,[L,me]):me()},leave(L,G){const H=String(t.key);if(L._enterCb&&L._enterCb(!0),s.isUnmounting)return G();N(p,[L]);let se=!1;const le=L._leaveCb=me=>{se||(se=!0,G(),me?N(k,[L]):N(F,[L]),L._leaveCb=void 0,M[H]===t&&delete M[H])};M[H]=t,m?$(m,[L,le]):le()},clone(L){return On(L,e,s,n)}};return z}function En(t){if(hn(t))return t=pt(t),t.children=null,t}function Wi(t){return hn(t)?t.children?t.children[0]:void 0:t}function Rn(t,e){t.shapeFlag&6&&t.component?Rn(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function ro(t,e=!1,s){let n=[],i=0;for(let r=0;r<t.length;r++){let o=t[r];const l=s==null?o.key:String(s)+String(o.key!=null?o.key:r);o.type===pe?(o.patchFlag&128&&i++,n=n.concat(ro(o.children,e,l))):(e||o.type!==Le)&&n.push(l!=null?pt(o,{key:l}):o)}if(i>1)for(let r=0;r<n.length;r++)n[r].patchFlag=-2;return n}function Ne(t){return j(t)?{setup:t,name:t.name}:t}const ts=t=>!!t.type.__asyncLoader,hn=t=>t.type.__isKeepAlive;function xa(t,e){oo(t,"a",e)}function Aa(t,e){oo(t,"da",e)}function oo(t,e,s=we){const n=t.__wdc||(t.__wdc=()=>{let i=s;for(;i;){if(i.isDeactivated)return;i=i.parent}return t()});if(fn(e,n,s),s){let i=s.parent;for(;i&&i.parent;)hn(i.parent.vnode)&&Pa(n,e,s,i),i=i.parent}}function Pa(t,e,s,n){const i=fn(e,t,n,!0);Xt(()=>{Qn(n[e],i)},s)}function fn(t,e,s=we,n=!1){if(s){const i=s[t]||(s[t]=[]),r=e.__weh||(e.__weh=(...o)=>{if(s.isUnmounted)return;$t(),Lt(s);const l=Re(e,s,t,o);return Ct(),Yt(),l});return n?i.unshift(r):i.push(r),r}}const ot=t=>(e,s=we)=>(!gs||t==="sp")&&fn(t,e,s),Fa=ot("bm"),xt=ot("m"),ka=ot("bu"),Ba=ot("u"),lo=ot("bum"),Xt=ot("um"),Da=ot("sp"),Oa=ot("rtg"),Ra=ot("rtc");function La(t,e=we){fn("ec",t,e)}function ji(t,e){const s=Te;if(s===null)return t;const n=gn(s)||s.proxy,i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[o,l,a,h=oe]=e[r];j(o)&&(o={mounted:o,updated:o}),o.deep&&Tt(l),i.push({dir:o,instance:n,value:l,oldValue:void 0,arg:a,modifiers:h})}return t}function mt(t,e,s,n){const i=t.dirs,r=e&&e.dirs;for(let o=0;o<i.length;o++){const l=i[o];r&&(l.oldValue=r[o].value);let a=l.dir[n];a&&($t(),Re(a,s,8,[t.el,l,t,e]),Yt())}}const ao="components";function Na(t,e){return Ya(ao,t,!0,e)||t}const $a=Symbol();function Ya(t,e,s=!0,n=!1){const i=Te||we;if(i){const r=i.type;if(t===ao){const l=mc(r,!1);if(l&&(l===e||l===Qe(e)||l===rn(Qe(e))))return r}const o=zi(i[t]||r[t],e)||zi(i.appContext[t],e);return!o&&n?r:o}}function zi(t,e){return t&&(t[e]||t[Qe(e)]||t[rn(Qe(e))])}function Hs(t,e,s,n){let i;const r=s&&s[n];if(U(t)||_e(t)){i=new Array(t.length);for(let o=0,l=t.length;o<l;o++)i[o]=e(t[o],o,void 0,r&&r[o])}else if(typeof t=="number"){i=new Array(t);for(let o=0;o<t;o++)i[o]=e(o+1,o,void 0,r&&r[o])}else if(ge(t))if(t[Symbol.iterator])i=Array.from(t,(o,l)=>e(o,l,void 0,r&&r[l]));else{const o=Object.keys(t);i=new Array(o.length);for(let l=0,a=o.length;l<a;l++){const h=o[l];i[l]=e(t[h],h,l,r&&r[l])}}else i=[];return s&&(s[n]=i),i}function Xa(t,e,s={},n,i){if(Te.isCE||Te.parent&&ts(Te.parent)&&Te.parent.isCE)return V("slot",e==="default"?null:{name:e},n&&n());let r=t[e];r&&r._c&&(r._d=!1),K();const o=r&&co(r(s)),l=It(pe,{key:s.key||`_${e}`},o||(n?n():[]),o&&t._===1?64:-2);return!i&&l.scopeId&&(l.slotScopeIds=[l.scopeId+"-s"]),r&&r._c&&(r._d=!0),l}function co(t){return t.some(e=>bo(e)?!(e.type===Le||e.type===pe&&!co(e.children)):!0)?t:null}const Ln=t=>t?So(t)?gn(t)||t.proxy:Ln(t.parent):null,Ws=Me(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ln(t.parent),$root:t=>Ln(t.root),$emit:t=>t.emit,$options:t=>ho(t),$forceUpdate:t=>t.f||(t.f=()=>qr(t.update)),$nextTick:t=>t.n||(t.n=ha.bind(t.proxy)),$watch:t=>Ta.bind(t)}),Ua={get({_:t},e){const{ctx:s,setupState:n,data:i,props:r,accessCache:o,type:l,appContext:a}=t;let h;if(e[0]!=="$"){const F=o[e];if(F!==void 0)switch(F){case 1:return n[e];case 2:return i[e];case 4:return s[e];case 3:return r[e]}else{if(n!==oe&&Z(n,e))return o[e]=1,n[e];if(i!==oe&&Z(i,e))return o[e]=2,i[e];if((h=t.propsOptions[0])&&Z(h,e))return o[e]=3,r[e];if(s!==oe&&Z(s,e))return o[e]=4,s[e];Nn&&(o[e]=0)}}const g=Ws[e];let p,m;if(g)return e==="$attrs"&&Be(t,"get",e),g(t);if((p=l.__cssModules)&&(p=p[e]))return p;if(s!==oe&&Z(s,e))return o[e]=4,s[e];if(m=a.config.globalProperties,Z(m,e))return m[e]},set({_:t},e,s){const{data:n,setupState:i,ctx:r}=t;return i!==oe&&Z(i,e)?(i[e]=s,!0):n!==oe&&Z(n,e)?(n[e]=s,!0):Z(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:n,appContext:i,propsOptions:r}},o){let l;return!!s[o]||t!==oe&&Z(t,o)||e!==oe&&Z(e,o)||(l=r[0])&&Z(l,o)||Z(n,o)||Z(Ws,o)||Z(i.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:Z(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};let Nn=!0;function Ha(t){const e=ho(t),s=t.proxy,n=t.ctx;Nn=!1,e.beforeCreate&&Vi(e.beforeCreate,t,"bc");const{data:i,computed:r,methods:o,watch:l,provide:a,inject:h,created:g,beforeMount:p,mounted:m,beforeUpdate:F,updated:k,activated:B,deactivated:I,beforeDestroy:d,beforeUnmount:S,destroyed:b,unmounted:M,render:N,renderTracked:$,renderTriggered:z,errorCaptured:L,serverPrefetch:G,expose:H,inheritAttrs:se,components:le,directives:me,filters:ze}=e;if(h&&Wa(h,n,null,t.appContext.config.unwrapInjectedRef),o)for(const fe in o){const ae=o[fe];j(ae)&&(n[fe]=ae.bind(s))}if(i){const fe=i.call(s,s);ge(fe)&&(t.data=oi(fe))}if(Nn=!0,r)for(const fe in r){const ae=r[fe],st=j(ae)?ae.bind(s,s):j(ae.get)?ae.get.bind(s,s):We,mn=!j(ae)&&j(ae.set)?ae.set.bind(s):We,Ut=Mo({get:st,set:mn});Object.defineProperty(n,fe,{enumerable:!0,configurable:!0,get:()=>Ut.value,set:At=>Ut.value=At})}if(l)for(const fe in l)uo(l[fe],n,s,fe);if(a){const fe=j(a)?a.call(s):a;Reflect.ownKeys(fe).forEach(ae=>{Sa(ae,fe[ae])})}g&&Vi(g,t,"c");function xe(fe,ae){U(ae)?ae.forEach(st=>fe(st.bind(s))):ae&&fe(ae.bind(s))}if(xe(Fa,p),xe(xt,m),xe(ka,F),xe(Ba,k),xe(xa,B),xe(Aa,I),xe(La,L),xe(Ra,$),xe(Oa,z),xe(lo,S),xe(Xt,M),xe(Da,G),U(H))if(H.length){const fe=t.exposed||(t.exposed={});H.forEach(ae=>{Object.defineProperty(fe,ae,{get:()=>s[ae],set:st=>s[ae]=st})})}else t.exposed||(t.exposed={});N&&t.render===We&&(t.render=N),se!=null&&(t.inheritAttrs=se),le&&(t.components=le),me&&(t.directives=me)}function Wa(t,e,s=We,n=!1){U(t)&&(t=$n(t));for(const i in t){const r=t[i];let o;ge(r)?"default"in r?o=bn(r.from||i,r.default,!0):o=bn(r.from||i):o=bn(r),Se(o)&&n?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>o.value,set:l=>o.value=l}):e[i]=o}}function Vi(t,e,s){Re(U(t)?t.map(n=>n.bind(e.proxy)):t.bind(e.proxy),e,s)}function uo(t,e,s,n){const i=n.includes(".")?no(s,n):()=>s[n];if(_e(t)){const r=e[t];j(r)&&Os(i,r)}else if(j(t))Os(i,t.bind(s));else if(ge(t))if(U(t))t.forEach(r=>uo(r,e,s,n));else{const r=j(t.handler)?t.handler.bind(s):e[t.handler];j(r)&&Os(i,r,t)}}function ho(t){const e=t.type,{mixins:s,extends:n}=e,{mixins:i,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,l=r.get(e);let a;return l?a=l:!i.length&&!s&&!n?a=e:(a={},i.length&&i.forEach(h=>js(a,h,o,!0)),js(a,e,o)),r.set(e,a),a}function js(t,e,s,n=!1){const{mixins:i,extends:r}=e;r&&js(t,r,s,!0),i&&i.forEach(o=>js(t,o,s,!0));for(const o in e)if(!(n&&o==="expose")){const l=ja[o]||s&&s[o];t[o]=l?l(t[o],e[o]):e[o]}return t}const ja={data:Ki,props:_t,emits:_t,methods:_t,computed:_t,beforeCreate:Ie,created:Ie,beforeMount:Ie,mounted:Ie,beforeUpdate:Ie,updated:Ie,beforeDestroy:Ie,beforeUnmount:Ie,destroyed:Ie,unmounted:Ie,activated:Ie,deactivated:Ie,errorCaptured:Ie,serverPrefetch:Ie,components:_t,directives:_t,watch:Va,provide:Ki,inject:za};function Ki(t,e){return e?t?function(){return Me(j(t)?t.call(this,this):t,j(e)?e.call(this,this):e)}:e:t}function za(t,e){return _t($n(t),$n(e))}function $n(t){if(U(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function Ie(t,e){return t?[...new Set([].concat(t,e))]:e}function _t(t,e){return t?Me(Me(Object.create(null),t),e):e}function Va(t,e){if(!t)return e;if(!e)return t;const s=Me(Object.create(null),t);for(const n in e)s[n]=Ie(t[n],e[n]);return s}function Ka(t,e,s,n=!1){const i={},r={};$s(r,dn,1),t.propsDefaults=Object.create(null),fo(t,e,i,r);for(const o in t.propsOptions[0])o in i||(i[o]=void 0);s?t.props=n?i:ia(i):t.type.props?t.props=i:t.props=r,t.attrs=r}function Ga(t,e,s,n){const{props:i,attrs:r,vnode:{patchFlag:o}}=t,l=ee(i),[a]=t.propsOptions;let h=!1;if((n||o>0)&&!(o&16)){if(o&8){const g=t.vnode.dynamicProps;for(let p=0;p<g.length;p++){let m=g[p];if(cn(t.emitsOptions,m))continue;const F=e[m];if(a)if(Z(r,m))F!==r[m]&&(r[m]=F,h=!0);else{const k=Qe(m);i[k]=Yn(a,l,k,F,t,!1)}else F!==r[m]&&(r[m]=F,h=!0)}}}else{fo(t,e,i,r)&&(h=!0);let g;for(const p in l)(!e||!Z(e,p)&&((g=Nt(p))===p||!Z(e,g)))&&(a?s&&(s[p]!==void 0||s[g]!==void 0)&&(i[p]=Yn(a,l,p,void 0,t,!0)):delete i[p]);if(r!==l)for(const p in r)(!e||!Z(e,p)&&!0)&&(delete r[p],h=!0)}h&&rt(t,"set","$attrs")}function fo(t,e,s,n){const[i,r]=t.propsOptions;let o=!1,l;if(e)for(let a in e){if(ks(a))continue;const h=e[a];let g;i&&Z(i,g=Qe(a))?!r||!r.includes(g)?s[g]=h:(l||(l={}))[g]=h:cn(t.emitsOptions,a)||(!(a in n)||h!==n[a])&&(n[a]=h,o=!0)}if(r){const a=ee(s),h=l||oe;for(let g=0;g<r.length;g++){const p=r[g];s[p]=Yn(i,a,p,h[p],t,!Z(h,p))}}return o}function Yn(t,e,s,n,i,r){const o=t[s];if(o!=null){const l=Z(o,"default");if(l&&n===void 0){const a=o.default;if(o.type!==Function&&j(a)){const{propsDefaults:h}=i;s in h?n=h[s]:(Lt(i),n=h[s]=a.call(null,e),Ct())}else n=a}o[0]&&(r&&!l?n=!1:o[1]&&(n===""||n===Nt(s))&&(n=!0))}return n}function go(t,e,s=!1){const n=e.propsCache,i=n.get(t);if(i)return i;const r=t.props,o={},l=[];let a=!1;if(!j(t)){const g=p=>{a=!0;const[m,F]=go(p,e,!0);Me(o,m),F&&l.push(...F)};!s&&e.mixins.length&&e.mixins.forEach(g),t.extends&&g(t.extends),t.mixins&&t.mixins.forEach(g)}if(!r&&!a)return n.set(t,Dt),Dt;if(U(r))for(let g=0;g<r.length;g++){const p=Qe(r[g]);Gi(p)&&(o[p]=oe)}else if(r)for(const g in r){const p=Qe(g);if(Gi(p)){const m=r[g],F=o[p]=U(m)||j(m)?{type:m}:m;if(F){const k=Ji(Boolean,F.type),B=Ji(String,F.type);F[0]=k>-1,F[1]=B<0||k<B,(k>-1||Z(F,"default"))&&l.push(p)}}}const h=[o,l];return n.set(t,h),h}function Gi(t){return t[0]!=="$"}function qi(t){const e=t&&t.toString().match(/^\s*function (\w+)/);return e?e[1]:t===null?"null":""}function Zi(t,e){return qi(t)===qi(e)}function Ji(t,e){return U(e)?e.findIndex(s=>Zi(s,t)):j(e)&&Zi(e,t)?0:-1}const po=t=>t[0]==="_"||t==="$stable",ui=t=>U(t)?t.map(qe):[qe(t)],qa=(t,e,s)=>{if(e._n)return e;const n=Ds((...i)=>ui(e(...i)),s);return n._c=!1,n},mo=(t,e,s)=>{const n=t._ctx;for(const i in t){if(po(i))continue;const r=t[i];if(j(r))e[i]=qa(i,r,n);else if(r!=null){const o=ui(r);e[i]=()=>o}}},yo=(t,e)=>{const s=ui(e);t.slots.default=()=>s},Za=(t,e)=>{if(t.vnode.shapeFlag&32){const s=e._;s?(t.slots=ee(e),$s(e,"_",s)):mo(e,t.slots={})}else t.slots={},e&&yo(t,e);$s(t.slots,dn,1)},Ja=(t,e,s)=>{const{vnode:n,slots:i}=t;let r=!0,o=oe;if(n.shapeFlag&32){const l=e._;l?s&&l===1?r=!1:(Me(i,e),!s&&l===1&&delete i._):(r=!e.$stable,mo(e,i)),o=e}else e&&(yo(t,e),o={default:1});if(r)for(const l in i)!po(l)&&!(l in o)&&delete i[l]};function wo(){return{app:null,config:{isNativeTag:Tl,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Qa=0;function ec(t,e){return function(n,i=null){j(n)||(n=Object.assign({},n)),i!=null&&!ge(i)&&(i=null);const r=wo(),o=new Set;let l=!1;const a=r.app={_uid:Qa++,_component:n,_props:i,_container:null,_context:r,_instance:null,version:wc,get config(){return r.config},set config(h){},use(h,...g){return o.has(h)||(h&&j(h.install)?(o.add(h),h.install(a,...g)):j(h)&&(o.add(h),h(a,...g))),a},mixin(h){return r.mixins.includes(h)||r.mixins.push(h),a},component(h,g){return g?(r.components[h]=g,a):r.components[h]},directive(h,g){return g?(r.directives[h]=g,a):r.directives[h]},mount(h,g,p){if(!l){const m=V(n,i);return m.appContext=r,g&&e?e(m,h):t(m,h,p),l=!0,a._container=h,h.__vue_app__=a,gn(m.component)||m.component.proxy}},unmount(){l&&(t(null,a._container),delete a._container.__vue_app__)},provide(h,g){return r.provides[h]=g,a}};return a}}function Xn(t,e,s,n,i=!1){if(U(t)){t.forEach((m,F)=>Xn(m,e&&(U(e)?e[F]:e),s,n,i));return}if(ts(n)&&!i)return;const r=n.shapeFlag&4?gn(n.component)||n.component.proxy:n.el,o=i?null:r,{i:l,r:a}=t,h=e&&e.r,g=l.refs===oe?l.refs={}:l.refs,p=l.setupState;if(h!=null&&h!==a&&(_e(h)?(g[h]=null,Z(p,h)&&(p[h]=null)):Se(h)&&(h.value=null)),j(a))dt(a,l,12,[o,g]);else{const m=_e(a),F=Se(a);if(m||F){const k=()=>{if(t.f){const B=m?g[a]:a.value;i?U(B)&&Qn(B,r):U(B)?B.includes(r)||B.push(r):m?(g[a]=[r],Z(p,a)&&(p[a]=g[a])):(a.value=[r],t.k&&(g[t.k]=a.value))}else m?(g[a]=o,Z(p,a)&&(p[a]=o)):F&&(a.value=o,t.k&&(g[t.k]=o))};o?(k.id=-1,Pe(k,s)):k()}}}const Pe=Ea;function tc(t){return sc(t)}function sc(t,e){const s=Pl();s.__VUE__=!0;const{insert:n,remove:i,patchProp:r,createElement:o,createText:l,createComment:a,setText:h,setElementText:g,parentNode:p,nextSibling:m,setScopeId:F=We,cloneNode:k,insertStaticContent:B}=t,I=(u,f,_,E=null,v=null,x=null,D=!1,C=null,P=!!f.dynamicChildren)=>{if(u===f)return;u&&!bt(u,f)&&(E=Ts(u),lt(u,v,x,!0),u=null),f.patchFlag===-2&&(P=!1,f.dynamicChildren=null);const{type:T,ref:Y,shapeFlag:R}=f;switch(T){case hi:d(u,f,_,E);break;case Le:S(u,f,_,E);break;case Sn:u==null&&b(f,_,E,D);break;case pe:me(u,f,_,E,v,x,D,C,P);break;default:R&1?$(u,f,_,E,v,x,D,C,P):R&6?ze(u,f,_,E,v,x,D,C,P):(R&64||R&128)&&T.process(u,f,_,E,v,x,D,C,P,Pt)}Y!=null&&v&&Xn(Y,u&&u.ref,x,f||u,!f)},d=(u,f,_,E)=>{if(u==null)n(f.el=l(f.children),_,E);else{const v=f.el=u.el;f.children!==u.children&&h(v,f.children)}},S=(u,f,_,E)=>{u==null?n(f.el=a(f.children||""),_,E):f.el=u.el},b=(u,f,_,E)=>{[u.el,u.anchor]=B(u.children,f,_,E,u.el,u.anchor)},M=({el:u,anchor:f},_,E)=>{let v;for(;u&&u!==f;)v=m(u),n(u,_,E),u=v;n(f,_,E)},N=({el:u,anchor:f})=>{let _;for(;u&&u!==f;)_=m(u),i(u),u=_;i(f)},$=(u,f,_,E,v,x,D,C,P)=>{D=D||f.type==="svg",u==null?z(f,_,E,v,x,D,C,P):H(u,f,v,x,D,C,P)},z=(u,f,_,E,v,x,D,C)=>{let P,T;const{type:Y,props:R,shapeFlag:X,transition:W,patchFlag:J,dirs:ie}=u;if(u.el&&k!==void 0&&J===-1)P=u.el=k(u.el);else{if(P=u.el=o(u.type,x,R&&R.is,R),X&8?g(P,u.children):X&16&&G(u.children,P,null,E,v,x&&Y!=="foreignObject",D,C),ie&&mt(u,null,E,"created"),R){for(const ce in R)ce!=="value"&&!ks(ce)&&r(P,ce,null,R[ce],x,u.children,E,v,nt);"value"in R&&r(P,"value",null,R.value),(T=R.onVnodeBeforeMount)&&Ke(T,E,u)}L(P,u,u.scopeId,D,E)}ie&&mt(u,null,E,"beforeMount");const re=(!v||v&&!v.pendingBranch)&&W&&!W.persisted;re&&W.beforeEnter(P),n(P,f,_),((T=R&&R.onVnodeMounted)||re||ie)&&Pe(()=>{T&&Ke(T,E,u),re&&W.enter(P),ie&&mt(u,null,E,"mounted")},v)},L=(u,f,_,E,v)=>{if(_&&F(u,_),E)for(let x=0;x<E.length;x++)F(u,E[x]);if(v){let x=v.subTree;if(f===x){const D=v.vnode;L(u,D,D.scopeId,D.slotScopeIds,v.parent)}}},G=(u,f,_,E,v,x,D,C,P=0)=>{for(let T=P;T<u.length;T++){const Y=u[T]=C?ht(u[T]):qe(u[T]);I(null,Y,f,_,E,v,x,D,C)}},H=(u,f,_,E,v,x,D)=>{const C=f.el=u.el;let{patchFlag:P,dynamicChildren:T,dirs:Y}=f;P|=u.patchFlag&16;const R=u.props||oe,X=f.props||oe;let W;_&&yt(_,!1),(W=X.onVnodeBeforeUpdate)&&Ke(W,_,f,u),Y&&mt(f,u,_,"beforeUpdate"),_&&yt(_,!0);const J=v&&f.type!=="foreignObject";if(T?se(u.dynamicChildren,T,C,_,E,J,x):D||st(u,f,C,null,_,E,J,x,!1),P>0){if(P&16)le(C,f,R,X,_,E,v);else if(P&2&&R.class!==X.class&&r(C,"class",null,X.class,v),P&4&&r(C,"style",R.style,X.style,v),P&8){const ie=f.dynamicProps;for(let re=0;re<ie.length;re++){const ce=ie[re],$e=R[ce],Ft=X[ce];(Ft!==$e||ce==="value")&&r(C,ce,$e,Ft,v,u.children,_,E,nt)}}P&1&&u.children!==f.children&&g(C,f.children)}else!D&&T==null&&le(C,f,R,X,_,E,v);((W=X.onVnodeUpdated)||Y)&&Pe(()=>{W&&Ke(W,_,f,u),Y&&mt(f,u,_,"updated")},E)},se=(u,f,_,E,v,x,D)=>{for(let C=0;C<f.length;C++){const P=u[C],T=f[C],Y=P.el&&(P.type===pe||!bt(P,T)||P.shapeFlag&70)?p(P.el):_;I(P,T,Y,null,E,v,x,D,!0)}},le=(u,f,_,E,v,x,D)=>{if(_!==E){for(const C in E){if(ks(C))continue;const P=E[C],T=_[C];P!==T&&C!=="value"&&r(u,C,T,P,D,f.children,v,x,nt)}if(_!==oe)for(const C in _)!ks(C)&&!(C in E)&&r(u,C,_[C],null,D,f.children,v,x,nt);"value"in E&&r(u,"value",_.value,E.value)}},me=(u,f,_,E,v,x,D,C,P)=>{const T=f.el=u?u.el:l(""),Y=f.anchor=u?u.anchor:l("");let{patchFlag:R,dynamicChildren:X,slotScopeIds:W}=f;W&&(C=C?C.concat(W):W),u==null?(n(T,_,E),n(Y,_,E),G(f.children,_,Y,v,x,D,C,P)):R>0&&R&64&&X&&u.dynamicChildren?(se(u.dynamicChildren,X,_,v,x,D,C),(f.key!=null||v&&f===v.subTree)&&_o(u,f,!0)):st(u,f,_,Y,v,x,D,C,P)},ze=(u,f,_,E,v,x,D,C,P)=>{f.slotScopeIds=C,u==null?f.shapeFlag&512?v.ctx.activate(f,_,E,D,P):tt(f,_,E,v,x,D,P):xe(u,f,P)},tt=(u,f,_,E,v,x,D)=>{const C=u.component=hc(u,E,v);if(hn(u)&&(C.ctx.renderer=Pt),fc(C),C.asyncDep){if(v&&v.registerDep(C,fe),!u.el){const P=C.subTree=V(Le);S(null,P,f,_)}return}fe(C,u,f,_,v,x,D)},xe=(u,f,_)=>{const E=f.component=u.component;if(_a(u,f,_))if(E.asyncDep&&!E.asyncResolved){ae(E,f,_);return}else E.next=f,da(E.update),E.update();else f.el=u.el,E.vnode=f},fe=(u,f,_,E,v,x,D)=>{const C=()=>{if(u.isMounted){let{next:Y,bu:R,u:X,parent:W,vnode:J}=u,ie=Y,re;yt(u,!1),Y?(Y.el=J.el,ae(u,Y,D)):Y=J,R&&Bs(R),(re=Y.props&&Y.props.onVnodeBeforeUpdate)&&Ke(re,W,Y,J),yt(u,!0);const ce=vn(u),$e=u.subTree;u.subTree=ce,I($e,ce,p($e.el),Ts($e),u,v,x),Y.el=ce.el,ie===null&&va(u,ce.el),X&&Pe(X,v),(re=Y.props&&Y.props.onVnodeUpdated)&&Pe(()=>Ke(re,W,Y,J),v)}else{let Y;const{el:R,props:X}=f,{bm:W,m:J,parent:ie}=u,re=ts(f);if(yt(u,!1),W&&Bs(W),!re&&(Y=X&&X.onVnodeBeforeMount)&&Ke(Y,ie,f),yt(u,!0),R&&wn){const ce=()=>{u.subTree=vn(u),wn(R,u.subTree,u,v,null)};re?f.type.__asyncLoader().then(()=>!u.isUnmounted&&ce()):ce()}else{const ce=u.subTree=vn(u);I(null,ce,_,E,u,v,x),f.el=ce.el}if(J&&Pe(J,v),!re&&(Y=X&&X.onVnodeMounted)){const ce=f;Pe(()=>Ke(Y,ie,ce),v)}(f.shapeFlag&256||ie&&ts(ie.vnode)&&ie.vnode.shapeFlag&256)&&u.a&&Pe(u.a,v),u.isMounted=!0,f=_=E=null}},P=u.effect=new si(C,()=>qr(T),u.scope),T=u.update=()=>P.run();T.id=u.uid,yt(u,!0),T()},ae=(u,f,_)=>{f.component=u;const E=u.vnode.props;u.vnode=f,u.next=null,Ga(u,f.props,E,_),Ja(u,f.children,_),$t(),an(void 0,u.update),Yt()},st=(u,f,_,E,v,x,D,C,P=!1)=>{const T=u&&u.children,Y=u?u.shapeFlag:0,R=f.children,{patchFlag:X,shapeFlag:W}=f;if(X>0){if(X&128){Ut(T,R,_,E,v,x,D,C,P);return}else if(X&256){mn(T,R,_,E,v,x,D,C,P);return}}W&8?(Y&16&&nt(T,v,x),R!==T&&g(_,R)):Y&16?W&16?Ut(T,R,_,E,v,x,D,C,P):nt(T,v,x,!0):(Y&8&&g(_,""),W&16&&G(R,_,E,v,x,D,C,P))},mn=(u,f,_,E,v,x,D,C,P)=>{u=u||Dt,f=f||Dt;const T=u.length,Y=f.length,R=Math.min(T,Y);let X;for(X=0;X<R;X++){const W=f[X]=P?ht(f[X]):qe(f[X]);I(u[X],W,_,null,v,x,D,C,P)}T>Y?nt(u,v,x,!0,!1,R):G(f,_,E,v,x,D,C,P,R)},Ut=(u,f,_,E,v,x,D,C,P)=>{let T=0;const Y=f.length;let R=u.length-1,X=Y-1;for(;T<=R&&T<=X;){const W=u[T],J=f[T]=P?ht(f[T]):qe(f[T]);if(bt(W,J))I(W,J,_,null,v,x,D,C,P);else break;T++}for(;T<=R&&T<=X;){const W=u[R],J=f[X]=P?ht(f[X]):qe(f[X]);if(bt(W,J))I(W,J,_,null,v,x,D,C,P);else break;R--,X--}if(T>R){if(T<=X){const W=X+1,J=W<Y?f[W].el:E;for(;T<=X;)I(null,f[T]=P?ht(f[T]):qe(f[T]),_,J,v,x,D,C,P),T++}}else if(T>X)for(;T<=R;)lt(u[T],v,x,!0),T++;else{const W=T,J=T,ie=new Map;for(T=J;T<=X;T++){const Fe=f[T]=P?ht(f[T]):qe(f[T]);Fe.key!=null&&ie.set(Fe.key,T)}let re,ce=0;const $e=X-J+1;let Ft=!1,Pi=0;const Ht=new Array($e);for(T=0;T<$e;T++)Ht[T]=0;for(T=W;T<=R;T++){const Fe=u[T];if(ce>=$e){lt(Fe,v,x,!0);continue}let Ve;if(Fe.key!=null)Ve=ie.get(Fe.key);else for(re=J;re<=X;re++)if(Ht[re-J]===0&&bt(Fe,f[re])){Ve=re;break}Ve===void 0?lt(Fe,v,x,!0):(Ht[Ve-J]=T+1,Ve>=Pi?Pi=Ve:Ft=!0,I(Fe,f[Ve],_,null,v,x,D,C,P),ce++)}const Fi=Ft?nc(Ht):Dt;for(re=Fi.length-1,T=$e-1;T>=0;T--){const Fe=J+T,Ve=f[Fe],ki=Fe+1<Y?f[Fe+1].el:E;Ht[T]===0?I(null,Ve,_,ki,v,x,D,C,P):Ft&&(re<0||T!==Fi[re]?At(Ve,_,ki,2):re--)}}},At=(u,f,_,E,v=null)=>{const{el:x,type:D,transition:C,children:P,shapeFlag:T}=u;if(T&6){At(u.component.subTree,f,_,E);return}if(T&128){u.suspense.move(f,_,E);return}if(T&64){D.move(u,f,_,Pt);return}if(D===pe){n(x,f,_);for(let R=0;R<P.length;R++)At(P[R],f,_,E);n(u.anchor,f,_);return}if(D===Sn){M(u,f,_);return}if(E!==2&&T&1&&C)if(E===0)C.beforeEnter(x),n(x,f,_),Pe(()=>C.enter(x),v);else{const{leave:R,delayLeave:X,afterLeave:W}=C,J=()=>n(x,f,_),ie=()=>{R(x,()=>{J(),W&&W()})};X?X(x,J,ie):ie()}else n(x,f,_)},lt=(u,f,_,E=!1,v=!1)=>{const{type:x,props:D,ref:C,children:P,dynamicChildren:T,shapeFlag:Y,patchFlag:R,dirs:X}=u;if(C!=null&&Xn(C,null,_,u,!0),Y&256){f.ctx.deactivate(u);return}const W=Y&1&&X,J=!ts(u);let ie;if(J&&(ie=D&&D.onVnodeBeforeUnmount)&&Ke(ie,f,u),Y&6)gl(u.component,_,E);else{if(Y&128){u.suspense.unmount(_,E);return}W&&mt(u,null,f,"beforeUnmount"),Y&64?u.type.remove(u,f,_,v,Pt,E):T&&(x!==pe||R>0&&R&64)?nt(T,f,_,!1,!0):(x===pe&&R&384||!v&&Y&16)&&nt(P,f,_),E&&xi(u)}(J&&(ie=D&&D.onVnodeUnmounted)||W)&&Pe(()=>{ie&&Ke(ie,f,u),W&&mt(u,null,f,"unmounted")},_)},xi=u=>{const{type:f,el:_,anchor:E,transition:v}=u;if(f===pe){dl(_,E);return}if(f===Sn){N(u);return}const x=()=>{i(_),v&&!v.persisted&&v.afterLeave&&v.afterLeave()};if(u.shapeFlag&1&&v&&!v.persisted){const{leave:D,delayLeave:C}=v,P=()=>D(_,x);C?C(u.el,x,P):P()}else x()},dl=(u,f)=>{let _;for(;u!==f;)_=m(u),i(u),u=_;i(f)},gl=(u,f,_)=>{const{bum:E,scope:v,update:x,subTree:D,um:C}=u;E&&Bs(E),v.stop(),x&&(x.active=!1,lt(D,u,f,_)),C&&Pe(C,f),Pe(()=>{u.isUnmounted=!0},f),f&&f.pendingBranch&&!f.isUnmounted&&u.asyncDep&&!u.asyncResolved&&u.suspenseId===f.pendingId&&(f.deps--,f.deps===0&&f.resolve())},nt=(u,f,_,E=!1,v=!1,x=0)=>{for(let D=x;D<u.length;D++)lt(u[D],f,_,E,v)},Ts=u=>u.shapeFlag&6?Ts(u.component.subTree):u.shapeFlag&128?u.suspense.next():m(u.anchor||u.el),Ai=(u,f,_)=>{u==null?f._vnode&&lt(f._vnode,null,null,!0):I(f._vnode||null,u,f,null,null,null,_),Qr(),f._vnode=u},Pt={p:I,um:lt,m:At,r:xi,mt:tt,mc:G,pc:st,pbc:se,n:Ts,o:t};let yn,wn;return e&&([yn,wn]=e(Pt)),{render:Ai,hydrate:yn,createApp:ec(Ai,yn)}}function yt({effect:t,update:e},s){t.allowRecurse=e.allowRecurse=s}function _o(t,e,s=!1){const n=t.children,i=e.children;if(U(n)&&U(i))for(let r=0;r<n.length;r++){const o=n[r];let l=i[r];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=i[r]=ht(i[r]),l.el=o.el),s||_o(o,l))}}function nc(t){const e=t.slice(),s=[0];let n,i,r,o,l;const a=t.length;for(n=0;n<a;n++){const h=t[n];if(h!==0){if(i=s[s.length-1],t[i]<h){e[n]=i,s.push(n);continue}for(r=0,o=s.length-1;r<o;)l=r+o>>1,t[s[l]]<h?r=l+1:o=l;h<t[s[r]]&&(r>0&&(e[n]=s[r-1]),s[r]=n)}}for(r=s.length,o=s[r-1];r-- >0;)s[r]=o,o=e[o];return s}const ic=t=>t.__isTeleport,pe=Symbol(void 0),hi=Symbol(void 0),Le=Symbol(void 0),Sn=Symbol(void 0),ss=[];let Ue=null;function K(t=!1){ss.push(Ue=t?null:[])}function rc(){ss.pop(),Ue=ss[ss.length-1]||null}let ds=1;function Qi(t){ds+=t}function vo(t){return t.dynamicChildren=ds>0?Ue||Dt:null,rc(),ds>0&&Ue&&Ue.push(t),t}function Q(t,e,s,n,i,r){return vo(O(t,e,s,n,i,r,!0))}function It(t,e,s,n,i){return vo(V(t,e,s,n,i,!0))}function bo(t){return t?t.__v_isVNode===!0:!1}function bt(t,e){return t.type===e.type&&t.key===e.key}const dn="__vInternal",Eo=({key:t})=>t!=null?t:null,Rs=({ref:t,ref_key:e,ref_for:s})=>t!=null?_e(t)||Se(t)||j(t)?{i:Te,r:t,k:e,f:!!s}:t:null;function O(t,e=null,s=null,n=0,i=null,r=t===pe?0:1,o=!1,l=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Eo(e),ref:e&&Rs(e),scopeId:un,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return l?(fi(a,s),r&128&&t.normalize(a)):s&&(a.shapeFlag|=_e(s)?8:16),ds>0&&!o&&Ue&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&Ue.push(a),a}const V=oc;function oc(t,e=null,s=null,n=0,i=null,r=!1){if((!t||t===$a)&&(t=Le),bo(t)){const l=pt(t,e,!0);return s&&fi(l,s),ds>0&&!r&&Ue&&(l.shapeFlag&6?Ue[Ue.indexOf(t)]=l:Ue.push(l)),l.patchFlag|=-2,l}if(yc(t)&&(t=t.__vccOpts),e){e=lc(e);let{class:l,style:a}=e;l&&!_e(l)&&(e.class=be(l)),ge(a)&&(Wr(a)&&!U(a)&&(a=Me({},a)),e.style=Qs(a))}const o=_e(t)?1:ba(t)?128:ic(t)?64:ge(t)?4:j(t)?2:0;return O(t,e,s,n,i,o,r,!0)}function lc(t){return t?Wr(t)||dn in t?Me({},t):t:null}function pt(t,e,s=!1){const{props:n,ref:i,patchFlag:r,children:o}=t,l=e?ac(n||{},e):n;return{__v_isVNode:!0,__v_skip:!0,type:t.type,props:l,key:l&&Eo(l),ref:e&&e.ref?s&&i?U(i)?i.concat(Rs(e)):[i,Rs(e)]:Rs(e):i,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:o,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==pe?r===-1?16:r|16:r,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:t.transition,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&pt(t.ssContent),ssFallback:t.ssFallback&&pt(t.ssFallback),el:t.el,anchor:t.anchor}}function he(t=" ",e=0){return V(hi,null,t,e)}function Ee(t="",e=!1){return e?(K(),It(Le,null,t)):V(Le,null,t)}function qe(t){return t==null||typeof t=="boolean"?V(Le):U(t)?V(pe,null,t.slice()):typeof t=="object"?ht(t):V(hi,null,String(t))}function ht(t){return t.el===null||t.memo?t:pt(t)}function fi(t,e){let s=0;const{shapeFlag:n}=t;if(e==null)e=null;else if(U(e))s=16;else if(typeof e=="object")if(n&65){const i=e.default;i&&(i._c&&(i._d=!1),fi(t,i()),i._c&&(i._d=!0));return}else{s=32;const i=e._;!i&&!(dn in e)?e._ctx=Te:i===3&&Te&&(Te.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else j(e)?(e={default:e,_ctx:Te},s=32):(e=String(e),n&64?(s=16,e=[he(e)]):s=8);t.children=e,t.shapeFlag|=s}function ac(...t){const e={};for(let s=0;s<t.length;s++){const n=t[s];for(const i in n)if(i==="class")e.class!==n.class&&(e.class=be([e.class,n.class]));else if(i==="style")e.style=Qs([e.style,n.style]);else if(tn(i)){const r=e[i],o=n[i];o&&r!==o&&!(U(r)&&r.includes(o))&&(e[i]=r?[].concat(r,o):o)}else i!==""&&(e[i]=n[i])}return e}function Ke(t,e,s,n=null){Re(t,e,7,[s,n])}const cc=wo();let uc=0;function hc(t,e,s){const n=t.type,i=(e?e.appContext:t.appContext)||cc,r={uid:uc++,vnode:t,type:n,parent:e,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new Fl(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:go(n,i),emitsOptions:to(n,i),emit:null,emitted:null,propsDefaults:oe,inheritAttrs:n.inheritAttrs,ctx:oe,data:oe,props:oe,attrs:oe,slots:oe,refs:oe,setupState:oe,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=ma.bind(null,r),t.ce&&t.ce(r),r}let we=null;const di=()=>we||Te,Lt=t=>{we=t,t.scope.on()},Ct=()=>{we&&we.scope.off(),we=null};function So(t){return t.vnode.shapeFlag&4}let gs=!1;function fc(t,e=!1){gs=e;const{props:s,children:n}=t.vnode,i=So(t);Ka(t,s,i,e),Za(t,n);const r=i?dc(t,e):void 0;return gs=!1,r}function dc(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=jr(new Proxy(t.ctx,Ua));const{setup:n}=s;if(n){const i=t.setupContext=n.length>1?pc(t):null;Lt(t),$t();const r=dt(n,t,0,[t.props,i]);if(Yt(),Ct(),Pr(r)){if(r.then(Ct,Ct),e)return r.then(o=>{er(t,o,e)}).catch(o=>{ln(o,t,0)});t.asyncDep=r}else er(t,r,e)}else To(t,e)}function er(t,e,s){j(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:ge(e)&&(t.setupState=Kr(e)),To(t,s)}let tr;function To(t,e,s){const n=t.type;if(!t.render){if(!e&&tr&&!n.render){const i=n.template;if(i){const{isCustomElement:r,compilerOptions:o}=t.appContext.config,{delimiters:l,compilerOptions:a}=n,h=Me(Me({isCustomElement:r,delimiters:l},o),a);n.render=tr(i,h)}}t.render=n.render||We}Lt(t),$t(),Ha(t),Yt(),Ct()}function gc(t){return new Proxy(t.attrs,{get(e,s){return Be(t,"get","$attrs"),e[s]}})}function pc(t){const e=n=>{t.exposed=n||{}};let s;return{get attrs(){return s||(s=gc(t))},slots:t.slots,emit:t.emit,expose:e}}function gn(t){if(t.exposed)return t.exposeProxy||(t.exposeProxy=new Proxy(Kr(jr(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in Ws)return Ws[s](t)}}))}function mc(t,e=!0){return j(t)?t.displayName||t.name:t.name||e&&t.__name}function yc(t){return j(t)&&"__vccOpts"in t}const Mo=(t,e)=>ca(t,e,gs),wc="3.2.37",_c="http://www.w3.org/2000/svg",Et=typeof document<"u"?document:null,sr=Et&&Et.createElement("template"),vc={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,n)=>{const i=e?Et.createElementNS(_c,t):Et.createElement(t,s?{is:s}:void 0);return t==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:t=>Et.createTextNode(t),createComment:t=>Et.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Et.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},cloneNode(t){const e=t.cloneNode(!0);return"_value"in t&&(e._value=t._value),e},insertStaticContent(t,e,s,n,i,r){const o=s?s.previousSibling:e.lastChild;if(i&&(i===r||i.nextSibling))for(;e.insertBefore(i.cloneNode(!0),s),!(i===r||!(i=i.nextSibling)););else{sr.innerHTML=n?`<svg>${t}</svg>`:t;const l=sr.content;if(n){const a=l.firstChild;for(;a.firstChild;)l.appendChild(a.firstChild);l.removeChild(a)}e.insertBefore(l,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}};function bc(t,e,s){const n=t._vtc;n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}function Ec(t,e,s){const n=t.style,i=_e(s);if(s&&!i){for(const r in s)Un(n,r,s[r]);if(e&&!_e(e))for(const r in e)s[r]==null&&Un(n,r,"")}else{const r=n.display;i?e!==s&&(n.cssText=s):e&&t.removeAttribute("style"),"_vod"in t&&(n.display=r)}}const nr=/\s*!important$/;function Un(t,e,s){if(U(s))s.forEach(n=>Un(t,e,n));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const n=Sc(t,e);nr.test(s)?t.setProperty(Nt(n),s.replace(nr,""),"important"):t[n]=s}}const ir=["Webkit","Moz","ms"],Tn={};function Sc(t,e){const s=Tn[e];if(s)return s;let n=Qe(e);if(n!=="filter"&&n in t)return Tn[e]=n;n=rn(n);for(let i=0;i<ir.length;i++){const r=ir[i]+n;if(r in t)return Tn[e]=r}return e}const rr="http://www.w3.org/1999/xlink";function Tc(t,e,s,n,i){if(n&&e.startsWith("xlink:"))s==null?t.removeAttributeNS(rr,e.slice(6,e.length)):t.setAttributeNS(rr,e,s);else{const r=wl(e);s==null||r&&!xr(s)?t.removeAttribute(e):t.setAttribute(e,r?"":s)}}function Mc(t,e,s,n,i,r,o){if(e==="innerHTML"||e==="textContent"){n&&o(n,i,r),t[e]=s==null?"":s;return}if(e==="value"&&t.tagName!=="PROGRESS"&&!t.tagName.includes("-")){t._value=s;const a=s==null?"":s;(t.value!==a||t.tagName==="OPTION")&&(t.value=a),s==null&&t.removeAttribute(e);return}let l=!1;if(s===""||s==null){const a=typeof t[e];a==="boolean"?s=xr(s):s==null&&a==="string"?(s="",l=!0):a==="number"&&(s=0,l=!0)}try{t[e]=s}catch{}l&&t.removeAttribute(e)}const[Io,Ic]=(()=>{let t=Date.now,e=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(t=performance.now.bind(performance));const s=navigator.userAgent.match(/firefox\/(\d+)/i);e=!!(s&&Number(s[1])<=53)}return[t,e]})();let Hn=0;const Cc=Promise.resolve(),xc=()=>{Hn=0},Ac=()=>Hn||(Cc.then(xc),Hn=Io());function St(t,e,s,n){t.addEventListener(e,s,n)}function Pc(t,e,s,n){t.removeEventListener(e,s,n)}function Fc(t,e,s,n,i=null){const r=t._vei||(t._vei={}),o=r[e];if(n&&o)o.value=n;else{const[l,a]=kc(e);if(n){const h=r[e]=Bc(n,i);St(t,l,h,a)}else o&&(Pc(t,l,o,a),r[e]=void 0)}}const or=/(?:Once|Passive|Capture)$/;function kc(t){let e;if(or.test(t)){e={};let s;for(;s=t.match(or);)t=t.slice(0,t.length-s[0].length),e[s[0].toLowerCase()]=!0}return[Nt(t.slice(2)),e]}function Bc(t,e){const s=n=>{const i=n.timeStamp||Io();(Ic||i>=s.attached-1)&&Re(Dc(n,s.value),e,5,[n])};return s.value=t,s.attached=Ac(),s}function Dc(t,e){if(U(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(n=>i=>!i._stopped&&n&&n(i))}else return e}const lr=/^on[a-z]/,Oc=(t,e,s,n,i=!1,r,o,l,a)=>{e==="class"?bc(t,n,i):e==="style"?Ec(t,s,n):tn(e)?Jn(e)||Fc(t,e,s,n,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Rc(t,e,n,i))?Mc(t,e,n,r,o,l,a):(e==="true-value"?t._trueValue=n:e==="false-value"&&(t._falseValue=n),Tc(t,e,n,i))};function Rc(t,e,s,n){return n?!!(e==="innerHTML"||e==="textContent"||e in t&&lr.test(e)&&j(s)):e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA"||lr.test(e)&&_e(s)?!1:e in t}const Lc={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};Ca.props;const zs=t=>{const e=t.props["onUpdate:modelValue"]||!1;return U(e)?s=>Bs(e,s):e};function Nc(t){t.target.composing=!0}function ar(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const $c={created(t,{modifiers:{lazy:e,trim:s,number:n}},i){t._assign=zs(i);const r=n||i.props&&i.props.type==="number";St(t,e?"change":"input",o=>{if(o.target.composing)return;let l=t.value;s&&(l=l.trim()),r&&(l=Ys(l)),t._assign(l)}),s&&St(t,"change",()=>{t.value=t.value.trim()}),e||(St(t,"compositionstart",Nc),St(t,"compositionend",ar),St(t,"change",ar))},mounted(t,{value:e}){t.value=e==null?"":e},beforeUpdate(t,{value:e,modifiers:{lazy:s,trim:n,number:i}},r){if(t._assign=zs(r),t.composing||document.activeElement===t&&t.type!=="range"&&(s||n&&t.value.trim()===e||(i||t.type==="number")&&Ys(t.value)===e))return;const o=e==null?"":e;t.value!==o&&(t.value=o)}},Yc={deep:!0,created(t,{value:e,modifiers:{number:s}},n){const i=sn(e);St(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>s?Ys(Vs(o)):Vs(o));t._assign(t.multiple?i?new Set(r):r:r[0])}),t._assign=zs(n)},mounted(t,{value:e}){cr(t,e)},beforeUpdate(t,e,s){t._assign=zs(s)},updated(t,{value:e}){cr(t,e)}};function cr(t,e){const s=t.multiple;if(!(s&&!U(e)&&!sn(e))){for(let n=0,i=t.options.length;n<i;n++){const r=t.options[n],o=Vs(r);if(s)U(e)?r.selected=Sl(e,o)>-1:r.selected=e.has(o);else if(en(Vs(r),e)){t.selectedIndex!==n&&(t.selectedIndex=n);return}}!s&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Vs(t){return"_value"in t?t._value:t.value}const Xc=Me({patchProp:Oc},vc);let ur;function Uc(){return ur||(ur=tc(Xc))}const Co=(...t)=>{const e=Uc().createApp(...t),{mount:s}=e;return e.mount=n=>{const i=Hc(n);if(!i)return;const r=e._component;!j(r)&&!r.render&&!r.template&&(r.template=i.innerHTML),i.innerHTML="";const o=s(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),o},e};function Hc(t){return _e(t)?document.querySelector(t):t}let Wc=1;var q=(t=>(t[t.Unknown=0]="Unknown",t[t.Player=1]="Player",t[t.Enemy=2]="Enemy",t))(q||{}),y=(t=>(t[t.None=0]="None",t[t.Tower=1]="Tower",t[t.Slime=2]="Slime",t[t.Base=3]="Base",t[t.Bullet=4]="Bullet",t[t.Wall=5]="Wall",t[t.Mortar=6]="Mortar",t[t.Flamethrower=7]="Flamethrower",t[t.Flame=8]="Flame",t[t.Railgun=9]="Railgun",t[t.Rail=10]="Rail",t[t.ElectricFence=11]="ElectricFence",t[t.Fence=12]="Fence",t[t.Freezer=13]="Freezer",t[t.Tree=14]="Tree",t[t.Rock=15]="Rock",t[t.Radar=16]="Radar",t[t.PowerPlant=17]="PowerPlant",t[t.Blueprint=18]="Blueprint",t[t.Shockwave=19]="Shockwave",t[t.Armory=20]="Armory",t[t.Market=21]="Market",t[t.SpeedBeacon=22]="SpeedBeacon",t[t.Runner=23]="Runner",t[t.DamageBeacon=24]="DamageBeacon",t[t.Laser=25]="Laser",t[t.LaserBeam=26]="LaserBeam",t))(y||{});const xo=new Set([1,6,7,9,3,14,15,16,17,20,21,22,24,25,5]);class et{constructor(e,s,n){c(this,"id");c(this,"rotation",0);this.x=e,this.y=s,this.agent=n,this.id=Wc++}getX(){return this.x}getAlignedX(){return this.x|0}getY(){return this.y}getAlignedY(){return this.y|0}getAgent(){return this.agent}getId(){return this.id}setX(e){this.x=e}setY(e){this.y=e}getRotation(){return this.rotation}setRotation(e){this.rotation=e}move(e,s,n){const i=(s.getX()-e.getX())*n+e.getX(),r=(s.getY()-e.getY())*n+e.getY();this.setX(i),this.setY(r),this.lookAt(s)}lookAt(e){const s=e.getX()-this.x,n=e.getY()-this.y;(s||n)&&this.setRotation(Math.atan2(n,s)*180/Math.PI+90)}}const ps=t=>t.constructor.scale;function Wn(t){return t?"getTile"in t:!1}class ve extends et{constructor(e,s,n){super(e,s,n)}getAgent(){return this.agent}}var Oe=(t=>(t[t.Undiscovered=0]="Undiscovered",t[t.Pending=1]="Pending",t[t.Discovered=2]="Discovered",t))(Oe||{}),A=(t=>(t[t.Void=0]="Void",t[t.Grass=1]="Grass",t[t.Stone=2]="Stone",t[t.Water=3]="Water",t[t.Obstructed=4]="Obstructed",t[t.Wall=5]="Wall",t[t.Spore=6]="Spore",t[t.ElectricFence=7]="ElectricFence",t[t.Fence=8]="Fence",t[t.Freezer=9]="Freezer",t[t.Bridge=10]="Bridge",t[t.Dirt=11]="Dirt",t[t.Snow=12]="Snow",t[t.Sand=13]="Sand",t[t.Ice=14]="Ice",t[t.PlayerBuilding=15]="PlayerBuilding",t[t.Tree=16]="Tree",t[t.Rock=17]="Rock",t[t.Base=18]="Base",t))(A||{});const Ks=new Set([1,2,11,13,12]),Ao=new Set([...Ks,3,14,10,16,17]),jc=new Set([...Ao,9,7,8]),zc={[y.Tower]:4,[y.Wall]:5,[y.Mortar]:4,[y.Flamethrower]:4,[y.Railgun]:4,[y.ElectricFence]:7,[y.Fence]:8,[y.Freezer]:9,[y.Radar]:18,[y.PowerPlant]:18,[y.Tree]:16,[y.Rock]:17,[y.Armory]:18,[y.Base]:18,[y.Market]:18,[y.SpeedBeacon]:4,[y.DamageBeacon]:4,[y.Laser]:4};class Ye{constructor(e,s,n=0){c(this,"staticEntity",null);c(this,"hash");c(this,"actualType");c(this,"towers",[]);c(this,"linkedAgents");c(this,"discoveryStatus",0);this.x=e,this.y=s,this.type=n,this.hash=`[${this.x}, ${this.y}]`,this.actualType=n}getX(){return this.x}getY(){return this.y}getBaseType(){return this.type}getType(){return this.actualType}getStaticEntity(){return this.staticEntity}hasStaticEntity(){return this.staticEntity!==null}setStaticEntity(e){if(this.staticEntity!==null)throw new Error("A tile can only have 1 static entity.");const s=e.getAgent();Wn(s)&&s.getTile().getHash()===this.getHash()&&(s.updateTile(this),this.linkedAgents&&s.updateLinkedAgents&&s.updateLinkedAgents(this.linkedAgents)),this.staticEntity=e,this.actualType=zc[e.getAgent().getType()]||this.type}clearStaticEntity(){this.staticEntity=null,this.actualType=this.type}addTower(e){this.towers.includes(e)||this.towers.push(e)}setDiscoveryStatus(e){this.discoveryStatus=e}isDiscovered(){return this.discoveryStatus===2}getDiscoveryStatus(){return this.discoveryStatus}isCoveredByTower(){return this.isDiscovered()&&this.towers.length>0}removeTower(e){this.towers.splice(this.towers.indexOf(e),1)}getAvailableTowers(){return this.towers.filter(e=>e.getCooldown()<=0)}addLinkedAgent(e){var n;this.linkedAgents||(this.linkedAgents=new Set),this.linkedAgents.add(e);const s=(n=this.staticEntity)==null?void 0:n.getAgent();s&&s.updateLinkedAgents&&s.updateLinkedAgents(this.linkedAgents)}removeLinkedAgent(e){var n;if(!this.linkedAgents)return;this.linkedAgents.delete(e);const s=(n=this.staticEntity)==null?void 0:n.getAgent();Wn(s)&&s.updateLinkedAgents&&s.updateLinkedAgents(this.linkedAgents)}getLinkedAgents(){return this.linkedAgents}getHash(){return this.hash}sync(e){this.towers=e.towers,this.discoveryStatus=e.discoveryStatus}}const Vc=.5*(Math.sqrt(3)-1),Wt=(3-Math.sqrt(3))/6,hr=t=>Math.floor(t)|0,fr=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function Kc(t=Math.random){const e=Gc(t),s=new Float64Array(e).map(i=>fr[i%12*2]),n=new Float64Array(e).map(i=>fr[i%12*2+1]);return function(r,o){let l=0,a=0,h=0;const g=(r+o)*Vc,p=hr(r+g),m=hr(o+g),F=(p+m)*Wt,k=p-F,B=m-F,I=r-k,d=o-B;let S,b;I>d?(S=1,b=0):(S=0,b=1);const M=I-S+Wt,N=d-b+Wt,$=I-1+2*Wt,z=d-1+2*Wt,L=p&255,G=m&255;let H=.5-I*I-d*d;if(H>=0){const me=L+e[G],ze=s[me],tt=n[me];H*=H,l=H*H*(ze*I+tt*d)}let se=.5-M*M-N*N;if(se>=0){const me=L+S+e[G+b],ze=s[me],tt=n[me];se*=se,a=se*se*(ze*M+tt*N)}let le=.5-$*$-z*z;if(le>=0){const me=L+1+e[G+1],ze=s[me],tt=n[me];le*=le,h=le*le*(ze*$+tt*z)}return 70*(l+a+h)}}function Gc(t){const s=new Uint8Array(512);for(let n=0;n<512/2;n++)s[n]=n;for(let n=0;n<512/2-1;n++){const i=n+~~(t()*(256-n)),r=s[n];s[n]=s[i],s[i]=r}for(let n=256;n<512;n++)s[n]=s[n-256];return s}const _s=(t,e)=>{const s=[],n=ps(t),i=n===2?1:0;w.Instance.getSurface().forCircle(t.getTile().getX()+i,t.getTile().getY()+i,e*n,r=>{if(Ao.has(r.getBaseType())){r.hasStaticEntity()&&r.getStaticEntity().getAgent().category!==q.Player&&w.Instance.getSurface().despawnStatic(r.getStaticEntity().getAgent());const o=new Ye(r.getX(),r.getY(),A.Stone);s.push(o)}}),w.Instance.getSurface().setTiles(s)};class Po{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}spawn(){w.Instance.getBase().addPart(this),_s(this,3)}despawn(){w.Instance.getBase().removePart(this)}getType(){return y.Armory}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){w.Instance.getBase().hit(e)}isVisible(){return!0}}c(Po,"scale",2);const Zs=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"hp",50);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}spawn(){w.Instance.getSurface().getAdjacentTiles(this.tile,Zs.scale).forEach(e=>e.addLinkedAgent(this))}despawn(){w.Instance.getSurface().getAdjacentTiles(this.tile,Zs.scale).forEach(e=>e.removeLinkedAgent(this))}getType(){return y.SpeedBeacon}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}};let ns=Zs;c(ns,"scale",2);const qc=.625;class Fo{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"isEnabled",!0);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this),e.addTower(this)}getCooldown(){return this.isEnabled?0:1}fire(e,s){if(!w.Instance.consumeContinuous(this,s))return 0;const n=qc*s;return e.AI.hit(n),n}despawn(){this.tile.removeTower(this)}getType(){return y.ElectricFence}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}isVisible(){return!0}}c(Fo,"scale",1);class ko{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Fence}getTile(){return this.tile}updateTile(e){this.tile=e}isVisible(){return!0}}c(ko,"scale",1);class Bo{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Freezer}getTile(){return this.tile}updateTile(e){this.tile=e}isVisible(){return!0}}c(Bo,"scale",2);class Do{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}spawn(){w.Instance.getBase().addPart(this),_s(this,3)}despawn(){w.Instance.getBase().removePart(this)}getType(){return y.Market}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){w.Instance.getBase().hit(e)}isVisible(){return!0}}c(Do,"scale",2);class Oo{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.PowerPlant}getTile(){return this.tile}updateTile(e){this.tile=e}spawn(){w.Instance.getBase().addPart(this),_s(this,3)}despawn(){w.Instance.getBase().removePart(this)}hit(e){w.Instance.getBase().hit(e)}isVisible(){return!0}}c(Oo,"scale",2);class Ro{constructor(e){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Radar}getTile(){return this.tile}updateTile(e){this.tile=e}spawn(){w.Instance.getVisibilityController().registerAgent(this),w.Instance.getBase().addPart(this),_s(this,3)}despawn(){w.Instance.getVisibilityController().removeAgent(this),w.Instance.getBase().removePart(this)}hit(e){w.Instance.getBase().hit(e)}isVisible(){return!0}}c(Ro,"scale",2);var ue=(t=>(t[t.StatUpdate=0]="StatUpdate",t[t.SurfaceChange=1]="SurfaceChange",t[t.BlackOut=2]="BlackOut",t[t.OpenBuildMenu=3]="OpenBuildMenu",t[t.CloseBuildMenu=4]="CloseBuildMenu",t[t.ToggleShowCoverage=5]="ToggleShowCoverage",t[t.StartWave=6]="StartWave",t[t.EndWave=7]="EndWave",t))(ue||{});const Js=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"hp",50);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}spawn(){w.Instance.getSurface().getAdjacentTiles(this.tile,Js.scale).forEach(e=>e.addLinkedAgent(this))}despawn(){w.Instance.getSurface().getAdjacentTiles(this.tile,Js.scale).forEach(e=>e.removeLinkedAgent(this))}getType(){return y.DamageBeacon}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}};let is=Js;c(is,"scale",1);const vs=(t,e,s)=>{const n=w.Instance.getSurface(),i=new Set,r=()=>{const l=new Set(n.getEntityTiles(t));n.forCircle(t.entity.getX()+1,t.entity.getY()+1,e,a=>{n.forLine(t.entity.getX(),t.entity.getY(),a.getX(),a.getY(),h=>{if(h.addTower(t),i.add(h),!l.has(h)&&s&&s(h))return!1},{connected:!0})},{edgeOnly:!0})};r();const o=w.Instance.addEventListener(ue.SurfaceChange,({affectedTiles:l})=>{for(const a of l)if(i.has(a)){i.forEach(h=>h.removeTower(t)),i.clear(),r();return}});return()=>{i.forEach(l=>l.removeTower(t)),o()}},bs=t=>{let e=1;return t.forEach(s=>{s instanceof ns&&(e+=.5)}),e},Es=t=>{let e=1;return t.forEach(s=>{s instanceof is&&(e+=.5)}),e},Zc=new Set([A.Obstructed,A.Wall,A.PlayerBuilding,A.Base]),Ss=t=>Zc.has(t.getType()),jn=250;class Jc{constructor(e){c(this,"entity");c(this,"category",q.Unknown);c(this,"time",0);this.tile=e,this.entity=new et(e.getX(),e.getY(),this)}dealDamage(e,s){this.time>jn&&w.Instance.getSurface().spawn(this),this.time=0;const n=Math.atan2(e.entity.getY()-this.tile.getY(),e.entity.getX()-this.tile.getX());this.entity.setRotation(n*180/Math.PI),this.entity.setX(e.entity.getAlignedX()),this.entity.setY(e.entity.getAlignedY()),e.AI.hit(s),e.lightOnFire&&e.lightOnFire()}tick(e){this.time+=e,this.time>jn&&w.Instance.getSurface().despawn(this)}getType(){return y.Flame}getTile(){return this.tile}isVisible(){return!0}}const dr=1,Qc=.05,vi=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"cooldown",0);c(this,"cleanupEventListener");c(this,"flame");c(this,"hp",200);c(this,"isEnabled",!0);c(this,"damageMultiplier",1);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}tick(e){!this.isEnabled||(this.cooldown=Math.max(0,this.cooldown-e))}fire(e,s){this.cooldown=dr;const n=w.Instance.consumeContinuous(this,s,this.damageMultiplier),i=Qc*(n?this.damageMultiplier:1)*s;return this.flame||(this.flame=new Jc(this.tile),w.Instance.getSurface().spawn(this.flame)),this.flame.dealDamage(e,i),i}spawn(){this.cleanupEventListener=vs(this,vi.range,Ss)}despawn(){var e;(e=this.cleanupEventListener)==null||e.call(this)}updateLinkedAgents(e){this.damageMultiplier=bs(e)*Es(e)}getCooldown(){return this.cooldown}getType(){return y.Flamethrower}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.cooldown=dr,this.isEnabled=!1}};let Vt=vi;c(Vt,"scale",2),c(Vt,"range",6);const eu=.01,gr=5,pr=2,tu=pr*pr;class su{constructor(e,s,n){c(this,"entity");c(this,"category",q.Unknown);c(this,"targetX");c(this,"targetY");c(this,"time",0);c(this,"travelTime");this.tile=e,this.target=s,this.damage=n,this.entity=new et(e.getX(),e.getY(),this);const i=e.getX()-s.entity.getX(),r=e.getY()-s.entity.getY(),o=gr*2+Math.sqrt(i*i+r*r);this.travelTime=o/eu;const l=this.target.AI.getFuturePosition(this.travelTime),{x:a,y:h}=s.getPath().getCoordinates(l);this.targetX=a,this.targetY=h}tick(e){if(this.time>=this.travelTime){w.Instance.getSurface().despawn(this);let i=!1;[...w.Instance.getSurface().getEntitiesForCategory(q.Enemy)].filter(r=>{const o=r.getX()-this.entity.getX(),l=r.getY()-this.entity.getY();return o*o+l*l<tu}).forEach(r=>{r.getAgent().AI.hit(this.damage),r.getAgent()===this.target&&(i=!0)}),i||this.target.AI.miss(this.damage)}this.time=Math.min(this.time+e,this.travelTime);const s=this.time/this.travelTime;this.entity.setX((this.targetX-this.tile.getX())*s+this.tile.getX());const n=Math.sin(s*Math.PI)*gr;this.entity.setY((this.targetY-this.tile.getY())*s+this.tile.getY()-n)}getType(){return y.Bullet}getTile(){return this.tile}isVisible(){return!0}}const mr=5e3,nu=100,bi=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"cooldown",0);c(this,"cleanupEventListener");c(this,"hp",100);c(this,"isEnabled",!0);c(this,"speedMultiplier",1);c(this,"damageMultiplier",1);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}tick(e){!this.isEnabled||this.cooldown<=0||(this.cooldown-=e*this.speedMultiplier)}fire(e){this.cooldown+=mr;const s=w.Instance.consume(this,this.speedMultiplier,this.damageMultiplier),n=nu*(s?this.damageMultiplier:0),i=new su(this.tile,e,n);return w.Instance.getSurface().spawn(i),n}spawn(){this.cleanupEventListener=vs(this,bi.range)}despawn(){var e;(e=this.cleanupEventListener)==null||e.call(this)}updateLinkedAgents(e){this.speedMultiplier=bs(e),this.damageMultiplier=Es(e)}getCooldown(){return this.cooldown}getType(){return y.Mortar}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.cooldown=mr,this.isEnabled=!1}};let Kt=bi;c(Kt,"scale",2),c(Kt,"range",30);const iu=(t,e)=>(t%e+e)%e,ru=(t,e,s,n,i)=>{const r=Math.atan2(i-e,n-t);let o=iu(r-s+Math.PI,Math.PI*2)-Math.PI;return Math.abs(o)>=Math.PI?Number.POSITIVE_INFINITY:Math.abs(Math.cos(s)*(e-i)-Math.sin(s)*(t-n))},Lo=1500;class ou{constructor(e,s,n){c(this,"entity");c(this,"category",q.Unknown);c(this,"targetX");c(this,"targetY");c(this,"time",0);c(this,"steps",[]);this.tile=e,this.damage=n,this.entity=new et(e.getX(),e.getY(),this);const i=Math.atan2(s.entity.getY()-e.getY(),s.entity.getX()-e.getX());this.entity.setRotation(i*180/Math.PI),w.Instance.getSurface().forRay(e.getX(),e.getY(),i,(r,o)=>o>0&&Ss(r)?!1:(this.steps.push(r),!0)),this.targetX=this.steps[this.steps.length-1].getX(),this.targetY=this.steps[this.steps.length-1].getY(),[...w.Instance.getSurface().getEntitiesForCategory(q.Enemy)].filter(r=>ru(e.getX(),e.getY(),i,r.getX(),r.getY())<=.5).forEach(r=>r.getAgent().AI.hit(this.damage))}tick(e){this.time+=e,this.time>Lo&&w.Instance.getSurface().despawn(this)}getType(){return y.Rail}getTile(){return this.tile}isVisible(){return!0}}const yr=5e3,lu=100,Ei=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"cooldown",0);c(this,"cleanupEventListener");c(this,"hp",100);c(this,"isEnabled",!0);c(this,"speedMultiplier",1);c(this,"damageMultiplier",1);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}tick(e){!this.isEnabled||this.cooldown<=0||(this.cooldown-=e*this.speedMultiplier)}fire(e){if(this.cooldown+=yr,!w.Instance.consume(this,this.speedMultiplier,this.damageMultiplier))return 0;const s=lu*this.damageMultiplier,n=new ou(this.tile,e,s);return w.Instance.getSurface().spawn(n),s}spawn(){this.cleanupEventListener=vs(this,Ei.range,Ss)}despawn(){var e;(e=this.cleanupEventListener)==null||e.call(this)}updateLinkedAgents(e){this.speedMultiplier=bs(e),this.damageMultiplier=Es(e)}getCooldown(){return this.cooldown}getType(){return y.Railgun}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.cooldown=yr,this.isEnabled=!1}};let Gt=Ei;c(Gt,"scale",2),c(Gt,"range",30);const au=.015;class cu{constructor(e,s,n){c(this,"entity");c(this,"category",q.Unknown);c(this,"targetX");c(this,"targetY");c(this,"time",0);c(this,"travelTime");this.tile=e,this.target=s,this.damage=n,this.entity=new et(e.getX(),e.getY(),this);const i=e.getX()-s.entity.getX(),r=e.getY()-s.entity.getY(),o=Math.sqrt(i*i+r*r);this.travelTime=o/au;const l=this.target.AI.getFuturePosition(this.travelTime),{x:a,y:h}=s.getPath().getCoordinates(l);this.targetX=a,this.targetY=h}tick(e){this.time>=this.travelTime&&(w.Instance.getSurface().despawn(this),this.target.AI.hit(this.damage)),this.time=Math.min(this.time+e,this.travelTime);const s=this.time/this.travelTime;this.entity.setX((this.targetX-this.tile.getX())*s+this.tile.getX()),this.entity.setY((this.targetY-this.tile.getY())*s+this.tile.getY())}getType(){return y.Bullet}getTile(){return this.tile}isVisible(){return!0}}const wr=500,uu=10,Si=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"cooldown",0);c(this,"cleanupEventListener");c(this,"hp",50);c(this,"isEnabled",!0);c(this,"speedMultiplier",1);c(this,"damageMultiplier",1);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}tick(e){!this.isEnabled||this.cooldown<=0||(this.cooldown-=e*this.speedMultiplier)}fire(e){this.cooldown+=wr;const s=w.Instance.consume(this,this.speedMultiplier,this.damageMultiplier),n=uu*(s?this.damageMultiplier:1),i=new cu(this.tile,e,n);return w.Instance.getSurface().spawn(i),n}spawn(){this.cleanupEventListener=vs(this,Si.range,Ss)}despawn(){var e;(e=this.cleanupEventListener)==null||e.call(this)}updateLinkedAgents(e){this.speedMultiplier=bs(e),this.damageMultiplier=Es(e)}getCooldown(){return this.cooldown}getType(){return y.Tower}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.cooldown=wr,this.isEnabled=!1}};let qt=Si;c(qt,"scale",2),c(qt,"range",10);class No{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"hp",50);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Wall}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}}c(No,"scale",1);const zn=250;class hu{constructor(e){c(this,"entity");c(this,"category",q.Unknown);c(this,"time",0);c(this,"targetX",0);c(this,"targetY",0);this.tile=e,this.entity=new et(e.getX(),e.getY(),this)}dealDamage(e,s){this.time>zn&&w.Instance.getSurface().spawn(this),this.time=0,this.targetX=e.entity.getX(),this.targetY=e.entity.getY();const n=Math.atan2(this.targetY-this.tile.getY(),this.targetX-this.tile.getX());this.entity.setRotation(n*180/Math.PI),e.AI.hit(s),e.lightOnFire&&e.lightOnFire()}tick(e){this.time+=e,this.time>zn&&w.Instance.getSurface().despawn(this)}getType(){return y.LaserBeam}getTile(){return this.tile}isVisible(){return!0}}const _r=1,fu=.05,Ti=class{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"cooldown",0);c(this,"cleanupEventListener");c(this,"laserBeam");c(this,"hp",100);c(this,"isEnabled",!0);c(this,"damageMultiplier",1);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}tick(e){!this.isEnabled||this.cooldown<=0||(this.cooldown=Math.max(0,this.cooldown-e))}fire(e,s){if(this.cooldown=_r,!w.Instance.consumeContinuous(this,s,this.damageMultiplier))return 0;const n=fu*this.damageMultiplier*s;return this.laserBeam||(this.laserBeam=new hu(this.tile),w.Instance.getSurface().spawn(this.laserBeam)),this.laserBeam.dealDamage(e,n),n}spawn(){this.cleanupEventListener=vs(this,Ti.range,Ss)}despawn(){var e;(e=this.cleanupEventListener)==null||e.call(this)}updateLinkedAgents(e){this.damageMultiplier=bs(e)*Es(e)}getCooldown(){return this.cooldown}getType(){return y.Laser}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return!0}getTile(){return this.tile}updateTile(e){this.tile=e}enable(){this.isEnabled=!0}disable(){this.cooldown=_r,this.isEnabled=!1}};let Zt=Ti;c(Zt,"scale",2),c(Zt,"range",16);const $o={name:"Fence",description:"A simple fence that land-based enemies have to walk around. If the fence becomes too long however, they will climb over it. Fences are low to towers can shoot over them.",entity:ko,entityType:y.Fence,htmlElement:"\u{1F945}"},Yo={name:"Wall",description:"A large solid wall that land-based enemies have to walk around. If the wall is too long, enemies will attack and break it to continue their path but this less likely compared to fences. Walls block tower sight lines.",entity:No,entityType:y.Wall,htmlElement:"\u{1F6A7}"},Xo={name:"Electric fence",description:"Electric fences are similar to their normal counterpart but enemies are far less likely to climb over them. If they do they will also continuously receive damage, given that you have enough power stored.",entity:Fo,entityType:y.ElectricFence,htmlElement:"\u26A1"},Uo={name:"Freezer",description:"A large pad that slows down land-based enemies that walk over it. The pad does not repel or attract enemies so they still have to be guided to walk over it.",entity:Bo,entityType:y.Freezer,htmlElement:"\u2744\uFE0F"},Ho={name:"Tower",description:"The cheapest and most basic tower. It has poor range and deals little damage",entity:qt,entityType:y.Tower,htmlElement:"\u{1F5FC}"},Wo={name:"Mortar",description:"A powerful tower with a large range that can shoot over obstacles. It also deals splash damage, hurting all enemies near the impact. Reload speed and travel time of the projectile is slow though.",entity:Kt,entityType:y.Mortar,htmlElement:"\u{1F6F0}\uFE0F"},jo={name:"Flamethrower",description:"A turret intended for close range combat. It continuously hurts a single enemy within range. Enemies that were lit on fire will also keep burning for a while.",entity:Vt,entityType:y.Flamethrower,htmlElement:"\u{1F9EF}"},zo={name:"Railgun",description:"A powerful tower with a large range that can pierce enemies. It shoots relatively fast and deals massive damage to an enemy and all enemies behind it at the cost of consuming power.",entity:Gt,entityType:y.Railgun,htmlElement:"\u{1F321}\uFE0F"},Gs={name:"Demolish",description:"Sell towers or blueprints. Blueprints and towers placed before the start of a wave are fully refunded. Other towers give back half their original cost when sold.",entityType:y.None,htmlElement:"\u274C"},Vo={name:"Radar",description:"A part of your base that exposes a large area in the direction that it was placed in. Exposed enemy bases are immediately neutralized when exposed by a radar.",entity:Ro,entityType:y.Radar,htmlElement:"\u{1F4E1}",isBasePart:!0},Ko={name:"Power plant",description:"A part of your base that generates an amount power at the start of every wave. Power can be stored across waves and is consumed by various towers. More power plants will generate more power but there are diminishing returns.",entity:Oo,entityType:y.PowerPlant,htmlElement:"\u{1F3ED}",isBasePart:!0},Go={name:"Armory",description:"A part of your base that regenerates hit points at the start of every wave. More armories will regenerate more hit points but there are diminishing returns.",entity:Po,entityType:y.Armory,htmlElement:"\u{1F3F0}",isBasePart:!0},qo={name:"Market",description:"A part of your base that increases the amount of money you get per killed enemy. More markets will increase the multiplier but there are diminishing returns.",entity:Do,entityType:y.Market,htmlElement:"\u{1F3EA}",isBasePart:!0},Zo={name:"Speed Beacon",description:"A building that increases the reload speed of cardinally adjacent towers at the cost of some power for every shot fired. If there is no power (left) the towers will continue working as normal without a speed boost. Keep in mind that the beacon also blocks tower sight lines.",entity:ns,entityType:y.SpeedBeacon,htmlElement:"\u23F0"},Jo={name:"Damage Beacon",description:"A building that increases the damage of cardinally adjacent towers at the cost of some power for every shot fired. If there is no power (left) the towers will continue working as normal without a damage boost. Keep in mind that the beacon also blocks tower sight lines.",entity:is,entityType:y.DamageBeacon,htmlElement:"\u{1F6A8}"},Qo={name:"Laser",description:"A reasonably powerful tower that lights enemies on fire, similar to the flamethrower. It has a larger range but consumes power in order to fire.",entity:Zt,entityType:y.Laser,htmlElement:"\u{1F52D}"};var gi=(t=>(t.Walls="Walls",t.BasicBuildings="Basic buildings",t.PoweredBuildings="Powered Buildings",t.BaseBuildings="Base Buildings",t.WildcardBuildings="Wildcard Buildings",t))(gi||{});const el={Walls:[$o,Yo,Xo],["Basic buildings"]:[Ho,jo,Wo],["Powered Buildings"]:[Ko,Qo,zo],["Base Buildings"]:[Vo,Go,qo],["Wildcard Buildings"]:[Uo,Zo,Jo]},du=[Gs,$o,Yo,Xo,Uo,Ho,Wo,jo,zo,Vo,Ko,Go,qo,Zo,Jo,Qo],Mn=new Set(du.map(t=>t.entityType));class Vn{constructor(e,s,n){c(this,"entity");c(this,"category",q.Player);this.tile=e,this.placeable=s,this.scaleOverride=n,this.entity=new et(e.getX(),e.getY(),this)}getType(){return y.Blueprint}getTile(){return this.tile}isVisible(){return!0}getPlaceable(){return this.placeable}getScale(){var e;return((e=this.placeable.entity)==null?void 0:e.scale)||this.scaleOverride||1}isDelete(){return this.placeable.entityType===y.None}isBasePart(){return!!this.placeable.isBasePart}}const Ps=(t,e,s,n)=>{const i=s.getTile(),r=new Set([i]),o=n.getAdjacentTiles(i,2);for(;o.length>0;){const l=o.pop();t.has(l)||r.has(l)||!e.has(l)&&(!l.hasStaticEntity()||!s.getParts().has(l.getStaticEntity().getAgent()))||(r.add(l),n.getAdjacentTiles(l,2).forEach(a=>o.push(a)))}return r.size===s.getParts().size+e.size-t.size},Fs=2e3,ct=new Set([y.Armory,y.Radar,y.Market,y.PowerPlant]);class gu{constructor(e){c(this,"blueprints",new Map);c(this,"pendingBaseAdditions",[]);c(this,"pendingBaseRemovals",[]);this.surface=e}build(e,s){if(s.entityType===y.None){w.Instance.getIsStarted()?this.sellBlueprints(e):this.sellEntities(e);return}w.Instance.getIsStarted()?this.placeBlueprints(e,s):this.placeEntities(e,s)}commit(){this.blueprints.forEach(e=>{const s=e.getTile(),n=this.surface.getEntityTiles(s.getX(),s.getY(),e.getScale());if(this.surface.despawn(e),n.forEach(r=>{if(!r.hasStaticEntity())return;const o=r.getStaticEntity().getAgent();w.Instance.getMoneyController().sell(o),this.surface.despawnStatic(o)}),e.isDelete())return;const i=e.getPlaceable().entity;this.surface.spawnStatic(new i(s))}),this.blueprints.clear(),this.pendingBaseAdditions=[],this.pendingBaseRemovals=[],w.Instance.triggerStatUpdate()}placeBlueprints(e,s){const n=e.filter(i=>this.checkIsFree(i,s.entity.scale,!0));if(s.isBasePart){const{pendingBaseAdditions:i,pendingBaseRemovals:r}=this.getPendingTiles(e);if(!Ps(r,i,w.Instance.getBase(),this.surface))return w.Instance.showMessage("Not all tiles connect to the base",{expires:Fs}),[]}if(!w.Instance.canBuy(s,n.length))return[];n.forEach(i=>{this.surface.getEntityTiles(i.getX(),i.getY(),s.entity.scale).forEach(l=>{const a=this.blueprints.get(l.getHash());!a||(w.Instance.getMoneyController().sell(a),this.freeBlueprint(a),a.isBasePart()?this.pendingBaseAdditions.splice(this.pendingBaseAdditions.indexOf(a),1):l.hasStaticEntity()&&ct.has(l.getStaticEntity().getAgent().getType())&&this.pendingBaseRemovals.splice(this.pendingBaseRemovals.indexOf(a),1),a.isDelete()&&l.hasStaticEntity()&&ct.has(l.getStaticEntity().getAgent().getType())&&this.pendingBaseRemovals.splice(this.pendingBaseRemovals.indexOf(a),1))});const o=new Vn(i,s);w.Instance.getMoneyController().buy(o),this.reserveBlueprint(o),s.isBasePart&&(!i.hasStaticEntity()||!ct.has(i.getStaticEntity().getAgent().getType()))&&this.pendingBaseAdditions.push(o)}),w.Instance.triggerStatUpdate()}sellBlueprints(e){const s=e.find(o=>this.blueprints.has(o.getHash()));let n=e.filter(o=>s?!!this.blueprints.has(o.getHash()):!!(o.hasStaticEntity()&&Mn.has(o.getStaticEntity().getAgent().getType())));const{baseTiles:i,otherTiles:r}=this.splitTiles(n);if(i.length){const{pendingBaseAdditions:o,pendingBaseRemovals:l}=this.getPendingTiles(i,!0);Ps(l,o,w.Instance.getBase(),this.surface)||(n=r,w.Instance.showMessage("Not all base parts can be sold",{expires:Fs}))}n.forEach(o=>{if(s){const l=this.blueprints.get(o.getHash());l&&(l.isDelete()||(w.Instance.getMoneyController().sell(l),o.hasStaticEntity()&&ct.has(o.getStaticEntity().getAgent().getType())&&this.pendingBaseRemovals.splice(this.pendingBaseRemovals.indexOf(l),1)),l.isBasePart()&&(!o.hasStaticEntity()||!ct.has(o.getStaticEntity().getAgent().getType()))&&this.pendingBaseAdditions.splice(this.pendingBaseAdditions.indexOf(l),1),this.freeBlueprint(l),o.hasStaticEntity()&&ct.has(o.getStaticEntity().getAgent().getType())&&this.pendingBaseRemovals.splice(this.pendingBaseRemovals.indexOf(l),1));return}if(o.hasStaticEntity()&&!this.blueprints.get(o.getHash())){const l=o.getStaticEntity().getAgent(),a=new Vn(l.getTile(),Gs,ps(l));this.reserveBlueprint(a),ct.has(l.getType())&&this.pendingBaseRemovals.push(a)}}),w.Instance.triggerStatUpdate()}placeEntities(e,s){const n=e.filter(i=>this.checkIsFree(i,s.entity.scale));if(s.isBasePart&&!Ps(new Set,new Set(n),w.Instance.getBase(),this.surface))return w.Instance.showMessage("Not all tiles connect to the base",{expires:Fs}),[];if(!w.Instance.canBuy(s,n.length))return[];n.forEach(i=>{const r=new s.entity(i);this.surface.spawnStatic(r),w.Instance.getMoneyController().buy(r)}),w.Instance.triggerStatUpdate()}sellEntities(e){let s=e.filter(r=>!!(r.hasStaticEntity()&&Mn.has(r.getStaticEntity().getAgent().getType())));const{baseTiles:n,otherTiles:i}=this.splitTiles(s);if(n.length){const{pendingBaseAdditions:r,pendingBaseRemovals:o}=this.getPendingTiles(n,!0);Ps(o,r,w.Instance.getBase(),this.surface)||(s=i,w.Instance.showMessage("Not all base parts can be sold",{expires:Fs}))}s.forEach(r=>{if(r.hasStaticEntity()){const o=r.getStaticEntity().getAgent();this.surface.despawnStatic(o),w.Instance.getMoneyController().sell(o)}}),w.Instance.triggerStatUpdate()}splitTiles(e){const s=new Set,n=[];return e.forEach(i=>{const r=this.blueprints.get(i.getHash());if(r&&r.isBasePart()){s.add(r.getTile());return}i.hasStaticEntity()&&ct.has(i.getStaticEntity().getAgent().getType())?s.add(i.getStaticEntity().getAgent().getTile()):n.push(i)}),{baseTiles:[...s],otherTiles:n}}getPendingTiles(e,s=!1){const n=new Set(this.pendingBaseAdditions.map(o=>this.surface.getTile(o.entity.getAlignedX(),o.entity.getAlignedY()))),i=new Set(this.pendingBaseRemovals.map(o=>this.surface.getTile(o.entity.getAlignedX(),o.entity.getAlignedY())));let r=o=>{n.delete(o)||i.delete(o)||i.add(o)};return e.forEach(o=>{if(s){r(o);return}const l=this.blueprints.get(o.getHash());if(l){if(l.isDelete()){i.delete(o);return}n.add(o);return}n.add(o)}),{pendingBaseAdditions:n,pendingBaseRemovals:i}}checkIsFree(e,s,n=!1){return!this.surface.getEntityTiles(e.getX(),e.getY(),s).find(r=>{if(!Ks.has(r.getBaseType())||r.hasStaticEntity()&&(!n||!Mn.has(r.getStaticEntity().getAgent().getType())))return!0})}reserveBlueprint(e){this.surface.spawn(e);const s=e.getTile();this.surface.getEntityTiles(s.getX(),s.getY(),e.getScale()).forEach(n=>this.blueprints.set(n.getHash(),e))}freeBlueprint(e){this.surface.despawn(e);const s=e.getTile();this.surface.getEntityTiles(s.getX(),s.getY(),e.getScale()).forEach(n=>this.blueprints.delete(n.getHash()))}}const pu=.003;class mu{constructor(e,s,n){c(this,"entity");c(this,"category",q.Unknown);c(this,"time",0);c(this,"travelTime");this.tile=e,this.target=s,this.damage=n,this.entity=new et(e.getX(),e.getY(),this);const i=e.getX()-s.getX(),r=e.getY()-s.getY(),o=Math.sqrt(i*i+r*r);this.travelTime=o/pu}tick(e){this.time>=this.travelTime&&(w.Instance.getSurface().despawn(this),[...w.Instance.getSurface().getEntitiesForCategory(q.Enemy)].filter(n=>n.getAlignedX()===this.target.getX()&&n.getAlignedY()===this.target.getY()).forEach(n=>{n.getAgent().AI.hit(this.damage)})),this.time=Math.min(this.time+e,this.travelTime);const s=this.time/this.travelTime;this.entity.setX((this.target.getX()-this.tile.getX())*s+this.tile.getX()),this.entity.setY((this.target.getY()-this.tile.getY())*s+this.tile.getY())}getType(){return y.Shockwave}getTile(){return this.tile}isVisible(){return!0}}const yu=1e3,wu=200,_u=[[0,0],[1,0],[1,1],[0,1]],vu=[[[-1,0],[-1,-1],[0,-1]],[[0,-1],[1,-1],[1,0]],[[1,0],[1,1],[0,1]],[[0,1],[-1,1],[-1,0]]];class rs{constructor(e){c(this,"entity");c(this,"category",q.Player);c(this,"hp",30);c(this,"invincibleTime",0);c(this,"baseParts",new Set);c(this,"basePartsByType",new Map);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this),this.baseParts.add(this)}tick(e){this.invincibleTime=Math.max(0,this.invincibleTime-e)}getType(){return y.Base}getTile(){return this.tile}updateTile(e){this.tile=e}getHp(){return this.hp}spawn(){w.Instance.getVisibilityController().registerAgent(this),_s(this,4)}despawn(){w.Instance.getVisibilityController().removeAgent(this)}hit(e){this.invincibleTime>0||this.hp<=0||(this.hp-=e,this.hp<=0?w.Instance.showMessage("You lose!",{closable:!1}):(this.invincibleTime=yu,this.shockwave()),w.Instance.triggerStatUpdate())}regenerate(){this.hp+=this.getRegenerationFactor()}isVisible(){return!0}isDestroyed(){return this.hp<=0}addPart(e){var s;this.baseParts.add(e),this.basePartsByType.set(e.getType(),((s=this.basePartsByType.get(e.getType()))!=null?s:0)+1)}removePart(e){this.baseParts.delete(e),this.basePartsByType.set(e.getType(),this.basePartsByType.get(e.getType())-1)}getParts(){return this.baseParts}getPartsCount(e){var s;return(s=this.basePartsByType.get(e))!=null?s:0}getRegenerationFactor(){const e=this.getPartsCount(y.Armory);return e*50/(e+25)}getMoneyFactor(){const e=this.getPartsCount(y.Market);return 1+e*2.5/(e+25)}shockwave(){const e=w.Instance.getSurface(),s=new Map;this.baseParts.forEach(n=>{_u.forEach(([i,r],o)=>{const l=e.getTile(n.getTile().getX()+i,n.getTile().getY()+r);vu[o].forEach(([a,h])=>{const g=e.getTile(n.getTile().getX()+i+a,n.getTile().getY()+r+h);g&&!s.has(g.getHash())&&jc.has(g.getType())&&s.set(g.getHash(),[l,g])})})}),s.forEach(([n,i])=>{const r=new mu(n,i,wu);e.spawn(r)})}}c(rs,"scale",2);const os={[y.Fence]:1,[y.Wall]:3,[y.ElectricFence]:9,[y.Freezer]:4,[y.Tower]:10,[y.Flamethrower]:15,[y.Mortar]:30,[y.Railgun]:50,[y.Radar]:50,[y.PowerPlant]:20,[y.Armory]:50,[y.Market]:20,[y.SpeedBeacon]:50,[y.DamageBeacon]:40,[y.Laser]:30},bu=.5;class Eu{constructor(e=0,s=()=>1){c(this,"recentlyBought",new Set);this.money=e,this.multiplier=s}setMoney(e){this.money=e}addMoney(e){this.money+=e}removeMoney(e){if(e>this.money)throw new Error("Not enough money!");this.money-=e}registerEnemyKill(e){const s=this.getEnemyValue(e)*this.multiplier();this.money+=s}buy(e){var n;const s=(n=os[e.getType()])!=null?n:0;if(s>this.money)throw new Error("Not enough money!");this.removeMoney(s),this.recentlyBought.add(e)}sell(e){var s,n;if(e instanceof Vn)this.addMoney((s=os[e.getPlaceable().entityType])!=null?s:0);else{const i=(n=os[e.getType()])!=null?n:0;this.addMoney(i*(this.recentlyBought.has(e)?1:bu))}}getMoney(){return this.money}getMultiplier(){return this.multiplier()}clearRecents(){this.recentlyBought.clear()}isRecent(e){return this.recentlyBought.has(e)}getEnemyValue(e){switch(e.getType()){case y.Slime:return 5;case y.Runner:return 3;default:throw new Error("Entity is not an enemy")}}}const Kn={[y.ElectricFence]:.05,[y.Railgun]:5,[y.Laser]:.004},Su=2,vr=1.25;class Tu{constructor(){c(this,"generators",new Set);c(this,"consumption",0);c(this,"blackout",!1);c(this,"power",0)}registerGenerator(e){this.generators.add(e)}removeGenerator(e){this.generators.delete(e)}getProduction(){return w.Instance.getBase().getPartsCount(y.PowerPlant)*5}getConsumption(){return this.consumption}consume(e){return e===0?!0:this.blackout?!1:(this.power-=e,this.power<0?(this.power=0,this.blackout=!0,w.Instance.triggerEvent(ue.BlackOut),w.Instance.triggerStatUpdate(),!1):(this.consumption+=e,!0))}processPower(){this.power=this.power+this.getProduction(),this.consumption=0,this.blackout=!1,this.power<0&&w.Instance.triggerEvent(ue.BlackOut)}getPower(){return this.power}}class Mu{constructor(){c(this,"unlockedTowers");c(this,"availableUnlocks");c(this,"unlockLinkedMap");c(this,"points",0);this.unlockedTowers=new Set,this.availableUnlocks=new Set,this.unlockLinkedMap=new Map,Object.values(gi).forEach(e=>{const s=el[e];s.forEach((n,i)=>{if(i===0){this.unlockedTowers.add(n.entityType);return}i===1&&this.availableUnlocks.add(n.entityType),s.length>i+1&&this.unlockLinkedMap.set(n.entityType,s[i+1].entityType)})})}addPoint(){this.points++}getPoints(){return this.points}canUnlock(e){return this.availableUnlocks.has(e)&&this.points>0}isUnlocked(e){return this.unlockedTowers.has(e)}unlock(e){if(!this.canUnlock(e))throw new Error(`Can't unlock ${e}`);this.points--,this.unlockedTowers.add(e),this.availableUnlocks.delete(e);const s=this.unlockLinkedMap.get(e);s&&this.availableUnlocks.add(s)}}class Iu{constructor(e){c(this,"agents",new Set);c(this,"edgeMap",new Map);c(this,"base");c(this,"minX");c(this,"minY");c(this,"maxX");c(this,"maxY");this.surface=e}registerAgent(e){this.agents.add(e);let s=Oe.Pending;e instanceof rs&&(this.base=e,s=Oe.Discovered);const n=this.getVisibilityRange(e),i=this.getVisibilityEdge(e);this.edgeMap.set(e.entity.getId(),i),this.updateVisibility(...i,n,s)}removeAgent(e){if(!this.agents.has(e))return;e instanceof rs&&(this.base=void 0);const s=this.getVisibilityRange(e),n=this.edgeMap.get(e.entity.getId());this.surface.forCircle(...n,s,i=>i.setDiscoveryStatus(Oe.Undiscovered)),this.agents.delete(e),this.edgeMap.delete(e.entity.getId()),this.update()}update(){this.minX=void 0,this.minY=void 0,this.maxX=void 0,this.maxY=void 0,this.agents.forEach(e=>{const s=this.getVisibilityRange(e),n=this.edgeMap.get(e.entity.getId());this.surface.forCircle(...n,s,i=>i.setDiscoveryStatus(Oe.Undiscovered))}),this.agents.forEach(e=>{const s=w.Instance.getMoneyController().isRecent(e)?Oe.Pending:Oe.Discovered,n=this.getVisibilityRange(e),i=this.getVisibilityEdge(e);this.edgeMap.set(e.entity.getId(),i),this.updateVisibility(...i,n,s)})}getBBox(){return[[this.minX,this.minY],[this.maxX,this.maxY]]}getVisibilityRange(e){switch(e.getType()){case y.Base:case y.Radar:return 35;default:throw new Error("Entity has no visibility defined")}}getVisibilityEdge(e){if(e instanceof rs||!this.base)return[e.entity.getAlignedX(),e.entity.getAlignedY()];let s;const n=Math.atan2(e.entity.getAlignedY()-this.base.entity.getAlignedY(),e.entity.getAlignedX()-this.base.entity.getAlignedX());return this.surface.forRay(this.base.entity.getAlignedX(),this.base.entity.getAlignedY(),n,i=>i.getDiscoveryStatus()===Oe.Undiscovered?!1:(s=i,!0)),s?[s.getX(),s.getY()]:[e.entity.getAlignedX(),e.entity.getAlignedY()]}updateVisibility(e,s,n,i){(!this.minX||e-n/2<this.minX)&&(this.minX=e-n/2),(!this.minY||s-n/2<this.minY)&&(this.minY=s-n/2),(!this.maxX||e+n/2>this.maxX)&&(this.maxX=e+n/2),(!this.maxY||s+n/2>this.maxY)&&(this.maxY=s+n/2),this.surface.forCircle(e,s,n,r=>{i===Oe.Pending&&r.isDiscovered()||r.setDiscoveryStatus(i)})}}var He=(t=>(t[t.Normal=0]="Normal",t[t.OnFire=1]="OnFire",t))(He||{});class Cu{constructor(e){this.index=e}isCleared(e){return!e[this.index].hasStaticEntity()}process(e,s,n){s.AI.attack(e[this.index].getStaticEntity().getAgent())}}const tl=(t=xo)=>e=>{const s=[];return e.forEach((n,i)=>{n.hasStaticEntity()&&t.has(n.getStaticEntity().getAgent().getType())&&s.push(new Cu(i))}),s},pi={[A.Grass]:3,[A.Water]:20,[A.Stone]:4,[A.Wall]:3,[A.Spore]:2,[A.ElectricFence]:5,[A.Fence]:20,[A.Freezer]:6,[A.Obstructed]:3,[A.Bridge]:5,[A.Dirt]:2.5,[A.Sand]:3.5,[A.Snow]:3.5,[A.Ice]:10,[A.PlayerBuilding]:3,[A.Tree]:5,[A.Rock]:5,[A.Base]:Number.EPSILON},mi={[A.Fence]:5,[A.ElectricFence]:40,[A.Wall]:66.666,[A.Freezer]:.5,[A.Obstructed]:500,[A.PlayerBuilding]:-10};A.Grass+"",A.Water+"",A.Stone+"",A.Wall+"",A.Spore+"",A.ElectricFence+"",A.Fence+"",A.Freezer+"",A.Obstructed+"",A.Bridge+"",A.Dirt+"",A.Sand+"",A.Snow+"",A.Ice+"",A.PlayerBuilding+"",A.Tree+"",A.Rock+"",A.Base+"",Number.EPSILON;A.Fence+"",A.ElectricFence+"",A.Wall+"",A.Tree+"",A.Rock+"",A.Freezer+"",A.Obstructed+"",A.PlayerBuilding+"";const qs=600;class sl{constructor(e,s){c(this,"predictedHp");c(this,"cooldown",0);c(this,"callback");this.enemy=e,this.hp=s,this.predictedHp=s}tick(e){if(this.cooldown<e&&this.callback&&(this.callback(),this.callback=void 0),this.cooldown=Math.max(0,this.cooldown-e),this.enemy.getPath().isPaused(this.enemy)&&!this.isBusy()){const s=this.enemy.getPath().getTile();this.enemy.entity.setX(s.getX()),this.enemy.entity.setY(s.getY());const n=this.enemy.getPath().getNextCheckpoint();n&&n.process(this.enemy.getPath().getTiles(),this.enemy,e)}if(this.isBusy())this.getTargeted(this.enemy.getPath().getCurrentTile(),e);else{const{from:s,to:n,step:i}=this.enemy.getPath().performStep(this.enemy,this.enemy.isVisible()?e:e*10);this.enemy.entity.move(s,n,i),this.getTargeted(s,e)}}attack(e){e.hit&&this.cooldown===0&&(e.hit(this.enemy.getDamage()),this.cooldown=qs)}interact(e,s=qs){this.callback=e,this.cooldown===0&&(this.cooldown=s)}getTargeted(e,s){if(this.predictedHp>0&&this.enemy.isVisible()){for(let n of e.getAvailableTowers())if(this.predictedHp-=n.fire(this.enemy,s),this.predictedHp<=0)break}}hit(e){this.hp-=e,this.hp<this.predictedHp&&(this.predictedHp=this.hp),this.hp<=0&&w.Instance.despawnEnemy(this.enemy)}miss(e){this.predictedHp+=e}isBusy(){return this.cooldown!==0}getFuturePosition(e){return this.cooldown>e?this.enemy.getPath().getIndex():this.enemy.getPath().getFuturePosition(e-this.cooldown)}}const nl=new Set(xo);nl.delete(y.Tree);const xu=tl(nl),Au=3e3,Pu=.01,Fu=.025,ku=30,Mi=class{constructor(e,s){c(this,"entity");c(this,"category",q.Enemy);c(this,"status",He.Normal);c(this,"statusDuration",0);c(this,"ai");this.path=s,this.entity=new et(e.getX(),e.getY(),this),this.ai=new sl(this,ku)}initializePath(){this.path.setSpeed(Fu),this.path.setCheckpoints(xu(this.path.getTiles()))}get AI(){return this.ai}getDamage(){return 6}getType(){return Mi.type}getPath(){return this.path}getStatus(){return this.status}tick(e){this.status===He.OnFire&&(this.statusDuration-=e,this.statusDuration<=0?this.status=He.Normal:this.ai.hit(Pu*e)),this.ai.tick(e)}isVisible(){return this.path.getTile().isDiscovered()}lightOnFire(){this.status=He.OnFire,this.statusDuration=Au}};let Ze=Mi;c(Ze,"pathCosts",pi),c(Ze,"pathMultipliers",mi),c(Ze,"type",y.Runner),c(Ze,"cost",5);class Bu{constructor(e,s,n){c(this,"paths");this.pathfinder=e,this.startPoints=s,this.target=n}getPaths(){if(!this.paths){const e=this.startPoints.map(n=>this.pathfinder.getSurface().getTile(n.getX(),n.getY())),s=this.pathfinder.getSurface().getTile(this.target.getX(),this.target.getY());this.paths=this.pathfinder.getHivePath(e,s).filter(n=>!!n)}return this.paths}update(){this.paths=void 0}}var il=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Du(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var rl={exports:{}},ol={exports:{}};(function(t,e){(function(){var s,n,i,r,o,l,a,h,g,p,m,F,k,B,I;i=Math.floor,p=Math.min,n=function(d,S){return d<S?-1:d>S?1:0},g=function(d,S,b,M,N){var $;if(b==null&&(b=0),N==null&&(N=n),b<0)throw new Error("lo must be non-negative");for(M==null&&(M=d.length);b<M;)$=i((b+M)/2),N(S,d[$])<0?M=$:b=$+1;return[].splice.apply(d,[b,b-b].concat(S)),S},l=function(d,S,b){return b==null&&(b=n),d.push(S),B(d,0,d.length-1,b)},o=function(d,S){var b,M;return S==null&&(S=n),b=d.pop(),d.length?(M=d[0],d[0]=b,I(d,0,S)):M=b,M},h=function(d,S,b){var M;return b==null&&(b=n),M=d[0],d[0]=S,I(d,0,b),M},a=function(d,S,b){var M;return b==null&&(b=n),d.length&&b(d[0],S)<0&&(M=[d[0],S],S=M[0],d[0]=M[1],I(d,0,b)),S},r=function(d,S){var b,M,N,$,z,L;for(S==null&&(S=n),$=function(){L=[];for(var G=0,H=i(d.length/2);0<=H?G<H:G>H;0<=H?G++:G--)L.push(G);return L}.apply(this).reverse(),z=[],M=0,N=$.length;M<N;M++)b=$[M],z.push(I(d,b,S));return z},k=function(d,S,b){var M;if(b==null&&(b=n),M=d.indexOf(S),M!==-1)return B(d,0,M,b),I(d,M,b)},m=function(d,S,b){var M,N,$,z,L;if(b==null&&(b=n),N=d.slice(0,S),!N.length)return N;for(r(N,b),L=d.slice(S),$=0,z=L.length;$<z;$++)M=L[$],a(N,M,b);return N.sort(b).reverse()},F=function(d,S,b){var M,N,$,z,L,G,H,se,le;if(b==null&&(b=n),S*10<=d.length){if($=d.slice(0,S).sort(b),!$.length)return $;for(N=$[$.length-1],H=d.slice(S),z=0,G=H.length;z<G;z++)M=H[z],b(M,N)<0&&(g($,M,0,null,b),$.pop(),N=$[$.length-1]);return $}for(r(d,b),le=[],L=0,se=p(S,d.length);0<=se?L<se:L>se;0<=se?++L:--L)le.push(o(d,b));return le},B=function(d,S,b,M){var N,$,z;for(M==null&&(M=n),N=d[b];b>S;){if(z=b-1>>1,$=d[z],M(N,$)<0){d[b]=$,b=z;continue}break}return d[b]=N},I=function(d,S,b){var M,N,$,z,L;for(b==null&&(b=n),N=d.length,L=S,$=d[S],M=2*S+1;M<N;)z=M+1,z<N&&!(b(d[M],d[z])<0)&&(M=z),d[S]=d[M],S=M,M=2*S+1;return d[S]=$,B(d,L,S,b)},s=function(){d.push=l,d.pop=o,d.replace=h,d.pushpop=a,d.heapify=r,d.updateItem=k,d.nlargest=m,d.nsmallest=F;function d(S){this.cmp=S!=null?S:n,this.nodes=[]}return d.prototype.push=function(S){return l(this.nodes,S,this.cmp)},d.prototype.pop=function(){return o(this.nodes,this.cmp)},d.prototype.peek=function(){return this.nodes[0]},d.prototype.contains=function(S){return this.nodes.indexOf(S)!==-1},d.prototype.replace=function(S){return h(this.nodes,S,this.cmp)},d.prototype.pushpop=function(S){return a(this.nodes,S,this.cmp)},d.prototype.heapify=function(){return r(this.nodes,this.cmp)},d.prototype.updateItem=function(S){return k(this.nodes,S,this.cmp)},d.prototype.clear=function(){return this.nodes=[]},d.prototype.empty=function(){return this.nodes.length===0},d.prototype.size=function(){return this.nodes.length},d.prototype.clone=function(){var S;return S=new d,S.nodes=this.nodes.slice(0),S},d.prototype.toArray=function(){return this.nodes.slice(0)},d.prototype.insert=d.prototype.push,d.prototype.top=d.prototype.peek,d.prototype.front=d.prototype.peek,d.prototype.has=d.prototype.contains,d.prototype.copy=d.prototype.clone,d}(),function(d,S){return t.exports=S()}(this,function(){return s})}).call(il)})(ol);(function(t){t.exports=ol.exports})(rl);const Ou=Du(rl.exports);class ls{constructor(e,s,n,i,r,o=[]){c(this,"index",0);c(this,"sectionIndex",0);c(this,"tileSet");this.pathfinder=e,this.tiles=s,this.sections=n,this.speed=i,this.costs=r,this.checkpoints=o,this.tileSet=new Set(s)}performStep(e,s){var g,p;const n=this.index%1,i=this.index|0,r=this.tiles[i],o=this.speed*s/((g=this.costs[i])!=null?g:1);let l=this.index+o|0;i===l&&l++,l>=this.tiles.length-1&&(l=this.tiles.length-1);const a=this.tiles[l];for(;this.checkpoints.length>0;){const m=this.checkpoints[0];if(m&&l>=m.index)if(m.isCleared(this.tiles,e))this.checkpoints.shift();else return this.index=m.index-1,{from:this.tiles[this.index],to:a,step:0};else break}const h=(p=this.costs[l])!=null?p:1;for(this.index=Math.min(this.index+this.speed*s/h,this.tiles.length-1);this.index>this.sections[this.sectionIndex].to;)this.sectionIndex++;return{from:r,to:a,step:n}}getFuturePosition(e){let s=this.index,n=this.sectionIndex;for(;e>0;){const i=this.sections[n],r=i.to-s,o=r/this.speed*i.cost;if(e>o?(s+=r,n++,e-=o):(s+=r*e/o,e=0),s>=this.tiles.length-1)return this.tiles.length-1}return s}clone(){return new ls(this.pathfinder,this.tiles,this.sections,this.speed,this.costs,[...this.checkpoints])}setIndex(e){this.index=Math.max(Math.min(e,this.tiles.length-1),0),this.sectionIndex=this.sections.findIndex(({from:s,to:n})=>this.index>=s&&this.index<n)}getIndex(){return this.index}getTile(e=this.index){return this.tiles[e|0]}getTiles(){return this.tiles}getLength(){return this.tiles.length}getCoordinates(e=this.index){if(e>=this.tiles.length-1){const r=this.tiles[this.tiles.length-1];return{x:r.getX(),y:r.getY()}}const s=e%1,n=this.tiles[e|0],i=this.tiles[(e|0)+1];return{x:(i.getX()-n.getX())*s+n.getX(),y:(i.getY()-n.getY())*s+n.getY()}}getSpeed(){return this.speed}setSpeed(e){this.speed=e}isDone(){return this.index===this.tiles.length-1}isPaused(e){if(this.isDone())return!0;const s=this.getNextCheckpoint();return s&&s.index===this.index+1&&!s.isCleared(this.tiles,e)}getNextCheckpoint(){return this.checkpoints[0]||null}getCheckpoints(){return this.checkpoints}setCheckpoints(e){this.checkpoints=e}getCurrentTile(){return this.tiles[this.index|0]}recompute(){var n;const e=this.pathfinder.getSurface();let s;for(let i=0;i<this.tiles.length;i++){const r=this.tiles[i],o=e.getTile(r.getX(),r.getY());this.tiles[i]=o,this.costs[i]=(n=this.pathfinder.getCost(o,s))!=null?n:1,s=o,r!==o&&(this.tileSet.delete(r),this.tileSet.add(o))}this.sections=ls.calculateSections(this.tiles,this.costs)}isAffectedByTiles(e){for(let s of e)if(this.tileSet.has(s))return!0;return!1}static calculateSections(e,s){return e.reduce((n,i,r)=>{const o=n[n.length-1],l=s[r];return o?(o.cost===l?o.to++:n.push({from:r,to:r+1,cost:l}),n):[{from:r,to:r+1,cost:l}]},[])}static fromTiles(e,s,n=1){const i=new ls(e,s,[],n,[]);return i.recompute(),i}static fromMapAndCosts(e,s,n,i,r=1){let o=n;const l=[o];for(;o!==s;)o=i.get(o.getHash()),l.push(o);return this.fromTiles(e,l.reverse(),r)}}const Ru=[[0,-1],[-1,0],[1,0],[0,1],[-1,-1],[1,-1],[-1,1],[1,1]],Lu=150,Nu=t=>{var e;return(e=mi[t.getType()])!=null?e:1};class $u{constructor(e,s=Nu,n=pi){c(this,"costFn");this.surface=e,this.costMultiplier=s,this.costFn=typeof n=="function"?n:i=>{var r;return(r=n[i.getType()])!=null?r:null}}getPath(e,s,n){var F;const i=n!=null?n:this.costMultiplier,r=new Set,l=((F=this.costFn(e))!=null?F:1)*i(e),a=new Map;a.set(e.getHash(),l);const h=new Map;h.set(e.getHash(),l);const g=new Map;g.set(e.getHash(),l+this.heuristic(e,s));const p=new Ou((k,B)=>{var I,d;return((I=g.get(k.getHash()))!=null?I:1/0)-((d=g.get(B.getHash()))!=null?d:1/0)});p.push(e);const m=new Map;for(;!p.empty();){let k=p.pop();if(s===k)return ls.fromMapAndCosts(this,e,s,m);const B=k.getHash(),I=Ru.map(([S,b])=>this.surface.getTile(S+k.getX(),b+k.getY())),d=[];this.setCostAndMultiplier(0,d,i,I[0]),this.setCostAndMultiplier(1,d,i,I[1]),this.setCostAndMultiplier(2,d,i,I[2]),this.setCostAndMultiplier(3,d,i,I[3]),this.setDiagonalCostAndMultiplier(4,0,1,d,i,I[4]),this.setDiagonalCostAndMultiplier(5,0,2,d,i,I[5]),this.setDiagonalCostAndMultiplier(6,1,3,d,i,I[6]),this.setDiagonalCostAndMultiplier(7,2,3,d,i,I[7]),I.forEach((S,b)=>{var z;if(!S)return;const M=d[b*2];if(!M||r.has(S))return;const N=S.getHash(),$=h.get(B)+d[b*2+1];if($<((z=h.get(N))!=null?z:1/0)){const L=a.get(B)+M;a.set(N,L),m.set(N,k),h.set(N,$),g.set(N,$+this.heuristic(S,s)),p.push(S),r.add(k)}})}}getHivePath(e,s){const n={},i=r=>{var o;return((o=n[r.getHash()])!=null?o:1)*this.costMultiplier(r)};return e.reduce((r,o,l)=>{const a=this.getPath(o,s,i);return r.push(a),a&&e.length>l-1&&a.getTiles().forEach(h=>{h.hasStaticEntity()&&(n[h.getHash()]=.85),n[h.getHash()]=n[h.getHash()]+.1||1.1}),r},[])}getCost(e,s){if(!s)return this.costFn(e);const n=this.costFn(e),i=this.costFn(s);if(!n||!i)return null;const r=(n+i)/2;return!n||!i||e.getX()===s.getX()||e.getY()==s.getY()?r:r+(this.costFn(this.surface.getTile(e.getX(),s.getY()))+this.costFn(this.surface.getTile(s.getX(),e.getY())))/4}getSurface(){return this.surface}heuristic(e,s){return Math.abs(e.getX()-s.getX())+Math.abs(e.getY()-s.getY())}setCostAndMultiplier(e,s,n,i){if(!i)return;const r=this.costFn(i);r&&(s[e*2]=r,s[e*2+1]=r*n(i))}setDiagonalCostAndMultiplier(e,s,n,i,r,o){if(!o||!i[s*2]||!i[n*2])return;const l=i[s*2+1]+i[n*2+1];if(l>Lu)return;const a=this.costFn(o);a&&(i[e*2]=a+(i[s*2]+i[n*2])/4,i[e*2+1]=a*r(o)+l/4)}}class yi{constructor(e,s,n){c(this,"index",0);c(this,"pathData",new Map);c(this,"strength",1);c(this,"unit",Ze);c(this,"energy",25);c(this,"spawnInterval",200);c(this,"spawnDelay",0);c(this,"burstSize",Number.POSITIVE_INFINITY);c(this,"burstInterval",1e3);c(this,"burst",0);c(this,"timer",0);this.spawnPoints=e,this.target=s,this.surface=n}setParameters(e,s,n,i,r,o){this.unit=e,this.energy=s,this.spawnInterval=n,this.spawnDelay=i,this.burstSize=r,this.burstInterval=o,this.burst=0,this.timer=0}getEnergy(){return this.energy}tick(e){if(this.energy!==0){if(this.timer+=e,this.spawnDelay>0)if(this.timer>this.spawnDelay)this.timer-=this.spawnDelay,this.spawnDelay=0;else return;if(this.burst>=this.burstSize)if(this.timer>=this.burstInterval)this.timer-=this.burstInterval,this.burst=0;else return;if(this.timer>=this.spawnInterval){this.timer-=this.spawnInterval,this.energy=Math.max(0,this.energy-this.unit.cost);const s=this.getNextUnit();w.Instance.spawnEnemy(s)}}}getPathData(e){return this.pathData.has(e)||this.pathData.set(e,new Bu(new $u(this.surface),this.spawnPoints,this.target)),this.pathData.get(e)}getSpawnPoints(){return this.getPathData(this.unit.type).getPaths()}getNextSpawnPoint(){const e=this.getSpawnPoints(),s=e[this.index];return this.index=(this.index+1)%e.length,s}getNextUnit(){const e=this.getNextSpawnPoint().clone(),s=new this.unit(e.getTile(),e);return s.initializePath(),s}grow(){this.strength++}getStrength(){return this.strength}isExposed(){const e=this.getSpawnPoints();return e.reduce((n,i)=>i.getTile(0).getDiscoveryStatus()!==Oe.Undiscovered?n+1:n,0)/e.length}rePath(){this.pathData.forEach(e=>e.update())}static fromTiles(e,s,n){return new yi(e,s,n)}}const Yu=(t,...e)=>{const s=[];return e.filter(Boolean).forEach(n=>s.push(...n(t))),s.sort((n,i)=>n.index-i.index),s},br=(t,e)=>{if(t>Math.random())return e},Gn=new Set([A.Grass,A.Snow]);class Xu{constructor(e){this.index=e}isCleared(e,s){return!Gn.has(e[this.index-1].getType())}process(e,s,n){const i=w.Instance.getSurface(),r=e[this.index-1];Gn.has(r.getType())&&i.setTile(new Ye(r.getX(),r.getY(),A.Dirt))}}const Uu=t=>{const e=[],s=Math.random()*t.length/10,n=t.filter(i=>Gn.has(i.getType()));for(let i=0;i<s&&n.length;i++){const r=n.splice(Math.floor(Math.random()*n.length),1)[0];e.push(new Xu(t.indexOf(r)+1))}return e};class Er{constructor(e){this.index=e}isCleared(e,s){return!this.getTiles(e[this.index],s).length}process(e,s,n){const i=w.Instance.getSurface(),r=e[this.index],o=this.getTiles(r,s);if(o.length>0){const l=o[0];s.entity.lookAt(l),s.AI.interact(()=>{i.getTile(l.getX(),l.getY()).getType()===A.Water&&i.setTile(new Ye(l.getX(),l.getY(),A.Bridge))})}}getTiles(e,s){const n=w.Instance.getSurface(),i=[];return e.getType()===A.Water&&i.push(e),s.entity.getAlignedX()!==e.getX()&&s.entity.getAlignedY()!==e.getY()&&[[s.entity.getAlignedX(),e.getY()],[e.getX(),s.entity.getAlignedY()]].forEach(([r,o])=>{const l=n.getTile(r,o);(l==null?void 0:l.getType())===A.Water&&i.push(l)}),i}}const Hu=t=>{const e=[];for(let s=0;s<t.length;s++)t[s].getType()===A.Water&&(e.push(new Er(s)),s+1<t.length&&t[s+1].getType()!==A.Water&&e.push(new Er(s+1)));return e},Wu=tl(),ju=3e3,zu=.01,Vu=.01,Ku=100,Ii=class{constructor(e,s){c(this,"entity");c(this,"category",q.Enemy);c(this,"status",He.Normal);c(this,"statusDuration",0);c(this,"ai");this.path=s,this.entity=new et(e.getX(),e.getY(),this),this.ai=new sl(this,Ku)}initializePath(){this.path.setSpeed(Vu),this.path.setCheckpoints(Yu(this.path.getTiles(),Wu,br(.5,Uu),br(.1,Hu)))}get AI(){return this.ai}getDamage(){return 10}getType(){return Ii.type}getPath(){return this.path}getStatus(){return this.status}tick(e){this.status===He.OnFire&&(this.statusDuration-=e,this.statusDuration<=0?this.status=He.Normal:this.ai.hit(zu*e)),this.ai.tick(e)}isVisible(){return this.path.getTile().isDiscovered()}lightOnFire(){this.status=He.OnFire,this.statusDuration=ju}};let vt=Ii;c(vt,"pathCosts",pi),c(vt,"pathMultipliers",mi),c(vt,"type",y.Slime),c(vt,"cost",7);const Gu=(t,e)=>{const s=new Array(e).fill(0).map(Math.random),n=s.reduce((i,r)=>i+r);return s.map(i=>i/n*t)},Jt=()=>{let t=1-Math.random(),e=Math.random(),s=Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*e);return s=s/10+.5,s>1||s<0?Jt():s},qu=4e3,Zu=200,Ju=500,Qu=500,eh=3e3,th=3,sh=12,nh=1.1,ih=2*Ze.cost;class wi{constructor(e){this.spawnGroups=e}isDone(){return!this.spawnGroups.find(e=>e.getEnergy()>0)}getSpawnGroups(){return this.spawnGroups}tick(e){this.spawnGroups.forEach(s=>s.tick(e))}static fromSpawnGroups(e,s){const n=2**e*Ze.cost,i=Gu(n,s.length);return s.forEach((r,o)=>{const l=i[o]*nh+ih*r.getStrength(),a=o===0||Math.random()>.5?0:Jt()*qu,h=Math.random()>.5?Jt()*sh+th:Number.POSITIVE_INFINITY;r.setParameters(Math.random()>.5?Ze:vt,l,Jt()*Ju+Zu,a,h,Jt()*eh+Qu)}),new wi(s)}}var Je=(t=>(t.Easy="easy",t.Normal="normal",t.Hard="hard",t))(Je||{});const Ci=class{constructor(e,s,n,i,r){c(this,"eventHandlers");c(this,"visibilityController");c(this,"powerController");c(this,"moneyController");c(this,"buildController");c(this,"unlocksController");c(this,"base");c(this,"spawnGroups",[]);c(this,"nextSpawnGroup");c(this,"level",0);c(this,"wave");c(this,"timeSinceLastExpansion",0);c(this,"showMessage",(...e)=>this.messageFn(...e));c(this,"onSurfaceChange",({affectedTiles:e,removedStaticAgents:s})=>{const n=this.getIsStarted();this.spawnGroups.forEach(r=>{n?r.getSpawnPoints().forEach(o=>{o.isAffectedByTiles(e)&&o.recompute()}):(s.size>0||!!r.getSpawnPoints().find(l=>l.isAffectedByTiles(e)))&&r.rePath()});const i=this.getNextSpawnGroup();!n&&i&&(s.size>0||!!i.getSpawnPoints().find(o=>o.isAffectedByTiles(e)))&&i.rePath()});this.difficulty=e,this.surface=n,this.controller=i,this.messageFn=r,Ci.instance=this,this.eventHandlers=new Map,this.visibilityController=new Iu(n),this.powerController=new Tu,this.moneyController=new Eu(1e3,()=>this.base.getMoneyFactor()),this.buildController=new gu(n),this.unlocksController=new Mu,s.hasStaticEntity()&&s.clearStaticEntity(),this.base=new rs(s),n.spawnStatic(this.base),this.addEventListener(ue.SurfaceChange,this.onSurfaceChange),console.log(this)}tick(e){if(this.surface.processChangedTiles(),this.base.isDestroyed())return;const s=this.surface.getEntities();for(let i of s)i.getAgent().tick&&i.getAgent().tick(e);const n=this.surface.getStaticEntities();for(let i of n)i.getAgent().tick&&i.getAgent().tick(e);!this.wave||this.wave.tick(e)}triggerStatUpdate(){const e=this.getSurface().getEntitiesForCategory(q.Enemy).size;this.triggerEvent(ue.StatUpdate,{integrity:this.base.getHp(),regeneration:this.base.getRegenerationFactor(),level:this.level,money:this.moneyController.getMoney(),moneyMultiplier:this.moneyController.getMultiplier(),production:this.powerController.getProduction(),consumption:this.powerController.getConsumption(),power:this.powerController.getPower(),remainingEnemies:e,inProgress:e!==0})}spawnEnemy(e){this.surface.spawn(e),this.triggerStatUpdate()}despawnEnemy(e){var s;this.surface.despawn(e)&&(this.moneyController.registerEnemyKill(e),this.getSurface().getEntitiesForCategory(q.Enemy).size===0&&((s=this.wave)==null?void 0:s.isDone())&&this.end(),this.triggerStatUpdate())}getSurface(){return this.surface}getController(){return this.controller}getVisibilityController(){return this.visibilityController}getPowerController(){return this.powerController}getBuildController(){return this.buildController}getMoneyController(){return this.moneyController}getUnlocksController(){return this.unlocksController}getBase(){return this.base}getWave(){return this.wave}getMoney(){return this.moneyController.getMoney()}getIsStarted(){return this.wave?this.wave.isDone()?this.getSurface().getEntitiesForCategory(q.Enemy).size>0:!0:!1}canBuy(e,s=1){var i;const n=((i=os[e.entityType])!=null?i:0)*s;return n>this.moneyController.getMoney()?(this.showMessage(`You do not have enough money. This costs \u{1FA99} ${n}`),!1):!0}start(){if(this.getIsStarted())throw new Error("Wave already in progress!");this.triggerEvent(ue.StartWave),this.powerController.processPower(),this.moneyController.clearRecents(),this.visibilityController.update(),this.timeSinceLastExpansion++;for(let s=this.spawnGroups.length-1;s>=0;s--){const n=this.spawnGroups[s];n.isExposed()?this.spawnGroups.splice(s,1):(n.grow(),n.rePath())}const e=this.getNextSpawnGroup();if(e){const s=e.getSpawnPoints()[0].getTile(0),n=[];this.surface.forCircle(s.getX(),s.getY(),5,i=>{Ks.has(i.getType())&&n.push(new Ye(i.getX(),i.getY(),A.Spore))}),this.surface.setTiles(n),this.spawnGroups.push(e),this.nextSpawnGroup=void 0}this.wave=wi.fromSpawnGroups(this.level,this.spawnGroups),this.level++,this.triggerStatUpdate()}consume(e,s=1,n=1){var i;return this.powerController.consume(((i=Kn[e.getType()])!=null?i:0)+(s-1)*Su+(n-1)*vr)}consumeContinuous(e,s,n=1){var i;return this.powerController.consume(((i=Kn[e.getType()])!=null?i:0)*s+(n-1)*vr*s/16)}getSpawnGroups(){return this.spawnGroups}getNextSpawnGroup(){if(this.nextSpawnGroup&&!this.nextSpawnGroup.isExposed())return this.nextSpawnGroup;const e=Math.ceil(2**this.spawnGroups.length/3);if(this.spawnGroups.length>0&&this.timeSinceLastExpansion<e)return;this.timeSinceLastExpansion=0;let s=Math.random()*Math.PI*2,n=!1,i=3;for(let r=0;r<20&&(this.surface.forRay(this.base.getTile().getX(),this.base.getTile().getY(),s,o=>o.getDiscoveryStatus()!==Oe.Undiscovered?(i=4,!0):(i--,i>0||!Ks.has(o.getType())?!0:(this.nextSpawnGroup=yi.fromTiles([o,o,o,o],this.base.getTile(),this.surface),n=!0,!1))),!n);r++)s+=s+Math.PI/10;return this.nextSpawnGroup}getDifficulty(){return this.difficulty}end(){this.buildController.commit(),this.base.regenerate(),this.unlocksController.addPoint(),this.triggerStatUpdate(),this.triggerEvent(ue.EndWave)}addEventListener(e,s){return this.eventHandlers.has(e)?this.eventHandlers.get(e).add(s):this.eventHandlers.set(e,new Set([s])),()=>this.removeEventListener(e,s)}addEventListeners(e,s){const n=e.map(i=>this.addEventListener(i,s));return()=>n.forEach(i=>i())}removeEventListener(e,s){var n;(n=this.eventHandlers.get(e))==null||n.delete(s)}triggerEvent(e,...s){var n;(n=this.eventHandlers.get(e))==null||n.forEach(i=>i(...s))}static get Instance(){return this.instance}};let w=Ci;c(w,"instance");class ll{constructor(e){c(this,"entity");c(this,"category",q.Unknown);c(this,"hp",50);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Tree}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return this.tile.isDiscovered()}}c(ll,"scale",1);class al{constructor(e){c(this,"entity");c(this,"category",q.Unknown);c(this,"hp",50);this.tile=e,this.entity=new ve(e.getX(),e.getY(),this)}getType(){return y.Rock}getTile(){return this.tile}updateTile(e){this.tile=e}hit(e){this.hp-=e,this.hp<=0&&w.Instance.getSurface().despawnStatic(this)}isVisible(){return this.tile.isDiscovered()}}c(al,"scale",1);var cl={exports:{}};(function(t,e){(function(s,n){t.exports=n()})(il,function(){return s.importState=function(i){var r=new s;return r.importState(i),r},s;function s(){return function(i){var r=0,o=0,l=0,a=1;i.length==0&&(i=[+new Date]);var h=n();r=h(" "),o=h(" "),l=h(" ");for(var g=0;g<i.length;g++)r-=h(i[g]),r<0&&(r+=1),o-=h(i[g]),o<0&&(o+=1),l-=h(i[g]),l<0&&(l+=1);h=null;var p=function(){var m=2091639*r+a*23283064365386963e-26;return r=o,o=l,l=m-(a=m|0)};return p.next=p,p.uint32=function(){return p()*4294967296},p.fract53=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.version="Alea 0.9",p.args=i,p.exportState=function(){return[r,o,l,a]},p.importState=function(m){r=+m[0]||0,o=+m[1]||0,l=+m[2]||0,a=+m[3]||0},p}(Array.prototype.slice.call(arguments))}function n(){var i=4022871197,r=function(o){o=o.toString();for(var l=0;l<o.length;l++){i+=o.charCodeAt(l);var a=.02519603282416938*i;i=a>>>0,a-=i,a*=i,i=a>>>0,a-=i,i+=a*4294967296}return(i>>>0)*23283064365386963e-26};return r.version="Mash 0.9",r}})})(cl);const rh=cl.exports,oh=t=>{const e=rh(t),s=Kc(e),n=s(1,0)*193,i=s(0,1)*197,r=.048,o=.0077,l=.0025,a=.0194,h=.95;return(p,m)=>{const F=p+n,k=m+i,B=s(F*r,k*r),I=s(F*l,k*l),d=Math.abs(I),S=s(F*o,k*o),b=1-Math.abs(S),M=s(F*a,k*a),N=Math.abs(M),$=(I+M/3)*.83,z=$+d*9241%1/3,L=b>h+$/10,G=b+B/3+M-.4>h+$/2;if(L||G)return I+d*1811%1/7<-.6?new Ye(p,m,A.Ice):new Ye(p,m,A.Water);if(b>h+$/15)return new Ye(p,m,A.Dirt);let H;$>.3?H=new Ye(p,m,A.Sand):$<-.5?H=new Ye(p,m,A.Snow):H=new Ye(p,m,A.Grass);const se=(M+.5)*(B-.5)+d*5419%1/10;if(se<.07&&se>.04&&z>-.4&&z<.6){const le=new ll(H);H.setStaticEntity(le.entity)}else if((z<-.5||z>.7)&&N*2791%1>.99){const le=new al(H);H.setStaticEntity(le.entity)}return H}};class lh{constructor(e=50,s=25,n=(i,r)=>new Ye(i,r)){c(this,"map");c(this,"entities",[]);c(this,"deletedEntities",[]);c(this,"staticEntities",[]);c(this,"entitiesMap",new Map);c(this,"dirty",!1);c(this,"changedTiles",new Set);c(this,"addedAgents",new Set);c(this,"removedAgents",new Set);this.width=e,this.height=s,this.generate=n,this.initialize()}initialize(){this.map=new Array(this.width*this.height);for(let e=0;e<this.height;e++)for(let s=0;s<this.width;s++)this.map[e*this.width+s]=this.generate(s,e);this.entities=[],this.deletedEntities=[],this.staticEntities=[],this.entitiesMap.clear(),Object.values(q).filter(e=>typeof e!="string").forEach(e=>this.entitiesMap.set(e,new Set))}getTile(e,s,n=!1){return e>=this.width||e<0||s>=this.height||s<0?n?this.getTile(Math.max(Math.min(e,this.width-1),0),Math.max(Math.min(s,this.height-1),0)):void 0:this.map[s*this.width+e]}getEntityTiles(e,s,n){let i;if(s)i=e;else{const r=e;i=r.getTile().getX(),s=r.getTile().getY(),n=ps(r)}switch(n){case 1:return[this.map[s*this.width+i]];case 2:return[this.map[s*this.width+i],this.map[s*this.width+i+1],this.map[(s+1)*this.width+i],this.map[(s+1)*this.width+i+1]];default:throw new Error("Unsupported agent scale!")}}getAdjacentTiles(e,s=1){return[[1,0],[-1,0],[0,1],[0,-1]].map(([i,r])=>this.getTile(e.getX()+i*s,e.getY()+r*s)).filter(i=>!!i)}setTile(e){this.setTileInternal(e)}setTiles(e){e.map(s=>this.setTileInternal(s))}setTileInternal(e){this.dirty=!0;const s=this.map[e.getY()*this.width+e.getX()];return s.hasStaticEntity()&&!e.hasStaticEntity()?e.setStaticEntity(s.getStaticEntity()):s.hasStaticEntity()&&this.despawnStatic(s.getStaticEntity().getAgent()),e.sync(s),this.map[e.getY()*this.width+e.getX()]=e,this.changedTiles.add(s),s}processChangedTiles(){!this.changedTiles.size||(w.Instance.triggerEvent(ue.SurfaceChange,{affectedTiles:this.changedTiles,addedStaticAgents:this.addedAgents,removedStaticAgents:this.removedAgents}),this.changedTiles.clear(),this.addedAgents.clear(),this.removedAgents.clear())}getRow(e){const s=e*this.width;return this.map.slice(s,s+this.width)}getColumn(e){const s=new Array(this.height);for(let n=0;n<this.height;n++)s[n]=this.getTile(e,n);return s}getWidth(){return this.width}getHeight(){return this.height}forLine(e,s,n,i,r,o){var h;const l=(h=o==null?void 0:o.scale)!=null?h:1;e=Math.floor(e/l)*l,s=Math.floor(s/l)*l,n=Math.floor(n/l)*l,i=Math.floor(i/l)*l;const a=Math.atan2(i-s,n-e);return this.forRay(e,s,a,(g,p)=>!(r(g,p)===!1)&&!(g.getX()===n&&g.getY()===i),o)}forRay(e,s,n,i,r){var d,S;const o=(d=r==null?void 0:r.connected)!=null?d:!1,l=(S=r==null?void 0:r.scale)!=null?S:1,a=Math.cos(n),h=Math.sin(n),g=Math.abs(a)+Math.abs(h);let p=Math.abs(a/g),m=Math.abs(h/g),F=(1+(p>m?m/p:p/m))*l;p*=F*Math.sign(a),m*=F*Math.sign(h);let k,B,I=0;for(;;){let b=!1;const M=Math.round(e/l)*l;let N=Math.round(s/l)*l;o&&k!==void 0&&Math.round(k/l)*l!==M&&Math.round(B/l)*l!==N&&(N=Math.round(B),b=!0);const $=this.getTile(M,N);if(!$||!i($,I))break;b||(e+=p,s+=m),k=M,B=N,I++}}forRect(e,s,n,i,r,o){var g;const l=(g=o==null?void 0:o.scale)!=null?g:1;e=Math.floor(e/l)*l,s=Math.floor(s/l)*l,n=Math.floor(n/l)*l,i=Math.floor(i/l)*l;const a=(p,m)=>{const F=this.getTile(p,m);F&&r(F)},h=p=>{if(n>e)for(let m=e;m<=n;m+=l)a(m,p);else for(let m=e;m>=n;m-=l)a(m,p)};if(i>s)for(let p=s;p<=i;p+=l)h(p);else for(let p=s;p>=i;p-=l)h(p)}forCircle(e,s,n,i,r){var m,F;const o=(m=r==null?void 0:r.edgeOnly)!=null?m:!1,l=(F=r==null?void 0:r.scale)!=null?F:1;e=Math.floor(e/l),s=Math.floor(s/l);let a=n/2;const h=a*a,g=(a-1)*(a-1),p=(k,B,I=0)=>{const d=k+I,S=B+I,b=d*d+S*S;if(b<h&&!(o&&b<g)){const M=this.getTile((e+k)*l,(s+B)*l,o);M&&i(M)}};if(n%2===0)for(let k=-a;k<a;k+=1)for(let B=-a;B<a;B+=1)p(B,k,.5);else{a=a|0;for(let k=-a;k<a+1;k+=1)for(let B=-a;B<a+1;B+=1)p(B,k)}}spawn(e){this.entities.push(e.entity),this.entitiesMap.get(e.category).add(e.entity),e.spawn&&e.spawn()}spawnStatic(e){this.getEntityTiles(e).forEach(n=>{n.setStaticEntity(e.entity),this.changedTiles.add(n)}),this.addedAgents.add(e),this.spawn(e),this.dirty=!0}despawn(e){const s=this.entities.indexOf(e.entity);s>=0&&this.entities.splice(s,1);const n=this.entitiesMap.get(e.category).delete(e.entity);return this.deletedEntities.push(e.entity),e.despawn&&e.despawn(),n}despawnStatic(e){this.getEntityTiles(e).forEach(n=>{n.clearStaticEntity(),this.changedTiles.add(n)}),this.removedAgents.add(e),this.despawn(e),this.dirty=!0}getEntities(){return this.entities}getEntitiesForCategory(e){return this.entitiesMap.get(e)}getDeletedEntities(){return this.deletedEntities}getStaticEntities(){return this.staticEntities}markPristine(){this.dirty=!1,this.deletedEntities=[]}isDirty(){return this.dirty}}var Ls=(t=>(t[t.Growing=0]="Growing",t[t.Fixed=1]="Fixed",t))(Ls||{});class In{constructor(e,s=0,n=10){c(this,"size");c(this,"freeEntities",[]);c(this,"usedEntities",new Map);this.initializer=e,this.type=s,this.size=n;for(let i=0;i<n;i++)this.freeEntities.push(e(!1))}get(e){let s=this.usedEntities.get(e);if(s)return s;if(this.freeEntities.length===0){if(this.type===1)throw new Error("Pool is empty");this.size++}return s=this.initializer(!0,this.freeEntities.pop(),e),this.usedEntities.set(e,s),s}free(e){if(!this.usedEntities.has(e))return;let s=this.usedEntities.get(e);return this.usedEntities.delete(e),this.freeEntities.push(s),s}getSize(){return this.size}getUsed(){return this.usedEntities}}const ah=(t,e,s)=>{const n=e.entity,i=n.getX()+.5,r=n.getY()+.5,o=Math.sqrt((i-e.targetX-.5)**2+(r-e.targetY-.5)**2);s.style.transformOrigin="0 0",s.style.opacity=`${1-.9*(e.time/Lo)}`,s.style.transform=`translate(${i*t.xStep}px, ${r*t.yStep}px) rotate(${n.getRotation()}deg) scale(${o}, 0.1)`},ch=(t,e,s)=>{const n=e.entity;s.style.opacity=`${1-.9*(e.time/jn)}`,s.style.transform=`translate(${(n.getX()+Math.random()*.3-.15)*t.xStep}px, ${(n.getY()+Math.random()*.3-.15)*t.yStep}px) rotate(${n.getRotation()+Math.random()*10-5+90}deg)`},Sr=1/4,Tr=(t,e,s)=>{const n=e.entity,i=n.getId()%13/26-Sr,r=(n.getId()+5)%17/34-Sr,o=t.getTime()%13/3;let l=n.getRotation();e.AI.isBusy()&&(l+=Math.sin(t.getTime()%qs/qs*5)*20),e.getStatus()===He.OnFire?(s.style.color="transparent",s.style.textShadow=`${Math.random()-.5}px ${Math.random()-.5}px ${o+2}px #E25822`):e.getStatus()===He.Normal&&(s.style.color="initial",s.style.textShadow="none"),s.style.transform=`translate(${(n.getX()+i)*t.xStep}px, ${(n.getY()+r)*t.yStep}px) rotate(${l}deg)`},uh=(t,e,s)=>{const n=e.entity;s.children[0].textContent=t.getStaticEntityEmoji(e.getPlaceable().entityType),s.style.transformOrigin="0 0",s.style.opacity="0.5",s.style.filter="grayscale(0.6)",s.style.transform=`translate(${n.getX()*t.xStep}px, ${n.getY()*t.yStep}px) rotate(${n.getRotation()}deg) scale(${e.getScale()})`},hh=(t,e,s)=>{const n=e.entity,i=n.getX()+.5,r=n.getY()+.5,o=Math.sqrt((i-e.targetX-.5)**2+(r-e.targetY-.5)**2);s.style.color="transparent",s.style.textShadow="0 0 0 #E25822",s.style.transformOrigin="0 0",s.style.opacity=`${1-.9*(e.time/zn)}`,s.style.transform=`translate(${i*t.xStep}px, ${r*t.yStep}px) rotate(${n.getRotation()}deg) scale(${o}, 0.1)`},fh={[y.Rail]:ah,[y.Flame]:ch,[y.Slime]:Tr,[y.Runner]:Tr,[y.Blueprint]:uh,[y.LaserBeam]:hh},dh=Ne({__name:"Key",props:{char:null,area:null},setup(t){const e=t,s=e.char>"A"&&e.char<"z";return(n,i)=>(K(),Q("div",{class:be({key:!0,emoji:!ne(s)}),style:Qs({gridArea:e.area})},de(e.char),7))}});const je=(t,e)=>{const s=t.__vccOpts||t;for(const[n,i]of e)s[n]=i;return s},ye=je(dh,[["__scopeId","data-v-29904777"]]),gh=Ne({__name:"mouse",props:{button:null},setup(t){const e=t;return(s,n)=>(K(),Q("div",{class:be(`mouse button-${e.button}`)},null,2))}});const Ns=je(gh,[["__scopeId","data-v-a6549770"]]),ph=Ne({__name:"TextWithControls",props:{text:null},setup(t){const e=t,s={0:"left",1:"right",3:"middle"},n=te(e.text),i=te(""),r=te(""),o=te("");return Os(()=>e.text,l=>{const h=/^(?<left>.*?){(?<control>key|mouse): (?<type>.*?)}(?<right>.*)$/.exec(l);h?(n.value=h.groups.left,i.value=h.groups.control,r.value=h.groups.type,o.value=h.groups.right):(n.value=l,i.value="",r.value="",o.value="")},{immediate:!0}),(l,a)=>{const h=Na("TextWithControls",!0);return K(),Q(pe,null,[he(de(n.value)+" ",1),i.value==="key"?(K(),It(ye,{key:0,char:r.value},null,8,["char"])):Ee("",!0),i.value==="mouse"?(K(),It(Ns,{key:1,button:ne(s)[r.value]},null,8,["button"])):Ee("",!0),o.value?(K(),It(h,{key:2,text:o.value},null,8,["text"])):Ee("",!0)],64)}}}),mh={class:"message-wrapper"},yh={key:0},wh=["onClick"],_h=Ne({__name:"SimpleMessage",props:{register:null},setup(t){const e=t,s=te([]),n=te(new Map),i=di(),r=(l,a)=>{var p;const h={id:Date.now(),content:l,closable:(p=a==null?void 0:a.closable)!=null?p:!0,open:!0};if(a!=null&&a.expires){const m=window.setTimeout(()=>{o(h)},a.expires);n.value.set(h.id,m)}let g=-1;if(a!=null&&a.override&&(g=s.value.findIndex(m=>m.id===a.override)),g!==-1){const m=s.value[g].id;window.clearTimeout(n.value.get(m)),n.value.delete(m),s.value[g]=h}else s.value.push(h);return Promise.resolve(h.id)},o=l=>{l.open=!1,i.proxy.$forceUpdate(),window.setTimeout(()=>{s.value.splice(s.value.indexOf(l),1)},200)};return xt(()=>{e.register(r)}),(l,a)=>(K(),Q("div",mh,[(K(!0),Q(pe,null,Hs(s.value.length+1,h=>{var g;return K(),Q("div",{key:h,class:be({message:!0,"message--visible":(g=s.value[h-1])==null?void 0:g.open})},[s.value[h-1]?(K(),Q("div",yh,[s.value[h-1].closable?(K(),Q("button",{key:0,class:"close-button",onClick:()=>o(s.value[h-1])}," \u2716 ",8,wh)):Ee("",!0),V(ph,{text:s.value[h-1].content},null,8,["text"])])):Ee("",!0)],2)}),128))]))}});const vh=je(_h,[["__scopeId","data-v-e2836806"]]),Ae=navigator.appVersion.indexOf("Win")!=-1,bh=42,Eh=4,Sh=20;let wt=!1;class Th{constructor(e,s){c(this,"pool");c(this,"selectionPool");c(this,"scaledTilesPool");c(this,"messageFn");c(this,"resolveMessageFn");c(this,"xStep",0);c(this,"yStep",0);c(this,"offsetX",0);c(this,"offsetY",0);c(this,"time",0);c(this,"fontSize",Sh);c(this,"hasMoved",!1);c(this,"_showCoverage",!1);c(this,"target",null);c(this,"world",null);c(this,"rows",[]);c(this,"coverageMap",null);c(this,"coverageRows",[]);c(this,"showMessage",async(...e)=>(await this.messageFn)(...e));c(this,"getEmoji",e=>{if(e.getDiscoveryStatus()===Oe.Pending&&!wt)return"\u{1F50D}";if(!e.isDiscovered()&&!wt)return"&nbsp;";if(e.hasStaticEntity()&&ps(e.getStaticEntity().getAgent())!==2)return this.getStaticEntityEmoji(e.getStaticEntity().getAgent().getType());switch(e.getBaseType()){case A.Water:return"\u{1F7E6}";case A.Stone:return"\u2B1C";case A.Grass:return"\u{1F7E9}";case A.Spore:return"\u{1F7EA}";case A.Bridge:return"\u{1F4DC}";case A.Sand:return"\u{1F7E8}";case A.Snow:return"\u{1F32B}\uFE0F";case A.Dirt:return"\u{1F7EB}";case A.Ice:return"\u{1F9CA}";default:return"&nbsp;"}});this.surface=e,this.controller=s,this.pool=new In((n,i,r)=>{if(i)return i.style.display="block",i.style.opacity="1",i.style.transformOrigin="50% 50%",i.style.filter="none",i.style.color="initial",i.style.textShadow="none",i.children[0].textContent=this.getEntityEmoji(r),i;const o=document.createElement("span");return o.appendChild(document.createElement("span")),Ae&&(o.children[0].style.margin="-0.35ch"),o.children[0].textContent=r?this.getEntityEmoji(r):"",o.style.position="absolute",o.style.top=Ae?"-.125ch":"-.075ch",o.style.left=Ae?".35ch":"0",o.style.display=n?"block":"none",o.style.willChange="transform",this.world.appendChild(o),o},Ls.Growing,0),this.selectionPool=new In((n,i)=>{if(i)return i.style.display="block",i;const r=document.createElement("span");return r.appendChild(document.createElement("span")),Ae&&(r.children[0].style.margin="-0.35ch"),r.children[0].textContent="\u{1F7E7}",r.style.transformOrigin="0 0",r.style.opacity="0.7",r.style.position="absolute",r.style.top=Ae?"-.125ch":"-.075ch",r.style.left=Ae?".35ch":"0",r.style.display=n?"block":"none",r.style.willChange="transform",this.world.appendChild(r),r},Ls.Growing,0),this.scaledTilesPool=new In((n,i,r)=>{if(i)return i.style.display="block",i.children[0].textContent=this.getStaticEntityEmoji(r.getAgent().getType()),i;const o=document.createElement("span");return o.appendChild(document.createElement("span")),Ae&&(o.children[0].style.margin="-0.35ch"),o.children[0].textContent=r?this.getStaticEntityEmoji(r.getAgent().getType()):"",o.style.transformOrigin="0 0",o.style.position="absolute",o.style.top=Ae?"-.125ch":"-.075ch",o.style.left=Ae?".35ch":"0",o.style.display=n?"block":"none",o.style.willChange="transform",this.world.appendChild(o),o},Ls.Growing,0),this.messageFn=new Promise(n=>this.resolveMessageFn=n),window.debug=()=>{wt=!wt,this.renderTiles()}}mount(e){this.target=e;const s=e.appendChild(document.createElement("div"));Co(vh,{register:this.resolveMessageFn}).mount(s),this.world=e.appendChild(document.createElement("div")),this.world.className="scrollable",this.world.style.lineHeight=Ae?"1.86ch":"1ch",this.world.style.whiteSpace="nowrap",this.world.style.cursor="crosshair",this.world.style.userSelect="none",this.world.style.position="relative",this.world.style.fontFamily='"Apple Color Emoji","Segoe UI Emoji","Noto Color Emoji","Android Emoji","EmojiOne Mozilla","Twemoji Mozilla","Noto Emoji","Segoe UI Symbol",EmojiSymbols',this.world.style.backgroundColor="#000",Ae&&(this.world.style.letterSpacing="-0.7ch",this.world.style.wordSpacing="2.04ch"),this.renderTiles(),this.zoom();const{width:n,height:i}=this.world.getBoundingClientRect(),r=w.Instance.getBase().getTile();this.world.scrollLeft=r.getX()*this.xStep-n/2,this.world.scrollTop=r.getY()*this.yStep-i/2,this.rerender(0),this.registerEventHandlers(this.world)}zoom(){const e=(this.world.scrollLeft+this.world.clientWidth/2)/this.world.scrollWidth,s=(this.world.scrollTop+this.world.clientHeight/2)/this.world.scrollHeight;this.world.style.fontSize=`${this.fontSize}px`;const{width:n,height:i,x:r,y:o}=this.world.getBoundingClientRect(),l=this.world.scrollWidth,a=this.world.scrollHeight;this.xStep=l/this.surface.getWidth(),this.yStep=a/this.surface.getHeight(),this.offsetX=r,this.offsetY=o,this.world.scrollLeft=e*l-n/2,this.world.scrollTop=s*a-i/2}rerender(e){this.time+=e,this.surface.isDirty()&&this.renderTiles(),(this.surface.isDirty()||this.hasMoved)&&this.renderStaticAgents();const s=this.surface.getEntities();for(let i of s){const r=fh[i.getAgent().getType()];if(!this.getEntityEmoji(i)&&!r)continue;const o=this.pool.get(i);o.style.display=i.getAgent().isVisible()?"block":"none",r?r(this,i.getAgent(),o):o.style.transform=`translate(${i.getX()*this.xStep}px, ${i.getY()*this.yStep}px) rotate(${i.getRotation()}deg)`}this.surface.getDeletedEntities().forEach(i=>{const r=this.pool.free(i);r&&(r.style.display="none")}),this.renderSelection(),this.surface.markPristine()}showCoverage(){this._showCoverage=!0,this.renderTiles()}hideCoverage(){this._showCoverage=!1,this.renderTiles()}renderTiles(){const e=this.surface.getHeight();for(let s=0;s<e;s++){let n=this.rows[s];n||(n=document.createElement("div"),Ae&&(n.style.letterSpacing="-0.7ch"),this.rows[s]=n,this.world.appendChild(n));const i=this.surface.getRow(s).map(this.getEmoji).join("");n.innerHTML=i}this.renderCoverage()}renderStaticAgents(){const e=this.surface.getEntitiesForCategory(q.Player);for(let n of e){const i=n.getAgent();if(Wn(i)&&ps(i)===2){const r=this.scaledTilesPool.get(n);r.style.transform=`translate(${n.getX()*this.xStep}px, ${n.getY()*this.yStep}px) scale(2)`}}this.surface.getDeletedEntities().forEach(n=>{const i=this.scaledTilesPool.free(n);i&&(i.style.display="none")})}renderCoverage(){if(this.coverageMap||(this.coverageMap=document.createElement("div"),this.coverageMap.style.opacity="0.5",this.coverageMap.style.position="absolute",this.coverageMap.style.top="0",this.coverageMap.style.left=Ae?"-0.125ch":"0",Ae&&(this.coverageMap.style.letterSpacing="-0.7ch",this.coverageMap.style.wordSpacing="2.04ch"),this.world.appendChild(this.coverageMap)),this._showCoverage)this.coverageMap.style.display="block";else{this.coverageMap.style.display="none";return}const e=new Set;if(w.Instance.getDifficulty()===Je.Easy&&(w.Instance.getSpawnGroups().forEach(n=>n.getSpawnPoints()[0].getTiles().forEach(i=>e.add(i))),!w.Instance.getIsStarted())){const n=w.Instance.getNextSpawnGroup();n&&n.getSpawnPoints()[0].getTiles().forEach(i=>e.add(i))}const s=this.surface.getHeight();for(let n=0;n<s;n++){let i=this.coverageRows[n];i||(i=document.createElement("div"),this.coverageRows[n]=i,this.coverageMap.appendChild(i));const r=this.surface.getRow(n).map(o=>{if(!o.isDiscovered()&&!wt)return"&nbsp;";const l=o.isCoveredByTower();return e.has(o)?l?"\u2694\uFE0F":"\u{1F43E}":l?"\u{1F3AF}":"&nbsp;"}).join("");i.innerHTML=r}}renderSelection(){var i,r;const e=this.selectionPool.getUsed();let s=this.controller.getSelection();s.length===1&&(s=[]);const n=((r=(i=this.controller.getPlacable())==null?void 0:i.entity)==null?void 0:r.scale)||1;s.forEach((o,l)=>{const a=e.has(l)?e.get(l):this.selectionPool.get(l);a.style.transform=`translate(${o.getX()*this.xStep}px, ${o.getY()*this.yStep}px) scale(${n})`});for(let o=e.size-1;o>=s.length;o--){const l=this.selectionPool.free(o);l&&(l.style.display="none")}}unmount(){throw new Error("Method not implemented.")}getTime(){return this.time}canMove(e,s){if(wt)return!0;const n=this.getBBox(),i=w.Instance.getVisibilityController().getBBox();if(Math.abs(e)>Math.abs(s)){if(e<0&&n[0][0]<=i[0][0]||e>0&&n[1][0]>=i[1][0])return!1}else if(s<0&&n[0][1]<=i[0][1]||s>0&&n[1][1]>=i[1][1])return!1;return!0}registerEventHandlers(e){e.addEventListener("contextmenu",n=>(n.preventDefault(),!1));const s=(n,i,r)=>{wt||(this.getBBox(),w.Instance.getVisibilityController().getBBox(),this.canMove(n,i)||r.preventDefault())};e.addEventListener("wheel",n=>{s(n.deltaX,n.deltaY,n)},{passive:!1}),e.addEventListener("mousedown",n=>{const i=Math.floor((n.pageX-this.offsetX+this.world.scrollLeft)/this.xStep),r=Math.floor((n.pageY-this.offsetY+this.world.scrollTop)/this.yStep);this.controller.mouseDown(i,r)}),e.addEventListener("mousemove",n=>{const i=Math.floor((n.pageX-this.offsetX+this.world.scrollLeft)/this.xStep),r=Math.floor((n.pageY-this.offsetY+this.world.scrollTop)/this.yStep);this.controller.mouseMove(i,r)}),e.addEventListener("mouseup",n=>{const i=Math.floor((n.pageX-this.offsetX+this.world.scrollLeft)/this.xStep),r=Math.floor((n.pageY-this.offsetY+this.world.scrollTop)/this.yStep);this.controller.mouseUp(i,r)}),window.addEventListener("keydown",n=>{this.controller.keyDown(n.key),n.preventDefault()}),window.addEventListener("keyup",n=>{this.controller.keyUp(n.key),n.preventDefault()})}move({x:e=0,y:s=0,zoom:n}){(e||s)&&this.canMove(e,s)&&(this.world.scrollLeft+=e*this.fontSize/2,this.world.scrollTop+=s*this.fontSize/2),n&&(n<0?this.fontSize=Math.max(Eh,this.fontSize*.9):this.fontSize=Math.min(bh,this.fontSize*1.1),this.zoom(),this.hasMoved=!0)}getStaticEntityEmoji(e){switch(e){case y.Tower:return"\u{1F5FC}";case y.Wall:return"\u{1F9F1}";case y.Mortar:return"\u{1F6F0}\uFE0F";case y.Flamethrower:return"\u{1F9EF}";case y.Railgun:return"\u{1F321}\uFE0F";case y.ElectricFence:return"\u26A1";case y.Fence:return"\u{1F945}";case y.Freezer:return"\u2744\uFE0F";case y.Base:return"\u26FA";case y.Tree:return"\u{1F332}";case y.Rock:return"\u{1FAA8}";case y.Radar:return"\u{1F4E1}";case y.PowerPlant:return"\u{1F3ED}";case y.None:return"\u274C";case y.Armory:return"\u{1F3F0}";case y.Market:return"\u{1F3EA}";case y.SpeedBeacon:return"\u23F0";case y.DamageBeacon:return"\u{1F6A8}";case y.Laser:return"\u{1F52D}";default:return"\u2753"}}getEntityEmoji(e){switch(e.getAgent().getType()){case y.Slime:return"\u{1F41E}";case y.Bullet:return"\u25AA";case y.Rail:case y.LaserBeam:return"\u2B1B";case y.Flame:return"\u{1F525}";case y.Shockwave:return"\u{1F300}";case y.Runner:return"\u{1FAB3}";default:return""}}getBBox(){const e=this.world.scrollTop/this.yStep,s=this.world.scrollLeft/this.xStep,n=this.world.clientHeight/this.yStep,i=this.world.clientWidth/this.xStep;return[[s,e],[s+i,e+n]]}}var Ce=(t=>(t.Shift="Shift",t.Control="Control",t.Meta="Meta",t.Plus="+",t.Minus="-",t.Equals="=",t.Up="ArrowUp",t.Left="ArrowLeft",t.Right="ArrowRight",t.Down="ArrowDown",t.W="w",t.A="a",t.S="s",t.D="d",t.Z="z",t.Q="q",t.B="b",t))(Ce||{});const Mh=new Set(Object.values(Ce));function Mr(t){return Mh.has(t)}class Ih{constructor(e){c(this,"mouseDownX",0);c(this,"mouseDownY",0);c(this,"mouseX",0);c(this,"mouseY",0);c(this,"pressedKeys",{});c(this,"isMouseDown",!1);c(this,"eventHandlers",new Map);c(this,"selectedPlacable",null);c(this,"buildMenuOpen",!1);this.surface=e}getPlacable(){return this.selectedPlacable}setPlaceable(e){this.selectedPlacable=e}mouseDown(e,s){this.mouseDownX=e,this.mouseDownY=s,this.isMouseDown=!0}mouseMove(e,s){this.mouseX=e,this.mouseY=s}getSelection(){var i,r,o,l;if(!this.isMouseDown)return[];let e=this.mouseX,s=this.mouseY;if(this.pressedKeys.Control||this.pressedKeys.Meta){let a=[];return this.surface.forRect(this.mouseDownX,this.mouseDownY,e,s,h=>{h.isDiscovered()&&a.push(h)},{scale:((r=(i=this.selectedPlacable)==null?void 0:i.entity)==null?void 0:r.scale)||1}),a}this.pressedKeys.Shift&&(Math.abs(e-this.mouseDownX)>Math.abs(s-this.mouseDownY)?s=this.mouseDownY:e=this.mouseDownX);let n=[];return this.surface.forLine(this.mouseDownX,this.mouseDownY,e,s,a=>{a.isDiscovered()&&n.push(a)},{scale:((l=(o=this.selectedPlacable)==null?void 0:o.entity)==null?void 0:l.scale)||1}),n}mouseUp(e,s){if(!this.selectedPlacable){this.isMouseDown=!1;return}const n=this.getSelection();w.Instance.getBuildController().build(n,this.selectedPlacable),this.isMouseDown=!1}keyDown(e){Mr(e)&&(this.pressedKeys[e]=!0)}keyUp(e){var s;Mr(e)&&(this.pressedKeys[e]=!1,(s=this.eventHandlers.get(e))==null||s.forEach(n=>n()),e==="b"&&this.toggleBuildMenu())}toggleBuildMenu(){this.buildMenuOpen=!this.buildMenuOpen,this.buildMenuOpen?w.Instance.triggerEvent(ue.OpenBuildMenu):w.Instance.triggerEvent(ue.CloseBuildMenu)}isKeyDown(e){var s;return(s=this.pressedKeys[e])!=null?s:!1}addKeyListener(e,s){return this.eventHandlers.has(e)?this.eventHandlers.get(e).add(s):this.eventHandlers.set(e,new Set([s])),()=>this.removeKeyListener(e,s)}removeKeyListener(e,s){var n;(n=this.eventHandlers.get(e))==null||n.delete(s)}}const qn=(t,e,s)=>new Promise(n=>{const i=w.Instance.addEventListener(e,(...r)=>{(!s||s(...r))&&(i(),n())})}).then(()=>t),ul=(t,e,s)=>new Promise(n=>{const i=w.Instance.addEventListeners(e,r=>{(!s||s(r))&&(i(),n())})}).then(()=>t),hl=(t,...e)=>s=>ul(w.Instance.showMessage(t,{override:s}),e),Ch=hl("Welcome to Open Tower Defense! Open the build menu by clicking the {key: \u{1F527}} button or by pressing {key: b}",ue.OpenBuildMenu),xh=t=>qn(w.Instance.showMessage("Build towers and walls near your base to protect it from enemies lurking in undiscovered areas",{override:t}),ue.SurfaceChange,({affectedTiles:e})=>!!e.size),Ah=t=>new Promise(e=>{const s=w.Instance.getDifficulty();if(s===Je.Hard){e(t);return}ul(w.Instance.showMessage(`Click the {key: \u{1F3AF}} button to view tower sight lines${s===Je.Easy?" and enemy paths":" "} to check how effective your layout is`,{override:t}),[ue.ToggleShowCoverage,ue.StartWave]).then(e)}),Ph=t=>new Promise(e=>{if(w.Instance.getIsStarted()){qn(t,ue.EndWave).then(e);return}qn(w.Instance.showMessage("Start the wave when you are ready. Good luck!",{override:t}),ue.EndWave).then(e)}),Fh=hl("After beating a wave you can unlock a new building in the build menu strengthen your defense, take a look!",ue.OpenBuildMenu),Ir=[Ch,xh,Ah,Ph,Fh];class kh{constructor(){c(this,"promise");c(this,"reject");c(this,"previousId",-1)}async start(){this.promise=new Promise(async(e,s)=>{this.reject=s;for(let n=0;n<Ir.length;n++){const i=Ir[n];this.previousId=await i(this.previousId)}e()}),await this.promise}stop(){var e;(e=this.reject)==null||e.call(this)}}const fl=t=>(ys("data-v-9f4d166e"),t=t(),ws(),t),Bh={class:"sprite"},Dh={class:"name"},Oh={key:0,class:"lock"},Rh={class:"data"},Lh={key:0},Nh=fl(()=>O("span",{class:"emoji"},"\u{1FA99}",-1)),$h={key:1},Yh=fl(()=>O("span",{class:"emoji"},"\u{1F4D0}",-1)),Xh={key:2},Uh={key:3},Hh=Ne({__name:"Placeable",props:{item:null,locked:{type:Boolean},onSelect:null,selected:{type:Boolean}},setup(t){const e=t,s=os[e.item.entityType],n=e.item.entity&&e.item.entity.range;return(i,r)=>(K(),Q("button",{class:be({placeable:!0,"placeable--locked":e.locked,"placeable--selected":e.selected}),onClick:r[0]||(r[0]=o=>e.onSelect(t.item))},[O("span",Bh,de(e.item.htmlElement),1),O("span",Dh,[he(de(e.item.name)+" ",1),e.locked?(K(),Q("span",Oh,"\u{1F512}")):Ee("",!0)]),O("ul",Rh,[ne(s)?(K(),Q("li",Lh,[Nh,he(" "+de(ne(s)),1)])):Ee("",!0),ne(n)?(K(),Q("li",$h,[Yh,he(" "+de(ne(n)),1)])):Ee("",!0),ne(Kn)[e.item.entityType]?(K(),Q("li",Xh,"\u26A1")):Ee("",!0),e.item.isBasePart?(K(),Q("li",Uh,"\u{1F9F1}")):Ee("",!0)])],2))}});const Cr=je(Hh,[["__scopeId","data-v-9f4d166e"]]),Wh=t=>(ys("data-v-67bace99"),t=t(),ws(),t),jh={class:"marketplace"},zh={class:"info"},Vh={class:"description"},Kh={class:"buttons"},Gh=["disabled"],qh={class:"grid"},Zh={class:"column"},Jh={class:"header"},Qh={class:"item"},ef={class:"column"},tf=Wh(()=>O("div",{class:"header"},"Sell",-1)),sf={class:"item"},nf=Ne({__name:"Marketplace",props:{controller:null,unlocksController:null,manager:null},setup(t){const e=t,s=te(e.controller.getPlacable()),n=te(!1),i=di();let r,o;xt(()=>{r=e.manager.addEventListener(ue.OpenBuildMenu,()=>n.value=!0),o=e.manager.addEventListener(ue.CloseBuildMenu,()=>n.value=!1)}),Xt(()=>{r&&o&&(r(),o())});const l=p=>{s.value=p,e.controller.setPlaceable(p)},a=Object.values(gi),h=()=>{e.unlocksController.unlock(s.value.entityType),i.proxy.$forceUpdate()},g=()=>{e.controller.toggleBuildMenu()};return(p,m)=>{var F;return K(),Q("div",{class:be({"marketplace-wrapper":!0,"marketplace-wrapper--visible":n.value})},[O("div",jh,[O("div",zh,[O("p",Vh,de(s.value?s.value.description:"Select a tower below."),1),O("div",Kh,[s.value&&!e.unlocksController.isUnlocked(s.value.entityType)?(K(),Q("button",{key:0,disabled:!e.unlocksController.canUnlock(s.value.entityType),onClick:h}," Unlock ",8,Gh)):Ee("",!0),O("button",{onClick:g},"Close")])]),O("div",qh,[(K(!0),Q(pe,null,Hs(ne(a),k=>(K(),Q("div",Zh,[O("div",Jh,de(k),1),(K(!0),Q(pe,null,Hs(ne(el)[k],B=>{var I;return K(),Q("div",Qh,[V(Cr,{item:B,locked:!e.unlocksController.isUnlocked(B.entityType),selected:((I=s.value)==null?void 0:I.entityType)===B.entityType,onSelect:l},null,8,["item","locked","selected"])])}),256))]))),256)),O("div",ef,[tf,O("div",sf,[V(Cr,{item:ne(Gs),locked:!1,selected:((F=s.value)==null?void 0:F.entityType)===ne(Gs).entityType,onSelect:l},null,8,["item","selected"])])])])])],2)}}});const rf=je(nf,[["__scopeId","data-v-67bace99"]]),of={class:"stats"},lf={class:"meta"},af=he("("),cf={class:"positive"},uf=he(")"),hf={class:"meta"},ff=he("("),df={class:"positive"},gf=he("/"),pf={class:"negative"},mf=he(")"),yf={class:"meta"},wf=he("("),_f={class:"positive"},vf=he(")"),bf=Ne({__name:"Stats",props:{expanded:{type:Boolean}},setup(t){const e=t,s=Intl.NumberFormat(void 0,{maximumFractionDigits:0}),n=Intl.NumberFormat(void 0,{maximumFractionDigits:2}),i=Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:0}),r=te(0),o=te(0),l=te(0),a=te(0),h=te(!1),g=te(0),p=te(0),m=te(0),F=te(0),k=te(0),B=d=>{r.value=d.money,o.value=d.moneyMultiplier,l.value=d.level,a.value=d.remainingEnemies,h.value=d.inProgress,g.value=d.integrity,p.value=d.regeneration,m.value=d.power,F.value=d.production,k.value=d.consumption},I=Mo(()=>({stat:!0,"stat--expanded":e.expanded}));return xt(()=>{w.Instance.addEventListener(ue.StatUpdate,B),w.Instance.triggerStatUpdate()}),Xt(()=>{w.Instance.removeEventListener(ue.StatUpdate,B)}),(d,S)=>(K(),Q("div",of,[O("span",{class:be(ne(I))},[he(" \u{1FA99} "+de(r.value)+" ",1),O("span",lf,[af,O("span",cf,de(ne(i).format(o.value)),1),uf])],2),O("span",{class:be(ne(I))},[he(" \u{1F50B} "+de(ne(s).format(m.value))+" ",1),O("span",hf,[ff,O("span",df,"+"+de(ne(n).format(F.value)),1),gf,O("span",pf,"-"+de(ne(n).format(k.value)),1),mf])],2),O("span",{class:be(ne(I))},[he(" \u{1F6E1}\uFE0F "+de(ne(s).format(g.value))+" ",1),O("span",yf,[wf,O("span",_f,"+"+de(ne(n).format(p.value)),1),vf])],2),O("span",{class:be(ne(I))}," \u{1F47E} "+de(a.value),3)]))}});const Ef=je(bf,[["__scopeId","data-v-f129b1c1"]]),Sf=t=>(ys("data-v-d28e9a66"),t=t(),ws(),t),Tf={class:"hud"},Mf={class:"hud-positioner"},If={class:"group"},Cf=Sf(()=>O("span",{class:"emoji"},"\u2694\uFE0F",-1)),xf={key:0},Af={key:1},Pf=Ne({__name:"Hud",props:{renderer:null,controller:null},setup(t){const e=t,s=te(0),n=te(!1),i=te(!1),r=te(!1),o=g=>{s.value=g.level,n.value=g.inProgress};xt(()=>{w.Instance.addEventListener(ue.StatUpdate,o),w.Instance.triggerStatUpdate()}),Xt(()=>{w.Instance.removeEventListener(ue.StatUpdate,o)});function l(){w.Instance.start()}function a(){r.value=!r.value}function h(){i.value?e.renderer.hideCoverage():e.renderer.showCoverage(),w.Instance.triggerEvent(ue.ToggleShowCoverage),i.value=!i.value}return(g,p)=>(K(),Q("div",Tf,[O("div",Mf,[V(Ef,{expanded:r.value},null,8,["expanded"]),O("div",If,[O("button",{class:be({"wave-toggle":!0,"wave-toggle--active":!n.value}),onClick:l},[Cf,n.value?Ee("",!0):(K(),Q("span",xf,"Start wave "+de(s.value+1),1)),n.value?(K(),Q("span",Af,"Wave "+de(s.value),1)):Ee("",!0)],2),O("button",{class:"toggle",onClick:p[0]||(p[0]=(...m)=>e.controller.toggleBuildMenu&&e.controller.toggleBuildMenu(...m))}," \u{1F527} "),O("button",{class:be({toggle:!0,"toggle-toggled":r.value}),onClick:a}," \u{1F50E} ",2),ne(w).Instance.getDifficulty()!==ne(Je).Hard?(K(),Q("button",{key:0,class:be({toggle:!0,"toggle-toggled":i.value}),onClick:h}," \u{1F3AF} ",2)):Ee("",!0)])])]))}});const Ff=je(Pf,[["__scopeId","data-v-d28e9a66"]]),kf={class:"wrapper"},Bf={class:"canvas"},Df=Ne({__name:"Game",props:{seed:null,difficulty:null},setup(t){const e=t,s=te(null),n=new lh(300,300,oh(e.seed)),i=new Ih(n),r=new Th(n,i),o=n.getTile(150,150),l=new w(e.difficulty,o,n,i,r.showMessage);new kh().start();let h=!1,g=0;return xt(()=>{h=!0,r.mount(s.value);const p=m=>{const F=+i.isKeyDown(Ce.Right)+ +i.isKeyDown(Ce.D)-+i.isKeyDown(Ce.Left)-+i.isKeyDown(Ce.A)-+i.isKeyDown(Ce.Q),k=+i.isKeyDown(Ce.Down)+ +i.isKeyDown(Ce.S)-+i.isKeyDown(Ce.Up)-+i.isKeyDown(Ce.W)-+i.isKeyDown(Ce.Z),B=+i.isKeyDown(Ce.Plus)+ +i.isKeyDown(Ce.Equals)-+i.isKeyDown(Ce.Minus);(F||k||B)&&r.move({x:F,y:k,zoom:B});const I=m-g;l.tick(I),r.rerender(I),g=m,h&&window.requestAnimationFrame(p)};window.requestAnimationFrame(p)}),Xt(()=>h=!1),(p,m)=>(K(),Q("div",kf,[V(Ff,{renderer:ne(r),controller:ne(l).getController()},null,8,["renderer","controller"]),O("div",Bf,[O("div",{class:"render-target",ref_key:"canvas",ref:s},null,512),V(rf,{controller:ne(l).getController(),unlocksController:ne(l).getUnlocksController(),manager:ne(l)},null,8,["controller","unlocksController","manager"])])]))}});const Of=je(Df,[["__scopeId","data-v-174c7d57"]]);const Rf={},Lf={class:"key-grid"};function Nf(t,e){return K(),Q("div",Lf,[Xa(t.$slots,"default",{},void 0,!0)])}const Cn=je(Rf,[["render",Nf],["__scopeId","data-v-b972f38d"]]),pn=t=>(ys("data-v-b2b49560"),t=t(),ws(),t),$f=pn(()=>O("h3",null,"Build menu",-1)),Yf={class:"flex"},Xf=pn(()=>O("h3",null,"Building",-1)),Uf={class:"flex flex-justify"},Hf=he(" / "),Wf={class:"key-combination"},jf=he(" + "),zf=he(" / "),Vf={class:"key-combination"},Kf=he(" + "),Gf=pn(()=>O("h3",null,"Moving",-1)),qf={class:"flex flex-justify"},Zf=he(" / "),Jf=he(" / "),Qf=pn(()=>O("h3",null,"Zooming",-1)),ed={class:"flex"},td=Ne({__name:"ControlsList",setup(t){return(e,s)=>(K(),Q(pe,null,[$f,O("div",Yf,[V(ye,{char:"b"})]),Xf,O("div",Uf,[V(Ns,{button:"left"}),Hf,O("span",Wf,[V(ye,{char:"\u21E7"}),jf,V(Ns,{button:"left"})]),zf,O("span",Vf,[V(ye,{char:"\u2318"}),Kf,V(Ns,{button:"left"})])]),Gf,O("div",qf,[V(Cn,null,{default:Ds(()=>[V(ye,{char:"w",area:"up"}),V(ye,{char:"a",area:"left"}),V(ye,{char:"s",area:"down"}),V(ye,{char:"d",area:"right"})]),_:1}),Zf,V(Cn,null,{default:Ds(()=>[V(ye,{char:"z",area:"up"}),V(ye,{char:"q",area:"left"}),V(ye,{char:"s",area:"down"}),V(ye,{char:"d",area:"right"})]),_:1}),Jf,V(Cn,null,{default:Ds(()=>[V(ye,{char:"\u2191",area:"up"}),V(ye,{char:"\u2190",area:"left"}),V(ye,{char:"\u2193",area:"down"}),V(ye,{char:"\u2192",area:"right"})]),_:1})]),Qf,O("div",ed,[V(ye,{char:"-"}),V(ye,{char:"+"})])],64))}});const sd=je(td,[["__scopeId","data-v-b2b49560"]]),_i=t=>(ys("data-v-7a2010ed"),t=t(),ws(),t),nd={class:"wrapper"},id=_i(()=>O("h1",null,"Open Tower Defense \u{1F5FC}",-1)),rd={class:"menu"},od={class:"menu-main"},ld={class:"menu-main-inner"},ad=_i(()=>O("button",{disabled:""},"Settings",-1)),cd=he(" Which planet? "),ud=he(" Difficulty "),hd=["value"],fd={class:"difficulty-description"},dd=_i(()=>O("button",{type:"submit"},"Start!",-1)),gd={class:"menu-play-inner"},pd=Ne({__name:"MainMenu",props:{onPlay:null},setup(t){const e=t,s={[Je.Easy]:{label:"Easy",description:"Allows checking which tiles are covered by tower sight lines. Shows the approximate path enemies will take. Enemies die quicker and undiscovered nests do not become stronger."},[Je.Normal]:{label:"Normal",description:"Allows checking which tiles are covered by tower sight lines. Undiscovered nests slowly gain more strength."},[Je.Hard]:{label:"Hard",description:"Checking tower sight lines is no longer possible, enemies die slower and undiscovered nests gain strength more quickly"}},n=te(0),i=te(""),r=te(null),o=te(Je.Normal),l=h=>{var g;if(h===n.value){n.value=0;return}n.value=h,n.value===1&&((g=r.value)==null||g.focus())},a=h=>{h.preventDefault(),e.onPlay(i.value,o.value)};return(h,g)=>(K(),Q("div",nd,[id,O("div",rd,[O("div",od,[O("div",ld,[O("button",{onClick:g[0]||(g[0]=p=>l(1))},"Play"),O("button",{onClick:g[1]||(g[1]=p=>l(2))},"Controls"),ad])]),O("div",{class:be({"menu-play":!0,"menu--hidden":n.value!==1})},[O("form",{onSubmit:a,class:"menu-play-inner"},[O("label",null,[cd,ji(O("input",{ref_key:"seedInput",ref:r,"onUpdate:modelValue":g[2]||(g[2]=p=>i.value=p)},null,512),[[$c,i.value]])]),O("label",null,[ud,ji(O("select",{"onUpdate:modelValue":g[3]||(g[3]=p=>o.value=p)},[(K(),Q(pe,null,Hs(s,({label:p},m)=>O("option",{value:m},de(p),9,hd)),64))],512),[[Yc,o.value]])]),O("p",fd,de(s[o.value].description),1),dd],32)],2),O("div",{class:be({"menu-controls":!0,"menu--hidden":n.value!==2})},[O("div",gd,[V(sd)])],2)])]))}});const md=je(pd,[["__scopeId","data-v-7a2010ed"]]),yd=Ne({__name:"App",setup(t){const e=te(0),s=te(""),n=te(Je.Normal),i=(r,o)=>{e.value=1,s.value=r,n.value=o};return(r,o)=>(K(),Q(pe,null,[e.value==0?(K(),It(md,{key:0,onPlay:i})):Ee("",!0),e.value==1?(K(),It(Of,{key:1,seed:s.value,difficulty:n.value},null,8,["seed","difficulty"])):Ee("",!0)],64))}});Co(yd).mount("#app");
